<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é›†åˆæ¡†æ¶ä¹‹HashMap&amp;HashSetæºç é˜…è¯»</title>
    <url>/2021/12/01/Collections-HashMap/</url>
    <content><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p><em>HashMap</em>å®ç°äº†<em>Map</em>æ¥å£ï¼Œå³å…è®¸æ”¾å…¥<code>key</code>ä¸º<code>null</code>çš„å…ƒç´ ï¼Œä¹Ÿå…è®¸æ’å…¥<code>value</code>ä¸º<code>null</code>çš„å…ƒç´ ã€‚</p>
<span id="more"></span>
<h1 id="å¼€å¤´"><a href="#å¼€å¤´" class="headerlink" title="å¼€å¤´"></a>å¼€å¤´</h1><p><em>HashMap</em>å®ç°äº†<em>Map</em>æ¥å£ï¼Œå³å…è®¸æ”¾å…¥<code>key</code>ä¸º<code>null</code>çš„å…ƒç´ ï¼Œä¹Ÿå…è®¸æ’å…¥<code>value</code>ä¸º<code>null</code>çš„å…ƒç´ ã€‚</p>
<p>é™¤è¯¥ç±»æœªå®ç°åŒæ­¥å¤–ï¼Œå…¶ä½™è·Ÿ<code>Hashtable</code>å¤§è‡´ç›¸åŒï¼›</p>
<p>è·Ÿ<em>TreeMap</em>ä¸åŒï¼Œè¯¥å®¹å™¨ä¸ä¿è¯å…ƒç´ é¡ºåºï¼Œæ ¹æ®éœ€è¦è¯¥å®¹å™¨å¯èƒ½ä¼šå¯¹å…ƒç´ é‡æ–°å“ˆå¸Œï¼Œå…ƒç´ çš„é¡ºåºä¹Ÿä¼šè¢«é‡æ–°æ‰“æ•£ï¼Œå› æ­¤ä¸åŒæ—¶é—´è¿­ä»£åŒä¸€ä¸ª<em>HashMap</em>çš„é¡ºåºå¯èƒ½ä¼šä¸åŒã€‚</p>
<h1 id="HashMapçš„å®ç°"><a href="#HashMapçš„å®ç°" class="headerlink" title="HashMapçš„å®ç°"></a>HashMapçš„å®ç°</h1><h2 id="HashMapçš„åº•å±‚æ•°æ®ç»“æ„"><a href="#HashMapçš„åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="HashMapçš„åº•å±‚æ•°æ®ç»“æ„"></a>HashMapçš„åº•å±‚æ•°æ®ç»“æ„</h2><p>ç›¸æ¯”äºJDK7çš„æ•°ç»„+é“¾è¡¨çš„æ–¹å¼</p>
<p>JDK8ä¸­é‡‡ç”¨äº†<code>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</code>çš„æ–¹å¼æ¥æ„é€ ä¸€ä¸ªHashMap</p>
<p><img src="/2021/12/01/Collections-HashMap/HashMap_1.png"></p>
<p>JDK8ä¸­ï¼Œå½“é“¾è¡¨çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„å…ƒç´ è¾¾åˆ°8ä¸ªçš„æ—¶å€™ï¼Œä¼šå°†é“¾è¡¨ç»“æ„è½¬æ¢ä¸º<code>çº¢é»‘æ ‘</code></p>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><p>HashMapé»˜è®¤æ„é€ å®¹é‡æ˜¯16</p>
<blockquote>
<p>static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4;</p>
</blockquote>
<pre><code class="java">public HashMap(int initialCapacity) &#123;
        this(initialCapacity, DEFAULT_LOAD_FACTOR);
    &#125;
</code></pre>
<pre><code class="java">public HashMap() &#123;
        this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted
    &#125;
</code></pre>
<pre><code class="java">public HashMap(Map&lt;? extends K, ? extends V&gt; m) &#123;
        this.loadFactor = DEFAULT_LOAD_FACTOR;
        putMapEntries(m, false);
    &#125;
</code></pre>
<p>å…¶ä¸­ï¼Œ<code>DEFAULT_LOAD_FACTOR</code>ä¹Ÿè¢«ç§°ä¸ºè´Ÿè½½å› å­ï¼Œé»˜è®¤æ˜¯<strong>0.75f</strong>ã€‚</p>
<blockquote>
<pre><code class="java">static final float DEFAULT_LOAD_FACTOR = 0.75f;
</code></pre>
</blockquote>
<p>è´Ÿè½½å› å­æ˜¯è¡¡é‡å“ˆå¸Œè¡¨åœ¨å®¹é‡è‡ªåŠ¨å¢åŠ ä¹‹å‰å…è®¸å…¶è¾¾åˆ°å¤šå¤§çš„åº¦é‡ã€‚å½“æ•£åˆ—è¡¨ä¸­çš„æ¡ç›®æ•°é‡è¶…è¿‡è´Ÿè½½å› å­å’Œå½“å‰å®¹é‡çš„ä¹˜ç§¯æ—¶ï¼Œå°†é‡å¤„ç†æ•£åˆ—è¡¨ï¼ˆå³é‡å»ºå†…éƒ¨æ•°æ®ç»“æ„ï¼‰ï¼Œä½¿æ•£åˆ—è¡¨çš„æ¡¶æ•°çº¦ä¸ºä¸¤å€ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆæ˜¯0.75è€Œä¸æ˜¯å…¶ä»–ï¼Œå‘µå‘µï¼ŒJDKé‡Œè¯´æ˜¯æ³Šæ¾å®šå¾‹å¾—å‡ºçš„0.7-0.8ä¹‹é—´å†²çªæœ€å°ï¼Ÿä½œä¸ºä¸€åå­¦ä¹ è¿‡æ¦‚ç‡è®ºçš„å¤§å­¦åƒ§ï¼Œæˆ‘ä¹Ÿä¸è®°å¾—äº†ã€‚ã€‚ã€‚</p>
<p>è¿™é‡Œå¯ä»¥å‚è€ƒä¸€ä¸‹<code>StackOverFlow</code>çš„ä¸€ä¸ªå›ç­”ï¼Œå¤§æ„æ˜¯ï¼Œæ¡¶ç©ºå’Œéç©ºçš„æœºç‡æ˜¯0.5ï¼Œç”±ç‰›é¡¿äºŒé¡¹æ€§å¯ä»¥çŸ¥é“ï¼Œ0.75æ›´æ¥è¿‘äºlog2(0.69)ï¼Œå¯èƒ½è´Ÿè½½å› å­åœ¨0.69-0.75æ€§èƒ½ä¼šæ›´å¥½ï¼Œä½†æ˜¯0.75ä¹Ÿä¸æ˜¯ä¸è¡Œ(å¯èƒ½æ˜¯è€ƒè™‘åˆ°ä½è¿ç®—æ•ˆç‡æ¯”è¾ƒé«˜)</p>
<p>![æˆªå±2021-11-30 ä¸‹åˆ11.50.14](/Users/kokorozashiguohuang/Library/Application Support/typora-user-images/æˆªå±2021-11-30 ä¸‹åˆ11.50.14.png)</p>
<p>æ€»ç»“ï¼Œè´Ÿè½½å› å­å¤ªå°äº†æµªè´¹ç©ºé—´å¹¶ä¸”ä¼šå‘ç”Ÿæ›´å¤šæ¬¡æ•°çš„resizeï¼Œå¤ªå¤§äº†å“ˆå¸Œå†²çªå¢åŠ ä¼šå¯¼è‡´æ€§èƒ½ä¸å¥½(å¢åŠ äº†æŸ¥æ‰¾çš„å¼€é”€)</p>
<h2 id="æ–¹æ³•è§£æ"><a href="#æ–¹æ³•è§£æ" class="headerlink" title="æ–¹æ³•è§£æ"></a>æ–¹æ³•è§£æ</h2><h3 id="put"><a href="#put" class="headerlink" title="put()"></a>put()</h3><pre><code class="java">public V put(K key, V value) &#123;
        return putVal(hash(key), key, value, false, true);
    &#125;
        //ç¬¬ä¸€ä¸ªå‚æ•°hash(key)ï¼Œè·å¾—keyå¯¹åº”çš„å“ˆå¸Œå€¼ï¼Œå½“keyä¸ºnullæ—¶ï¼Œå“ˆå¸Œå€¼ä¸º0
    //ç¬¬äºŒã€ä¸‰ä¸ªå‚æ•°ä¸ºå­˜å‚¨çš„é”®å€¼å¯¹
    //ç¬¬å››ä¸ªå‚æ•°onlyIfAbsentå¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆåªæœ‰åœ¨ä¸å­˜åœ¨è¯¥ key æ—¶æ‰ä¼šè¿›è¡Œ put æ“ä½œ
    final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) &#123;
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;
        //å¦‚æœæ˜¯å“ˆå¸Œè¡¨ç¬¬ä¸€æ¬¡putå€¼ï¼Œä¼šè§¦å‘resize()æ¥åˆå§‹åŒ–æ•°ç»„é•¿åº¦
        //ç¬¬ä¸€æ¬¡resizeæ•°ç»„åˆå§‹åŒ–åˆ° 16 OR è‡ªå®šä¹‰å®¹é‡ çš„å¤§å°
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        //æ‰¾åˆ°æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœè¯¥ä½ç½®ä¸ºç©ºï¼Œåˆ™æ”¾å…¥NodeèŠ‚ç‚¹
        // pä¸ºå¯¹åº”æ•°ç»„ä½ç½®çš„é“¾è¡¨èŠ‚ç‚¹
        if ((p = tab[i = (n - 1) &amp; hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        //è¯¥ä½ç½®ä¸ä¸ºç©º
        else &#123;
            // eä¸ºè¾…åŠ©èŠ‚ç‚¹ï¼Œç”¨æ¥è®°å½•keyå€¼ä¸æ–°æ’å…¥èŠ‚ç‚¹ç›¸åŒçš„æ—§èŠ‚ç‚¹
            Node&lt;K,V&gt; e; K k;
            //åˆ¤æ–­è¯¥é“¾è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å’Œæˆ‘ä»¬è¦æ’å…¥çš„keyæ˜¯å¦ç›¸åŒï¼Œç›¸åŒåˆ™å–å‡ºè¯¥èŠ‚ç‚¹
            //PSï¼šä¹‹å‰å°±å¬è¯´è¿‡HashMapçš„putä¼šæ›´æ–°keyå¯¹åº”çš„valueå€¼
            if (p.hash == hash &amp;&amp;
                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
                e = p;
            //å¦‚æœè¯¥èŠ‚ç‚¹ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹æ³•
            else if (p instanceof TreeNode)
                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);
            //æ­¤æ—¶ï¼Œå¯ä»¥è¯´æ˜è¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨(ä½ç½®ä¸ä¸ºç©ºä¸”ä¸æ»¡è¶³ä¸Šè¿°åˆ¤æ–­)
            else &#123;
                //éå†é“¾è¡¨
                for (int binCount = 0; ; ++binCount) &#123;
                    //æ’å…¥åˆ°é“¾è¡¨çš„ç»“å°¾(JDK7ä¸­æ˜¯æ’å…¥åˆ°é“¾è¡¨çš„å¤´éƒ¨)
                    if ((e = p.next) == null) &#123;
                        p.next = newNode(hash, key, value, null);
                        //TREEIFY_THRESHOLDä¸º8ï¼Œå½“æ’å…¥èŠ‚ç‚¹åè¯¥æ•°ç»„é“¾è¡¨èŠ‚ç‚¹ä¸º8æ—¶
                        // ä¼šä½¿ç”¨treeifyBinå°†è¯¥é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘
                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    &#125;
                    //å½“éå†åˆ°ç›¸åŒkeyå€¼çš„èŠ‚ç‚¹æ—¶ï¼Œç›´æ¥break
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        break;
                    //æ­¤æ—¶eä¸ºé“¾è¡¨ä¸­ä¸æ–°æ’å…¥èŠ‚ç‚¹nodeçš„keyç›¸ç­‰çš„æ—§èŠ‚ç‚¹
                    p = e;
                &#125;
            &#125;
            //eä¸ä¸ºnullï¼Œè¯´æ˜å­˜åœ¨keyç›¸ç­‰çš„æ—§èŠ‚ç‚¹
            if (e != null) &#123; // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    //ç”¨æ–°çš„valueè¦†ç›–æ—§èŠ‚ç‚¹çš„value
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            &#125;
        &#125;
        ++modCount;
        //å¦‚æœ HashMapåœ¨æ’å…¥è¯¥èŠ‚ç‚¹åè¶…å‡ºäº†é˜ˆå€¼ï¼Œåˆ™ä¼šè¿›è¡Œæ‰©å®¹
        if (++size &gt; threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    &#125;
</code></pre>
<blockquote>
<p>å…³äºç¬¬äº”ä¸ªå‚æ•° evictï¼Œåœ¨å‡ºç°äº†ä¸€ä¸‹ï¼ŒæŸ¥é˜…ä¸€ä¸‹åšå®¢äº†è§£åˆ°ï¼ŒafterNodeInsertionæ–¹æ³•çš„evictå‚æ•°å¦‚æœä¸ºfalseï¼Œè¡¨ç¤ºå“ˆå¸Œè¡¨å¤„äºåˆ›å»ºæ¨¡å¼ã€‚åªæœ‰åœ¨ä½¿ç”¨Mapé›†åˆä½œä¸ºæ„é€ å™¨åˆ›å»ºLinkedHashMapæˆ–HashMapæ—¶æ‰ä¼šä¸ºfalseï¼Œä½¿ç”¨å…¶ä»–æ„é€ å™¨åˆ›å»ºçš„LinkedHashMapï¼Œä¹‹åå†è°ƒç”¨putæ–¹æ³•ï¼Œè¯¥å‚æ•°å‡ä¸ºtrueã€‚</p>
</blockquote>
<blockquote>
<p>è¿™é‡Œput()æ–¹æ³•å¯¹äºè¾…åŠ©èŠ‚ç‚¹pã€eçš„ä½¿ç”¨æœ‰æ— æ³•æè¿°çš„æ„Ÿè§‰ã€‚ã€‚ã€‚</p>
</blockquote>
<blockquote>
<p>JDK7æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹å†æ’å…¥ï¼ŒJDK8æ˜¯å…ˆæ’å…¥å†åˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹ï¼Œä½†æ˜¯éƒ½æ— å…³å¤§é›…äº†ã€‚ã€‚ã€‚</p>
</blockquote>
<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><pre><code class="java">public V get(Object key) &#123;
        Node&lt;K,V&gt; e;
        return (e = getNode(hash(key), key)) == null ? null : e.value;
    &#125;

    final Node&lt;K,V&gt; getNode(int hash, Object key) &#123;
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;
        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
            (first = tab[(n - 1) &amp; hash]) != null) &#123;
            //å½“ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯æ‰€éœ€è¦çš„èŠ‚ç‚¹æ—¶ï¼Œç›´æ¥return
            if (first.hash == hash &amp;&amp; // always check first node
                ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))
                return first;
            if ((e = first.next) != null) &#123;
                //å½“åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹æ—¶ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„getæ–¹æ³•
                if (first instanceof TreeNode)
                    return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
                //éå†é“¾è¡¨
                do &#123;
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        return e;
                &#125; while ((e = e.next) != null);
            &#125;
        &#125;
        return null;
    &#125;
</code></pre>
<blockquote>
<p>getç›¸æ¯”äºputçš„æ“ä½œå°±æ˜¯å°å„¿ç§‘ç½¢äº†ã€‚ã€‚ã€‚</p>
</blockquote>
<h3 id="resize"><a href="#resize" class="headerlink" title="resize()"></a>resize()</h3><p>æ•°ç»„æ‰©å®¹æ–¹æ³•ï¼Œåœ¨put()ä¸­æåˆ°è¿‡</p>
<blockquote>
<p>å†™æ³¨é‡Šä¹‹å‰ï¼Œä¸€çœ‹é‚£ä¹ˆé•¿å°±çŸ¥é“æ˜¯ä¸€åœºå¤§æˆ˜äº†ã€‚ã€‚ã€‚</p>
</blockquote>
<pre><code class="java">final Node&lt;K,V&gt;[] resize() &#123;
        Node&lt;K,V&gt;[] oldTab = table;
        //æ—§æ•°ç»„å®¹é‡
        int oldCap = (oldTab == null) ? 0 : oldTab.length;
        //æ—§æ•°ç»„é˜ˆå€¼
        int oldThr = threshold;
        //æ–°æ•°ç»„å®¹é‡ORé˜ˆå€¼
        int newCap, newThr = 0;
        //å¼€å§‹æ‰©å®¹
        if (oldCap &gt; 0) &#123;
            //å½“æ—§æ•°ç»„å®¹é‡&gt;=æœ€å¤§å®¹é‡æ—¶,å°†é˜ˆå€¼æ‰©å¤§åˆ°æœ€å¤§å®¹é‡å¤§å°
            //MAXIMUM_CAPACITY = 1 &lt;&lt; 30
            if (oldCap &gt;= MAXIMUM_CAPACITY) &#123;
                threshold = Integer.MAX_VALUE;
                return oldTab;
            &#125;
            //å®¹é‡/é˜ˆå€¼æ‰©å¤§ä¸€å€
            else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;
                     oldCap &gt;= DEFAULT_INITIAL_CAPACITY)
                newThr = oldThr &lt;&lt; 1; // double threshold
        &#125;
        // å¯¹åº”ä½¿ç”¨ new HashMap(int initialCapacity) åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™
        else if (oldThr &gt; 0) // initial capacity was placed in threshold
            newCap = oldThr;
        // å¯¹åº”ä½¿ç”¨ new HashMap() åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™
        else &#123;               // zero initial threshold signifies using defaults
            newCap = DEFAULT_INITIAL_CAPACITY;
            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
        &#125;
        if (newThr == 0) &#123;
            float ft = (float)newCap * loadFactor;
            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?
                      (int)ft : Integer.MAX_VALUE);
        &#125;
        threshold = newThr;
        @SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)
        //åˆå§‹åŒ–ä¸€ä¸ªæ–°æ•°ç»„
        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];
        table = newTab;
        //åŸæ•°ç»„ä¸ºåˆå§‹åŒ–æ•°ç»„æ—¶ï¼Œåˆ°è¿™é‡Œå·²ç»ç»“æŸ
        //éå†æ•°ç»„è¿›è¡Œæ•°æ®è¿ç§»
        if (oldTab != null) &#123;
            for (int j = 0; j &lt; oldCap; ++j) &#123;
                Node&lt;K,V&gt; e;
                if ((e = oldTab[j]) != null) &#123;
                    oldTab[j] = null;
                    //å½“è¯¥æ•°ç»„åªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œç›´æ¥è¿ç§»è¿™ä¸ªå…ƒç´ 
                    if (e.next == null)
                        newTab[e.hash &amp; (newCap - 1)] = e;
                    //çº¢é»‘æ ‘èŠ‚ç‚¹çš„è¿ç§»
                    else if (e instanceof TreeNode)
                        ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);
                    else &#123; // preserve order
                        //å¤„ç†é“¾è¡¨
                        // éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº
                        // loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨çš„å¤´å°¾ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨å¤´å°¾
                        Node&lt;K,V&gt; loHead = null, loTail = null;
                        Node&lt;K,V&gt; hiHead = null, hiTail = null;
                        Node&lt;K,V&gt; next;
                        do &#123;
                            next = e.next;
                            if ((e.hash &amp; oldCap) == 0) &#123;
                                if (loTail == null)
                                    loHead = e;
                                else
                                    loTail.next = e;
                                loTail = e;
                            &#125;
                            else &#123;
                                if (hiTail == null)
                                    hiHead = e;
                                else
                                    hiTail.next = e;
                                hiTail = e;
                            &#125;
                        &#125; while ((e = next) != null);
                        if (loTail != null) &#123;
                            loTail.next = null;
                            //è¿ç§»ç¬¬ä¸€æ¡é“¾è¡¨
                            newTab[j] = loHead;
                        &#125;
                        if (hiTail != null) &#123;
                            hiTail.next = null;
                            //è¿ç§»ç¬¬äºŒæ¡é“¾è¡¨ï¼Œæ”¾åœ¨äº†ä¸åŒçš„ä½ç½®ä¸Š
                            newTab[j + oldCap] = hiHead;
                        &#125;
                    &#125;
                &#125;
            &#125;
        &#125;
        return newTab;
    &#125;
</code></pre>
<h2 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h2><blockquote>
<p>ä½ ä»¥ä¸ºè¿˜æ²¡ç»“æŸå˜›ï¼Ÿä¸ä¸ä¸ï¼ŒHashSetæ˜¯å¯¹HashMapçš„è¿›ä¸€å±‚åŒ…è£…ï¼Œå†…éƒ¨å¯¹åº”çš„æ–¹æ³•éƒ½æ˜¯è°ƒç”¨HashMapçš„ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ‡’ï¼Ÿ</p>
</blockquote>
<blockquote>
<p>é‚£æˆ‘ä¹Ÿæ‡’å¾—è´´ä»£ç äº†ï¼Œè‡ªå·±å»çœ‹å§ğŸ‘€</p>
</blockquote>
<blockquote>
<p>å‚è€ƒè‡ªï¼š</p>
<p><a href="https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/6-HashSet%20and%20HashMap.md">https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/6-HashSet%20and%20HashMap.md</a></p>
<p><a href="https://www.pdai.tech/md/java/collection/java-map-HashMap&amp;HashSet.html#%E6%95%B0%E7%BB%84%E6%89%A9%E5%AE%B9">https://www.pdai.tech/md/java/collection/java-map-HashMap&amp;HashSet.html#æ•°ç»„æ‰©å®¹</a></p>
</blockquote>
]]></content>
      <categories>
        <category>JavaCollection</category>
      </categories>
      <tags>
        <tag>JavaCollection</tag>
      </tags>
  </entry>
  <entry>
    <title>é›†åˆæ¡†æ¶ä¹‹ArrayDequeæºç é˜…è¯»</title>
    <url>/2021/11/21/Collections-ArrayDeque/</url>
    <content><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Javaé‡Œæœ‰ä¸€ä¸ªå«åšStackçš„ç±»ï¼Œå´æ²¡æœ‰å«åšQueueçš„ç±»ï¼ˆå®ƒæ˜¯ä¸ªæ¥å£åå­—ï¼‰ã€‚<br>å½“éœ€è¦ä½¿ç”¨æ ˆæ—¶ï¼ŒJavaå·²ä¸æ¨èä½¿ç”¨Stackï¼Œè€Œæ˜¯æ¨èä½¿ç”¨æ›´é«˜æ•ˆçš„ArrayDequeï¼›<br>æ—¢ç„¶Queueåªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå½“éœ€è¦ä½¿ç”¨é˜Ÿåˆ—æ—¶ä¹Ÿå°±é¦–é€‰ArrayDequeäº†ï¼ˆæ¬¡é€‰æ˜¯LinkedListï¼‰ã€‚</p>
<span id="more"></span>

<h1 id="å¼€å¤´"><a href="#å¼€å¤´" class="headerlink" title="å¼€å¤´"></a>å¼€å¤´</h1><p>æœ¬æ–‡é€šè¿‡è®²è§£<code>ArrayDeque</code>æ¥äº†è§£<code>Stack</code> &amp;&amp; <code>Queue</code></p>
<p><code>Deque</code>æ˜¯â€double ended queueâ€, è¡¨ç¤ºåŒå‘çš„é˜Ÿåˆ—,ç»§æ‰¿è‡ª Queueæ¥å£</p>
<p><img src="/2021/11/21/Collections-ArrayDeque/ArrayDeque_1.png"></p>
<p>é™¤äº†æ”¯æŒQueueçš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æ”¯æŒ<code>insert</code>, <code>remove</code>å’Œ<code>examine</code>æ“ä½œï¼Œç”±äºDequeæ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥å¯ä»¥å¯¹é˜Ÿåˆ—çš„å¤´å’Œå°¾éƒ½è¿›è¡Œæ“ä½œï¼Œå®ƒåŒæ—¶ä¹Ÿæ”¯æŒä¸¤ç»„æ ¼å¼ï¼Œä¸€ç»„æ˜¯æŠ›å‡ºå¼‚å¸¸çš„å®ç°ï¼›å¦å¤–ä¸€ç»„æ˜¯è¿”å›å€¼çš„å®ç°(æ²¡æœ‰åˆ™è¿”å›null)ã€‚</p>
<p>Dequeçš„åäºŒä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p><img src="/2021/11/21/Collections-ArrayDeque/ArrayDeque_2.png"></p>
<blockquote>
<p>å®é™…ä¸Šå¾ˆå¥½è®°ï¼Œå‰è€…ä¸ºæŠ›å‡ºå¼‚å¸¸çš„å®ç°()ï¼Œåè€…ä¸ºè¿”å›å€¼çš„å®ç°(æ²¡æœ‰æ—¶è¿”å›null)ï¼Œ</p>
<p>é˜Ÿåˆ—çš„å¤´å’Œå°¾éƒ½è¿›è¡Œæ“ä½œ(å¢ã€åˆ ã€æŸ¥)ï¼Œè¿™å°±æ˜¯åäºŒä¸ªæ–¹æ³•</p>
</blockquote>
<p>ä¸‹è¡¨åˆ—å‡ºäº†<em>Deque</em>ä¸<em>Queue</em>ç›¸å¯¹åº”çš„æ¥å£:</p>
<p><img src="/2021/11/21/Collections-ArrayDeque/ArrayDeque_3.png"></p>
<p>ä¸‹è¡¨åˆ—å‡ºäº†<em>Deque</em>ä¸<em>Stack</em>å¯¹åº”çš„æ¥å£ï¼š</p>
<p><img src="/2021/11/21/Collections-ArrayDeque/ArrayDeque_4.png"></p>
<blockquote>
<p>å½“éœ€è¦ä½¿ç”¨æ ˆæ—¶ï¼ŒJavaå·²ä¸æ¨èä½¿ç”¨<em>Stack</em>è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æ¨èä½¿ç”¨æ›´é«˜æ•ˆçš„<em>ArrayDeque</em>ï¼›æ—¢ç„¶<em>Queue</em>åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå½“éœ€è¦ä½¿ç”¨é˜Ÿåˆ—æ—¶ä¹Ÿå°±é¦–é€‰<em>ArrayDeque</em>äº†(æ¬¡é€‰æ˜¯<em>LinkedList</em>)ã€‚</p>
</blockquote>
<h1 id="ArrayDequeçš„å®ç°"><a href="#ArrayDequeçš„å®ç°" class="headerlink" title="ArrayDequeçš„å®ç°"></a>ArrayDequeçš„å®ç°</h1><p><em>ArrayDeque</em>å’Œ<em>LinkedList</em>æ˜¯<em>Deque</em>çš„ä¸¤ä¸ªé€šç”¨å®ç°,ä½†å®˜æ–¹æ›´æ¨èä½¿ç”¨ArrayDequeæ¥å®ç°æ ˆå’Œé˜Ÿåˆ—çš„åŠŸèƒ½</p>
<h2 id="ArrayDequeçš„åº•å±‚æ•°æ®ç»“æ„"><a href="#ArrayDequeçš„åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="ArrayDequeçš„åº•å±‚æ•°æ®ç»“æ„"></a>ArrayDequeçš„åº•å±‚æ•°æ®ç»“æ„</h2><p>ArrayDequeä¸€çœ‹åå­—å°±çŸ¥é“æ˜¯ä½¿ç”¨æ•°ç»„æ¥å®ç°é˜Ÿåˆ—æ“ä½œï¼Œæ•…è€Œè¯¥æ•°ç»„å¿…é¡»æ˜¯å¾ªç¯çš„ï¼Œä¸”ArrayDequeæ˜¯éçº¿ç¨‹å®‰å…¨çš„</p>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><pre><code class="java">// æ•°ç»„æœ¬ä½“
transient Object[] elements; 
// æŒ‡å‘é˜Ÿåˆ—é¦–ç«¯ç¬¬ä¸€ä¸ªå…ƒç´ 
transient int head;
// æŒ‡å‘é˜Ÿåˆ—å°¾ç«¯æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªå¯æ’å…¥ç©ºä½
// è€Œä¸æ˜¯æŒ‡å‘é˜Ÿå°¾å…ƒç´ 
transient int tail;

private static final int MIN_INITIAL_CAPACITY = 8;
</code></pre>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•ä¸ºArrayDequeçš„æ„é€ æ–¹æ³•</p>
<pre><code class="java">// æ„é€ ä¸€ä¸ªç©ºæ•°ç»„dequeï¼Œåˆå§‹å®¹é‡è¶³ä»¥å®¹çº³16ä¸ªå…ƒç´ ã€‚
public ArrayDeque() &#123;
    elements = new Object[16];
&#125;

// æ„é€ ä¸€ä¸ªç©ºæ•°ç»„dequeï¼Œåˆå§‹å®¹é‡è¶³ä»¥å®¹çº³æŒ‡å®šæ•°é‡çš„å…ƒç´ ã€‚
public ArrayDeque(int numElements) &#123;
    allocateElements(numElements);
&#125;
// æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„dequeï¼ŒæŒ‰ç…§å®ƒä»¬ç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåºã€‚
public ArrayDeque(Collection&lt;? extends E&gt; c) &#123;
    allocateElements(c.size());
    addAll(c);
&#125;
</code></pre>
<h2 id="æ‰©å®¹"><a href="#æ‰©å®¹" class="headerlink" title="æ‰©å®¹"></a>æ‰©å®¹</h2><p>å†å°†æ–¹æ³•è§£æä¹‹å‰ï¼Œå…ˆè®²è®²æ‰©å®¹</p>
<p>åœ¨<strong>æ„é€ å‡½æ•°éœ€è¦æ„é€ æŒ‡å®šå¤§å°çš„æ•°ç»„</strong>ORä¸Šè¿°æåˆ°<strong>æœ‰å…³æ·»åŠ çš„æ“ä½œ</strong>éƒ½ä¼šæ¶‰åŠåˆ°æ•°ç»„çš„æ‰©å®¹</p>
<p>ArrayDequeçš„æ‰©å®¹æ˜¯æ–°ç›´æ¥ç”³è¯·<strong>ä¸¤å€</strong>(å·¦ç§»ä¸€ä½)çš„æ•°ç»„ç©ºé—´ï¼Œç„¶åå°†åŸæ¥çš„æ•°ç»„ä½¿ç”¨å¤åˆ¶<code>System.arraycopy</code>è¿‡å»</p>
<p><img src="/2021/11/21/Collections-ArrayDeque/ArrayDeque_5.png"></p>
<pre><code class="java">private void doubleCapacity() &#123;
    assert head == tail;
    int p = head;
    int n = elements.length; //æ—§æ•°ç»„çš„å¤§å°
    int r = n - p; // headå³è¾¹çš„å…ƒç´ ä¸ªæ•°
    int newCapacity = n &lt;&lt; 1; // æ–°ç”³è¯·æ•°ç»„çš„å¤§å°
    if (newCapacity &lt; 0)
        throw new IllegalStateException(&quot;Sorry, deque too big&quot;);
    Object[] a = new Object[newCapacity];
    System.arraycopy(elements, p, a, 0, r);//å¤åˆ¶å³åŠéƒ¨åˆ†ï¼Œå¯¹åº”ä¸Šå›¾ä¸­ç»¿è‰²éƒ¨åˆ†
    System.arraycopy(elements, 0, a, r, p);//å¤åˆ¶å·¦åŠéƒ¨åˆ†ï¼Œå¯¹åº”ä¸Šå›¾ä¸­ç°è‰²éƒ¨åˆ†
    elements = a;
    head = 0;
    tail = n;
&#125;
</code></pre>
<blockquote>
<p> ç»“åˆè¿™ä¸¤å¼ å›¾å°±åº”è¯¥å¾ˆå¥½ç†è§£äº†</p>
</blockquote>
<h2 id="æ–¹æ³•è§£æ"><a href="#æ–¹æ³•è§£æ" class="headerlink" title="æ–¹æ³•è§£æ"></a>æ–¹æ³•è§£æ</h2><h2 id="æ·»åŠ "><a href="#æ·»åŠ " class="headerlink" title="æ·»åŠ "></a>æ·»åŠ </h2><h3 id="offerFirst"><a href="#offerFirst" class="headerlink" title="offerFirst()"></a>offerFirst()</h3><blockquote>
<p>åœ¨æ­¤dequeå‰é¢æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæŠ›å‡ºå¼‚å¸¸çš„<code>offerFirst</code>æ˜¯è°ƒç”¨çš„<code>addFirst()</code></p>
<pre><code class="java">public boolean offerFirst(E e) &#123;
    addFirst(e);
    return true;
&#125;
</code></pre>
<h3 id="addFirst"><a href="#addFirst" class="headerlink" title="addFirst()"></a>addFirst()</h3><blockquote>
<p>åœ¨æ­¤dequeå‰é¢æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p>
</blockquote>
<p>æ¥ç€æˆ‘ä»¬æ¥çœ‹<code>addFirst()</code></p>
<p><code>addFirst(E e)</code>çš„ä½œç”¨æ˜¯åœ¨<em>Deque</em>çš„é¦–ç«¯æ’å…¥å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨<code>head</code>çš„å‰é¢æ’å…¥å…ƒç´ ï¼Œåœ¨ç©ºé—´è¶³å¤Ÿä¸”ä¸‹æ ‡æ²¡æœ‰è¶Šç•Œçš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦å°†<code>elements[--head] = e</code>å³å¯ã€‚</p>
<pre><code class="java">public void addFirst(E e) &#123;
    if (e == null) //ä¸å…è®¸æ”¾å…¥null
        throw new NullPointerException();
    elements[head = (head - 1) &amp; (elements.length - 1)] = e; //ä¸‹æ ‡æ˜¯å¦è¶Šç•Œ
    if (head == tail) //åˆ¤æ–­æ•°ç»„æ˜¯å¦å¤Ÿç”¨
        doubleCapacity(); //æ‰©å®¹
&#125;
</code></pre>
<blockquote>
<p> è¿™ä¸€æ®µä»£ç å†™çš„å¾ˆæœ‰æ„æ€</p>
</blockquote>
<p>é¦–å…ˆï¼Œ<code>tail</code>æŒ‡å‘çš„æ€»æ˜¯ä¸‹ä¸€ä¸ªå¯æ’å…¥ç©ºä½(n)ï¼Œ<strong>è§£å†³äº†æ’å…¥ç©ºé—´ä¸å¤Ÿçš„é—®é¢˜</strong></p>
<p>å…¶æ¬¡ï¼Œæ¥çœ‹çœ‹<code>head = (head - 1) &amp; (elements.length - 1)</code>è¿™ä¸€æ®µä»£ç ï¼Œ<code>elements.length</code>æ€»æ˜¯ä¸º2çš„æŒ‡æ•°æ¬¡æ–¹(åˆå§‹å®¹é‡ä¸º2^ 4ï¼Œæ‰©å®¹æ¯æ¬¡åŠ å€)ï¼Œæ•…<code>elements.length - 1</code>çš„ä½ä½<strong>å…¨ä¸º1</strong>å’Œ<code>head - 1</code>å–ä½™æ•°åç­‰äºæ˜¯<strong>å–æ¨¡</strong>äº†ï¼Œè§£å†³äº†</p>
<p><code>head - 1</code>ä¸ºè´Ÿæ•°çš„æƒ…å†µ(å³æ•°ç»„è¶Šç•Œçš„é—®é¢˜)</p>
<h3 id="offerLast"><a href="#offerLast" class="headerlink" title="offerLast()"></a>offerLast()</h3><blockquote>
<p>åœ¨æ­¤dequeçš„æœ«å°¾æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p>
</blockquote>
<p>åŒæ ·ç›´æ¥è°ƒç”¨äº†<code>addLast()</code></p>
<pre><code class="java">public boolean offerLast(E e) &#123;
    addLast(e);
    return true;
&#125;
</code></pre>
<h3 id="addLast"><a href="#addLast" class="headerlink" title="addLast()"></a>addLast()</h3><blockquote>
<p>åœ¨æ­¤dequeçš„æœ«å°¾æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚</p>
</blockquote>
<p>ä¸Šé¢çš„addLastæåˆ°äº†ï¼Œtailæ€»æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªå¯æ’å…¥ç©ºä½ï¼Œç›´æ¥<code>elements[tail] = e</code>å³å¯</p>
<pre><code class="java">public void addLast(E e) &#123;
    if (e == null)
        throw new NullPointerException();
    elements[tail] = e;
    if ( (tail = (tail + 1) &amp; (elements.length - 1)) == head) //æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¤„ç†
        doubleCapacity();
&#125;
</code></pre>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="removeFirst"><a href="#removeFirst" class="headerlink" title="removeFirst()"></a>removeFirst()</h3><blockquote>
<p>æ£€ç´¢å¹¶åˆ é™¤æ­¤dequeçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p>
</blockquote>
<p>åŒæ ·æ˜¯è°ƒç”¨äº†<code>pollFirst()</code>ï¼Œç›¸æ¯”<code>pollFirst()</code>å¤šæŠ›äº†ä¸€ä¸ª<code>NoSuchElementException()</code>çš„å¼‚å¸¸</p>
<pre><code class="java">public E removeFirst() &#123;
    E x = pollFirst();
    if (x == null)
        throw new NoSuchElementException();
    return x;
&#125;
</code></pre>
<h3 id="pollFirst"><a href="#pollFirst" class="headerlink" title="pollFirst()"></a>pollFirst()</h3><blockquote>
<p>æ£€ç´¢å¹¶åˆ é™¤æ­¤dequeçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ­¤dequeä¸ºç©ºï¼Œåˆ™è¿”å› <code>null</code> ã€‚</p>
</blockquote>
<p>å¼€å¤´è®²åˆ°ï¼ŒArrayListä¸å…è®¸æ”¾å…¥nullï¼Œåˆ™å½“<code>elements[h] = null;</code>çš„æ—¶å€™ï¼Œæ„å‘³ç€é˜Ÿåˆ—ä¸ºç©º</p>
<pre><code class="java">public E pollFirst() &#123;
    int h = head;
    @SuppressWarnings(&quot;unchecked&quot;)
    E result = (E) elements[h];
    if (result == null)
        return null;
    elements[h] = null;     // é˜Ÿåˆ—ä¸ºç©º
    head = (h + 1) &amp; (elements.length - 1); //ä¸‹æ ‡è¶Šç•Œæ£€æŸ¥
    return result;
&#125;
</code></pre>
<h3 id="removeLast"><a href="#removeLast" class="headerlink" title="removeLast()"></a>removeLast()</h3><blockquote>
<p>æ£€ç´¢å¹¶åˆ é™¤æ­¤dequeçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p>
</blockquote>
<p>åŒç†<code>removeFirst()</code></p>
<pre><code class="java">public E removeLast() &#123;
    E x = pollLast();
    if (x == null)
        throw new NoSuchElementException();
    return x;
&#125;
</code></pre>
<h3 id="pollLast"><a href="#pollLast" class="headerlink" title="pollLast()"></a>pollLast()</h3><blockquote>
<p>æ£€ç´¢å¹¶åˆ é™¤æ­¤dequeçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ­¤dequeä¸ºç©ºï¼Œåˆ™è¿”å› <code>null</code> ã€‚</p>
</blockquote>
<p>ç§»é™¤çš„æ˜¯<code>tail</code>ä½ç½®å‰ä¸€ä¸ªå…ƒç´ </p>
<pre><code class="java">public E pollLast() &#123;
    int t = (tail - 1) &amp; (elements.length - 1);
    @SuppressWarnings(&quot;unchecked&quot;)
    E result = (E) elements[t];
    if (result == null)
        return null;
    elements[t] = null;
    tail = t;
    return result;
&#125;
</code></pre>
<h2 id="æ£€ç´¢"><a href="#æ£€ç´¢" class="headerlink" title="æ£€ç´¢"></a>æ£€ç´¢</h2><p>è¿™ä¸ªä¸ä¸Šé¢åˆ é™¤çš„åŒºåˆ«æ˜¯</p>
<ul>
<li>åˆ é™¤ = åˆ é™¤å…ƒç´  + æ£€ç´¢(è¿”å›åˆ é™¤çš„å…ƒç´ ï¼‰</li>
<li>æ£€ç´¢ =  è¿”å›è¯¥å…ƒç´ </li>
</ul>
<p>å°±æ˜¯<strong>get</strong>çš„æ„æ€ï¼Ÿ</p>
<h3 id="getFirst"><a href="#getFirst" class="headerlink" title="getFirst()"></a>getFirst()</h3><blockquote>
<p>æ£€ç´¢ï¼Œä½†ä¸åˆ é™¤ï¼Œè¿™ä¸ªdequeçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p>
</blockquote>
<pre><code class="java">public E getFirst() &#123;
    @SuppressWarnings(&quot;unchecked&quot;)
    E result = (E) elements[head];
    if (result == null)
        throw new NoSuchElementException();
    return result;
&#125;
</code></pre>
<h3 id="peekFirst"><a href="#peekFirst" class="headerlink" title="peekFirst()"></a>peekFirst()</h3><blockquote>
<p>æ£€ç´¢ä½†ä¸åˆ é™¤æ­¤dequeçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ­¤dequeä¸ºç©ºï¼Œåˆ™è¿”å› <code>null</code></p>
</blockquote>
<pre><code class="java">@SuppressWarnings(&quot;unchecked&quot;)
public E peekFirst() &#123;
    // elements[head] is null if deque empty
    return (E) elements[head];
&#125;
</code></pre>
<h3 id="getLast"><a href="#getLast" class="headerlink" title="getLast()"></a>getLast()</h3><blockquote>
<p>æ£€ç´¢ï¼Œä½†ä¸åˆ é™¤ï¼Œè¿™ä¸ªdequeçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p>
</blockquote>
<pre><code class="java">public E getLast() &#123;
    @SuppressWarnings(&quot;unchecked&quot;)
    E result = (E) elements[(tail - 1) &amp; (elements.length - 1)];
    if (result == null)
        throw new NoSuchElementException();
    return result;
&#125;
</code></pre>
<h3 id="peekLast"><a href="#peekLast" class="headerlink" title="peekLast()"></a>peekLast()</h3><blockquote>
<p>æ£€ç´¢ä½†ä¸åˆ é™¤æ­¤dequeçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è¿”å› <code>null</code>å¦‚æœæ­¤dequeä¸ºç©ºï¼‰ã€‚</p>
</blockquote>
<pre><code class="java">@SuppressWarnings(&quot;unchecked&quot;)
public E peekLast() &#123;
    return (E) elements[(tail - 1) &amp; (elements.length - 1)];
&#125;
</code></pre>
<blockquote>
<p>æ³¨æ„âš ï¸ï¼š</p>
<p>æ£€ç´¢çš„<code>getFirst()</code>å’Œ<code>getLast()</code>ä¼šå¯¹nullæŠ›å‡ºå¼‚å¸¸</p>
</blockquote>
]]></content>
      <categories>
        <category>JavaCollection</category>
      </categories>
      <tags>
        <tag>JavaCollection</tag>
      </tags>
  </entry>
  <entry>
    <title>é›†åˆæ¡†æ¶ä¹‹LinkedListæºç é˜…è¯»</title>
    <url>/2021/11/20/Collections-LinkedList/</url>
    <content><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p><em>LinkedList</em>åŒæ—¶å®ç°äº†<strong><em>List</em>æ¥å£</strong>å’Œ<strong><em>Deque</em>æ¥å£</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ—¢å¯ä»¥çœ‹ä½œä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œåˆå¯ä»¥çœ‹ä½œä¸€ä¸ªé˜Ÿåˆ—(<em>Queue</em>)ï¼ŒåŒæ—¶åˆå¯ä»¥çœ‹ä½œä¸€ä¸ªæ ˆ(<em>Stack</em>)</p>
<span id="more"></span>

<h1 id="å¼€å¤´"><a href="#å¼€å¤´" class="headerlink" title="å¼€å¤´"></a>å¼€å¤´</h1><p><em>LinkedList</em>åŒæ—¶å®ç°äº†<strong><em>List</em>æ¥å£</strong>å’Œ<strong><em>Deque</em>æ¥å£</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ—¢å¯ä»¥çœ‹ä½œä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œåˆå¯ä»¥çœ‹ä½œä¸€ä¸ªé˜Ÿåˆ—(<em>Queue</em>)ï¼ŒåŒæ—¶åˆå¯ä»¥çœ‹ä½œä¸€ä¸ªæ ˆ(<em>Stack</em>)ã€‚<br>å½“ä½ éœ€è¦ä½¿ç”¨æ ˆæˆ–è€…é˜Ÿåˆ—æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<em>LinkedList</em>ï¼Œå…³äºæ ˆæˆ–é˜Ÿåˆ—ï¼Œç°åœ¨çš„é¦–é€‰æ˜¯<em>ArrayDeque</em>ï¼Œå®ƒæœ‰ç€æ¯”<em>LinkedList</em>(å½“ä½œæ ˆæˆ–é˜Ÿåˆ—ä½¿ç”¨æ—¶)æœ‰ç€æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<p>æˆªå–äº†ä¸€å¼ å›¾æ¥è¯´æ˜ä¸€ä¸‹<code>LinkedList</code>çš„å®ç°å…³ç³»</p>
<p><img src="/2021/11/20/Collections-LinkedList/LinkedList_1.png"></p>
<h1 id="LinkedListçš„å®ç°"><a href="#LinkedListçš„å®ç°" class="headerlink" title="LinkedListçš„å®ç°"></a>LinkedListçš„å®ç°</h1><h2 id="åº•å±‚æ•°æ®ç»“æ„"><a href="#åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="åº•å±‚æ•°æ®ç»“æ„"></a>åº•å±‚æ•°æ®ç»“æ„</h2><p>LinkedListçš„åº•å±‚æ˜¯é€šè¿‡<strong>åŒå‘é“¾è¡¨</strong>å®ç°çš„</p>
<p>é€šè¿‡<code>first</code>å’Œ<code>last</code>åˆ†åˆ«å¼•ç”¨æŒ‡å‘é“¾è¡¨çš„<code>ç¬¬ä¸€ä¸ª</code>å’Œæœ€åä¸€ä¸ªå…ƒç´ </p>
<p>å½“é“¾è¡¨ä¸ºç©ºæ—¶ï¼Œ<code>first</code>å’Œ<code>last</code>åˆ†åˆ«å¼•ç”¨æŒ‡å‘<code>null</code></p>
<pre><code class="java">transient int size = 0;

    transient Node&lt;E&gt; first;

    transient Node&lt;E&gt; last;
</code></pre>
<p>å…¶ä¸­ï¼Œnodeæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå†…éƒ¨ç§æœ‰ç±»</p>
<pre><code class="java">private static class Node&lt;E&gt; &#123;
        E item;
        Node&lt;E&gt; next;
        Node&lt;E&gt; prev;

        Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;
            this.item = element;
            this.next = next;
            this.prev = prev;
        &#125;
    &#125;
</code></pre>
<p><em>LinkedList</em>çš„å®ç°æ–¹å¼å†³å®šäº†æ‰€æœ‰è·Ÿä¸‹æ ‡ç›¸å…³çš„æ“ä½œéƒ½æ˜¯çº¿æ€§æ—¶é—´ï¼Œè€Œåœ¨é¦–æ®µæˆ–è€…æœ«å°¾åˆ é™¤å…ƒç´ åªéœ€è¦å¸¸æ•°æ—¶é—´ã€‚</p>
<p>ä¸ºè¿½æ±‚æ•ˆç‡<em>LinkedList</em>æ²¡æœ‰å®ç°åŒæ­¥ï¼ˆsynchronizedï¼‰ï¼Œå¦‚æœéœ€è¦å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œå¯ä»¥å…ˆé‡‡ç”¨<code>Collections.synchronizedList()</code>æ–¹æ³•å¯¹å…¶è¿›è¡ŒåŒ…è£…ã€‚</p>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><pre><code class="java">  
    public LinkedList() &#123;
    &#125;

    public LinkedList(Collection&lt;? extends E&gt; c) &#123;
        this();
        addAll(c);
    &#125;
</code></pre>
<h2 id="æ–¹æ³•è§£æ"><a href="#æ–¹æ³•è§£æ" class="headerlink" title="æ–¹æ³•è§£æ"></a>æ–¹æ³•è§£æ</h2><h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><p>è¿™ä¸€ä¸ªæ˜¯é»˜è®¤æ’åœ¨é“¾è¡¨çš„æœ€å</p>
<pre><code class="java">  public boolean add(E e) &#123;
        linkLast(e);
        return true;
    &#125;
</code></pre>
<pre><code class="java">/**
 * Links e as last element.
 */
void linkLast(E e) &#123;
    final Node&lt;E&gt; l = last;
    final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null);
    last = newNode;
    if (l == null)
        first = newNode;
    else
        l.next = newNode;
    size++;
    modCount++;
&#125;
</code></pre>
<p>è¿™ä¸€ä¸ªæ˜¯æ ¹æ®ç´¢å¼•æ’å…¥</p>
<pre><code class="java">public void add(int index, E element) &#123;
      //è¿™ä¸€æ­¥æ˜¯æ£€æŸ¥æ’å…¥ç´¢å¼•ä½ç½®æ˜¯å¦ç¬¦åˆè¦æ±‚
      //åˆ¤æ–­indexæ˜¯å¦åœ¨[0ï¼Œsize]åŒºé—´å†…
    checkPositionIndex(index);

      //å½“æ’å…¥ç´¢å¼•ä½ç½®åœ¨æœ€åæ—¶ï¼Œç›´æ¥æ’å…¥æœ€å
    if (index == size)
        linkLast(element);
    else
          //æ·»åŠ çš„å…ƒç´ ç´¢å¼•ä½ç½®ä¸åœ¨æœ€åæ—¶
        linkBefore(element, node(index));
&#125;
</code></pre>
<p>å…³äº<code>node(int index)</code></p>
<p>è¿”å›æŒ‡å®šç´¢å¼•ä¸‹çš„nodeï¼Œè¯¥é“¾è¡¨ä¸ºåŒå‘çš„ï¼Œæ ¹æ®<code>index &lt; (size &gt;&gt; 1)</code>æ¥åˆ¤æ–­indexé è¿‘å‰ç«¯è¿˜æ˜¯åç«¯ï¼Œå¯ä»¥çœ‹å‡ºï¼ŒLinkedListæŸ¥æ‰¾çš„æ•ˆç‡å¹¶æ²¡æœ‰ArrayListé«˜ï¼ˆLinkedListæ˜¯çº¿æ€§çš„æ—¶é—´é•¿åº¦ï¼‰</p>
<pre><code class="java"> Node&lt;E&gt; node(int index) &#123;
        // assert isElementIndex(index);

        if (index &lt; (size &gt;&gt; 1)) &#123;
            Node&lt;E&gt; x = first;
            for (int i = 0; i &lt; index; i++)
                x = x.next;
            return x;
        &#125; else &#123;
            Node&lt;E&gt; x = last;
            for (int i = size - 1; i &gt; index; i--)
                x = x.prev;
            return x;
        &#125;
    &#125;
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ <code>linkBefore(element, node(index))</code></p>
<pre><code class="java">/**
 * Inserts element e before non-null Node succ.
 */
void linkBefore(E e, Node&lt;E&gt; succ) &#123;
    // assert succ != null;
      // 
    final Node&lt;E&gt; pred = succ.prev;
      //
    final Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, succ);
    succ.prev = newNode;
    if (pred == null)
        first = newNode;
    else
        pred.next = newNode;
    size++;
    modCount++;
&#125;
</code></pre>
<h3 id="addAll"><a href="#addAll" class="headerlink" title="addAll()"></a>addAll()</h3><p>ä¸åŠ ç´¢å¼•ä½ç½®æ—¶ï¼Œé»˜è®¤æ·»åŠ è‡³æœ€åï¼Œè°ƒç”¨<code>addAll(int index, Collection&lt;? extends E&gt; c)</code>æ–¹æ³•</p>
<pre><code class="java"> public boolean addAll(Collection&lt;? extends E&gt; c) &#123;
        return addAll(size, c);
    &#125;
</code></pre>
<p>æŒ‰ç…§ç´¢å¼•ä½ç½®æ’å…¥</p>
<pre><code class="java">   public boolean addAll(int index, Collection&lt;? extends E&gt; c) &#123;
        checkPositionIndex(index);

        Object[] a = c.toArray();
        int numNew = a.length;
        if (numNew == 0)
            return false;

        Node&lt;E&gt; pred, succ;
        if (index == size) &#123;
            succ = null;
            pred = last;
        &#125; else &#123;
            succ = node(index);
            pred = succ.prev;
        &#125;

        for (Object o : a) &#123;
            @SuppressWarnings(&quot;unchecked&quot;) E e = (E) o;
            Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, null);
            if (pred == null)
                first = newNode;
            else
                pred.next = newNode;
            pred = newNode;
        &#125;

        if (succ == null) &#123;
            last = pred;
        &#125; else &#123;
            pred.next = succ;
            succ.prev = pred;
        &#125;

        size += numNew;
        modCount++;
        return true;
    &#125;
</code></pre>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h3><p>åˆ é™¤å‡ºç°çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›nullï¼Œç”±äºLinkedListä¹Ÿå¯ä»¥å­˜nullï¼Œå› æ­¤ï¼Œä¹Ÿå¯ä»¥åˆ é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„nullå…ƒç´ </p>
<pre><code class="java">public boolean remove(Object o) &#123;
        if (o == null) &#123;
            for (Node&lt;E&gt; x = first; x != null; x = x.next) &#123;
                if (x.item == null) &#123;
                    unlink(x);
                    return true;
                &#125;
            &#125;
        &#125; else &#123;
            for (Node&lt;E&gt; x = first; x != null; x = x.next) &#123;
                if (o.equals(x.item)) &#123;
                    unlink(x);
                    return true;
                &#125;
            &#125;
        &#125;
        return false;
    &#125;
</code></pre>
<pre><code class="java">    /**
     * Unlinks non-null node x.
     */
    E unlink(Node&lt;E&gt; x) &#123;
        // assert x != null;
        final E element = x.item;
        final Node&lt;E&gt; next = x.next;
        final Node&lt;E&gt; prev = x.prev;

          //ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶
        if (prev == null) &#123;
            first = next;
        &#125; else &#123;
            prev.next = next;
            x.prev = null;
        &#125;

          //æœ€åä¸€ä¸ªå…ƒç´ æ—¶
        if (next == null) &#123;
            last = prev;
        &#125; else &#123;
            next.prev = prev;
            x.next = null;
        &#125;

          // null
        x.item = null;
        size--;
        modCount++;
        return element;
    &#125;
</code></pre>
<p>åˆ é™¤æŒ‡å®šç´¢å¼•çš„node</p>
<pre><code class="java">public E remove(int index) &#123;
        checkElementIndex(index);
        return unlink(node(index));
    &#125;
</code></pre>
<blockquote>
<p>removeFirest(), removeLast()åŒæ¯”ï¼Œå°±ä¸æ”¾å‡ºæ¥äº†</p>
</blockquote>
<h3 id="clear"><a href="#clear" class="headerlink" title="clear()"></a>clear()</h3><p>æ¸…ç©ºå¼•ç”¨å…³ç³»ï¼Œæ–¹ä¾¿gcå¿«é€Ÿå›æ”¶</p>
<pre><code class="java">public void clear() &#123;
        // Clearing all of the links between nodes is &quot;unnecessary&quot;, but:
        // - helps a generational GC if the discarded nodes inhabit
        //   more than one generation
        // - is sure to free memory even if there is a reachable Iterator
        for (Node&lt;E&gt; x = first; x != null; ) &#123;
            Node&lt;E&gt; next = x.next;
            x.item = null;
            x.next = null;
            x.prev = null;
            x = next;
        &#125;
        first = last = null;
        size = 0;
        modCount++;
    &#125;
</code></pre>
<h2 id="å…³äºmodCount"><a href="#å…³äºmodCount" class="headerlink" title="å…³äºmodCount"></a>å…³äºmodCount</h2><p>LinkedListè™½ç„¶æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¿«é€Ÿå¤±è´¥çš„æœºåˆ¶ï¼Œé€šè¿‡è®°å½•<code>modCount</code>å‚æ•°æ¥å®ç°ã€‚(åŒæ¯”å‚è€ƒArrayList)</p>
<blockquote>
<p>å‚è€ƒ</p>
<ul>
<li><p>Java LinkedListæºç å‰–æ ç»“åˆæºç å¯¹LinkedListè¿›è¡Œè®²è§£ <a href="http://www.cnblogs.com/CarpenterLee/p/5457150.html">http://www.cnblogs.com/CarpenterLee/p/5457150.html</a></p>
</li>
<li><p>Javaâ„¢ Platform, Standard Edition 8 API Specification</p>
</li>
</ul>
</blockquote>
]]></content>
      <categories>
        <category>JavaCollection</category>
      </categories>
      <tags>
        <tag>JavaCollection</tag>
      </tags>
  </entry>
  <entry>
    <title>é›†åˆæ¡†æ¶ä¹‹ArrayListæºç é˜…è¯»</title>
    <url>/2021/11/18/Collections-ArrayList/</url>
    <content><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>ArrayListå®ç°äº†Listæ¥å£ï¼Œæ˜¯é¡ºåºå®¹å™¨ï¼Œå³å…ƒç´ å­˜æ”¾çš„æ•°æ®ä¸æ”¾è¿›å»çš„é¡ºåºç›¸åŒã€‚</p>
<span id="more"></span>

<h1 id="å¼€å¤´"><a href="#å¼€å¤´" class="headerlink" title="å¼€å¤´"></a>å¼€å¤´</h1><p>ArrayListå®ç°äº†Listæ¥å£ï¼Œæ˜¯é¡ºåºå®¹å™¨ï¼Œå³å…ƒç´ å­˜æ”¾çš„æ•°æ®ä¸æ”¾è¿›å»çš„é¡ºåºç›¸åŒï¼Œ<br>å…è®¸æ”¾å…¥nullå…ƒç´ ï¼Œåº•å±‚é€šè¿‡æ•°ç»„å®ç°ã€‚é™¤è¯¥ç±»æœªå®ç°åŒæ­¥å¤–ï¼Œå…¶ä½™è·ŸVectorå¤§è‡´ç›¸åŒã€‚</p>
<p>æ¯ä¸ªArrayListéƒ½æœ‰ä¸€ä¸ªå®¹é‡ï¼ˆcapacityï¼‰ï¼Œè¡¨ç¤ºåº•å±‚æ•°ç»„çš„å®é™…å¤§å°ï¼Œå®¹å™¨å†…å­˜å‚¨å…ƒç´ çš„ä¸ªæ•°ä¸èƒ½å¤šäºå½“å‰å®¹é‡ã€‚</p>
<p>å½“å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœå®¹é‡ä¸è¶³ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å¢å¤§åº•å±‚æ•°ç»„çš„å¤§å°ã€‚å‰é¢å·²ç»æè¿‡ï¼ŒJavaæ³›å‹åªæ˜¯ç¼–è¯‘å™¨æä¾›çš„è¯­æ³•ç³–ï¼Œ<br>æ‰€ä»¥è¿™é‡Œçš„æ•°ç»„æ˜¯ä¸€ä¸ªObjectæ•°ç»„ï¼Œä»¥ä¾¿èƒ½å¤Ÿå®¹çº³ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚</p>
<h1 id="ArrayListçš„å®ç°"><a href="#ArrayListçš„å®ç°" class="headerlink" title="ArrayListçš„å®ç°"></a>ArrayListçš„å®ç°</h1><h2 id="ArrayListçš„åº•å±‚æ•°æ®ç»“æ„"><a href="#ArrayListçš„åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="ArrayListçš„åº•å±‚æ•°æ®ç»“æ„"></a>ArrayListçš„åº•å±‚æ•°æ®ç»“æ„</h2><pre><code class="java">        /**
     * The array buffer into which the elements of the ArrayList are stored.
     * The capacity of the ArrayList is the length of this array buffer. Any
     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
     * will be expanded to DEFAULT_CAPACITY when the first element is added.
     */
    transient Object[] elementData; // non-private to simplify nested class access
</code></pre>
<h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><pre><code class="java">    /**
     * Constructs an empty list with the specified initial capacity.
     *
     * @param  initialCapacity  the initial capacity of the list
     * @throws IllegalArgumentException if the specified initial capacity
     *         is negative
     */
    public ArrayList(int initialCapacity) &#123;
        if (initialCapacity &gt; 0) &#123;
            this.elementData = new Object[initialCapacity];
        &#125; else if (initialCapacity == 0) &#123;
            //åœ¨jdk7æ—¶ï¼Œelementåˆå§‹åŒ–ä¸ºé•¿åº¦ä¸º10çš„æ•°ç»„
            //åœ¨jdk8åï¼ŒelementDataåˆå§‹åŒ–ä¸º&#123;&#125;ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºé•¿åº¦ï¼Œåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨add()åæ‰åˆ›å»ºé•¿åº¦
            //å…¶ä¸­ï¼Œprivate static final Object[] EMPTY_ELEMENTDATA = &#123;&#125;;
            this.elementData = EMPTY_ELEMENTDATA;
        &#125; else &#123;
            throw new IllegalArgumentException(&quot;Illegal Capacity: &quot;+
                                               initialCapacity);
        &#125;
    &#125;

    /**
     * Constructs an empty list with an initial capacity of ten.
     */
    public ArrayList() &#123;
        //å…¶ä¸­ private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    &#125;

    /**
     * Constructs a list containing the elements of the specified
     * collection, in the order they are returned by the collection&#39;s
     * iterator.
     *
     * @param c the collection whose elements are to be placed into this list
     * @throws NullPointerException if the specified collection is null
     */
    public ArrayList(Collection&lt;? extends E&gt; c) &#123;
        Object[] a = c.toArray();
        if ((size = a.length) != 0) &#123;
            if (c.getClass() == ArrayList.class) &#123;
                elementData = a;
            &#125; else &#123;
                elementData = Arrays.copyOf(a, size, Object[].class);
            &#125;
        &#125; else &#123;
            // replace with empty array.
            elementData = EMPTY_ELEMENTDATA;
        &#125;
    &#125;
</code></pre>
<h2 id="æ‰©å®¹"><a href="#æ‰©å®¹" class="headerlink" title="æ‰©å®¹"></a>æ‰©å®¹</h2><h3 id="ensureCapacity"><a href="#ensureCapacity" class="headerlink" title="ensureCapacity()"></a>ensureCapacity()</h3><blockquote>
<p>æ‰©å®¹æ“ä½œæœ€ç»ˆæ˜¯é€šè¿‡<code>grow()</code>æ–¹æ³•å®Œæˆçš„</p>
</blockquote>
<p>å‘ ArrayList æ·»åŠ å¤§é‡å…ƒç´ ä¹‹å‰æœ€å¥½å…ˆä½¿ç”¨<code>ensureCapacity</code> æ–¹æ³•ï¼Œä»¥å‡å°‘å¢é‡é‡æ–°åˆ†é…çš„æ¬¡æ•°ã€‚èƒ½å‡å°‘<code>add()</code>æ‰€è€—è´¹çš„æ—¶é—´</p>
<p><img src="/2021/11/18/Collections-ArrayList/ArrayList_1.png"></p>
<p><code>ensureCapacity</code> æ–¹æ³•å†…å¤§è‡´çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š</p>
<ul>
<li><code>ensureCapacity()</code> â€”&gt;<code>ensureCapacityInternal()</code>â€”&gt;<code>ensureExplicitCapacity()</code>â€”&gt;<code>grow()</code>â€”&gt;<code>Arrays.copyOf()</code></li>
</ul>
<pre><code class="java">    /**
     * Increases the capacity of this &lt;tt&gt;ArrayList&lt;/tt&gt; instance, if
     * necessary, to ensure that it can hold at least the number of elements
     * specified by the minimum capacity argument.
     *
     * @param   minCapacity   the desired minimum capacity
     */
        //å¦‚æœéœ€è¦ï¼Œå¢åŠ æ­¤ ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒå¯ä»¥è‡³å°‘ä¿å­˜æœ€å°å®¹é‡å‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°ã€‚
    public void ensureCapacity(int minCapacity) &#123;
        int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)
            // any size if not default element table
            ? 0
            // larger than default for default empty table. It&#39;s already
            // supposed to be at default size.
            : DEFAULT_CAPACITY;

        if (minCapacity &gt; minExpand) &#123;
            ensureExplicitCapacity(minCapacity);
        &#125;
    &#125;
    //å½“minCapacityå°äº10(DEFAULT_CAPACITY)æ—¶ï¼Œè¿”å›10(DEFAULT_CAPACITY)
    private static int calculateCapacity(Object[] elementData, int minCapacity) &#123;
        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;
            return Math.max(DEFAULT_CAPACITY, minCapacity);
        &#125;
        return minCapacity;
    &#125;

    private void ensureCapacityInternal(int minCapacity) &#123;
        ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
    &#125;
    // åˆ¤æ–­æ˜¯å¦ç”³è¯·é¢å¤–ç©ºé—´ï¼šå¦‚æœç”³è¯·å®¹é‡æ¯”å½“å‰æ•°ç»„å…ƒç´ çš„å®é™…é•¿åº¦å¤§ åˆ™è¿›å…¥æ–¹æ³• grow
    private void ensureExplicitCapacity(int minCapacity) &#123;
        modCount++;

        // overflow-conscious code
        if (minCapacity - elementData.length &gt; 0)
            grow(minCapacity);
    &#125;

    /**
     * The maximum size of array to allocate.
     * Some VMs reserve some header words in an array.
     * Attempts to allocate larger arrays may result in
     * OutOfMemoryError: Requested array size exceeds VM limit
     */
    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

    /**
     * Increases the capacity to ensure that it can hold at least the
     * number of elements specified by the minimum capacity argument.
     *
     * @param minCapacity the desired minimum capacity
     */
    private void grow(int minCapacity) &#123;
        // overflow-conscious code
          // åŸæ•°ç»„é•¿åº¦
        int oldCapacity = elementData.length;
          // æ–°æ•°ç»„é•¿åº¦çº¦ä¸ºåŸæ•°ç»„é•¿åº¦çš„1.5å€
        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
        if (newCapacity - minCapacity &lt; 0)
            newCapacity = minCapacity;
        if (newCapacity - MAX_ARRAY_SIZE &gt; 0)
            newCapacity = hugeCapacity(minCapacity);
        // minCapacity is usually close to size, so this is a win:
        elementData = Arrays.copyOf(elementData, newCapacity);
    &#125;
        //è¿™ä¸€æ­¥è¯´æ˜äº†æ•°ç»„çš„æœ€å¤§é•¿åº¦å¯ä»¥ä¸ºInteger.MAX_VALUE
        //è€Œä¸æ˜¯ä¹‹å‰å®šä¹‰çš„Integer.MAX_VALUE - 8;
    private static int hugeCapacity(int minCapacity) &#123;
        if (minCapacity &lt; 0) // overflow
            throw new OutOfMemoryError();
        return (minCapacity &gt; MAX_ARRAY_SIZE) ?
            Integer.MAX_VALUE :
            MAX_ARRAY_SIZE;
    &#125;
</code></pre>
<h2 id="æ–¹æ³•è§£æ"><a href="#æ–¹æ³•è§£æ" class="headerlink" title="æ–¹æ³•è§£æ"></a>æ–¹æ³•è§£æ</h2><h3 id="add"><a href="#add" class="headerlink" title="add()"></a>add()</h3><p>å…¶ä¸­ï¼Œ<code>add(int index, E element)</code>å…·æœ‰çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦</p>
<pre><code class="java">    /**
     * Appends the specified element to the end of this list.
     *
     * @param e element to be appended to this list
     * @return &lt;tt&gt;true&lt;/tt&gt; (as specified by &#123;@link Collection#add&#125;)
     */
    public boolean add(E e) &#123;
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        elementData[size++] = e;
        return true;
    &#125;

    /**
     * Inserts the specified element at the specified position in this
     * list. Shifts the element currently at that position (if any) and
     * any subsequent elements to the right (adds one to their indices).
     *
     * @param index index at which the specified element is to be inserted
     * @param element element to be inserted
     * @throws IndexOutOfBoundsException &#123;@inheritDoc&#125;
     */
    public void add(int index, E element) &#123;
          // æ£€æŸ¥indexæ˜¯å¦ç¬¦åˆè¦æ±‚
          // å¦åˆ™æŠ›å‡ºIndexOutOfBoundsExceptionå¼‚å¸¸
        rangeCheckForAdd(index);

        ensureCapacityInternal(size + 1);  // Increments modCount!!co
          // æ‹·è´æ“ä½œ
        System.arraycopy(elementData, index, elementData, index + 1,
                         size - index);
        elementData[index] = element;
        size++;
    &#125;
</code></pre>
<h3 id="addAll"><a href="#addAll" class="headerlink" title="addAll"></a>addAll</h3><p>æ ¹æ®ä½ç½®ä¸åŒä¹Ÿæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œ <code>addAll()</code>çš„æ—¶é—´å¤æ‚åº¦ä¸ä»…è·Ÿæ’å…¥å…ƒç´ çš„å¤šå°‘æœ‰å…³ï¼Œä¹Ÿè·Ÿæ’å…¥çš„ä½ç½®ç›¸å…³ã€‚</p>
<pre><code class="java">public boolean addAll(Collection&lt;? extends E&gt; c) &#123;
        Object[] a = c.toArray();
        int numNew = a.length;
        ensureCapacityInternal(size + numNew);  // Increments modCount
        System.arraycopy(a, 0, elementData, size, numNew);
        size += numNew;
        return numNew != 0;
    &#125;
</code></pre>
<pre><code class="java">public boolean addAll(int index, Collection&lt;? extends E&gt; c) &#123;
              //æ£€æŸ¥indexæ˜¯å¦åˆæ ¼ï¼Œå¦åˆ™æŠ›å‡ºIndexOutOfBoundsExceptionå¼‚å¸¸
        rangeCheckForAdd(index);

        Object[] a = c.toArray();
        int numNew = a.length;
        ensureCapacityInternal(size + numNew);  // Increments modCount

        int numMoved = size - index;
        if (numMoved &gt; 0)
            System.arraycopy(elementData, index, elementData, index + numNew,
                             numMoved);

        System.arraycopy(a, 0, elementData, index, numNew);
        size += numNew;
        return numNew != 0;
    &#125;
</code></pre>
<h3 id="remove"><a href="#remove" class="headerlink" title="remove()"></a>remove()</h3><p><code>remove()</code>æ–¹æ³•ä¹Ÿæœ‰ä¸¤ä¸ªç‰ˆæœ¬</p>
<p>ä¸€ä¸ªæ˜¯<code>remove(int index)</code>åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ </p>
<p>å¦ä¸€ä¸ªæ˜¯<code>remove(Object o)</code>åˆ é™¤ç¬¬ä¸€ä¸ªæ»¡è¶³<code>o.equals(elementData[index])</code>çš„å…ƒç´ .</p>
<p>åˆ é™¤æ“ä½œæ˜¯<code>add()</code>æ“ä½œçš„é€†è¿‡ç¨‹ï¼Œéœ€è¦å°†åˆ é™¤ç‚¹ä¹‹åçš„å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚</p>
<blockquote>
<p>æœ€åä¸€ä¸ªä½ç½®ä¸æ‰‹åŠ¨èµ‹<code>null</code>å€¼ï¼Œé™¤éå¯¹åº”çš„ä½ç½®è¢«å…¶ä»–å…ƒç´ è¦†ç›–ï¼Œå¦åˆ™åŸæ¥çš„å¯¹è±¡å°±ä¸€ç›´ä¸ä¼šè¢«å›æ”¶ã€‚</p>
</blockquote>
<pre><code class="java">    /**
     * Removes the element at the specified position in this list.
     * Shifts any subsequent elements to the left (subtracts one from their
     * indices).
     *
     * @param index the index of the element to be removed
     * @return the element that was removed from the list
     * @throws IndexOutOfBoundsException &#123;@inheritDoc&#125;
     */
    public E remove(int index) &#123;
        rangeCheck(index);

        modCount++;
        E oldValue = elementData(index);

        int numMoved = size - index - 1;
        if (numMoved &gt; 0)
            System.arraycopy(elementData, index+1, elementData, index,
                             numMoved);
        elementData[--size] = null; // clear to let GC do its work

        return oldValue;
    &#125;
</code></pre>
<pre><code class="java">    /**
     * Removes the first occurrence of the specified element from this list,
     * if it is present.  If the list does not contain the element, it is
     * unchanged.  More formally, removes the element with the lowest index
     * &lt;tt&gt;i&lt;/tt&gt; such that
     * &lt;tt&gt;(o==null&amp;nbsp;?&amp;nbsp;get(i)==null&amp;nbsp;:&amp;nbsp;o.equals(get(i)))&lt;/tt&gt;
     * (if such an element exists).  Returns &lt;tt&gt;true&lt;/tt&gt; if this list
     * contained the specified element (or equivalently, if this list
     * changed as a result of the call).
     *
     * @param o element to be removed from this list, if present
     * @return &lt;tt&gt;true&lt;/tt&gt; if this list contained the specified element
     */
    public boolean remove(Object o) &#123;
        if (o == null) &#123;
            for (int index = 0; index &lt; size; index++)
                if (elementData[index] == null) &#123;
                    fastRemove(index);
                    return true;
                &#125;
        &#125; else &#123;
            for (int index = 0; index &lt; size; index++)
                if (o.equals(elementData[index])) &#123;
                    fastRemove(index);
                    return true;
                &#125;
        &#125;
        return false;
    &#125;
</code></pre>
<h3 id="trimToSize"><a href="#trimToSize" class="headerlink" title="trimToSize()"></a>trimToSize()</h3><p>æŠŠæ‰©å®¹åæœªä½¿ç”¨çš„ç©ºé—´å»æ‰ï¼Œä¿ç•™æœ‰å…ƒç´ çš„éƒ¨åˆ†</p>
<pre><code class="java">    /**
     * Trims the capacity of this &lt;tt&gt;ArrayList&lt;/tt&gt; instance to be the
     * list&#39;s current size.  An application can use this operation to minimize
     * the storage of an &lt;tt&gt;ArrayList&lt;/tt&gt; instance.
     */
    public void trimToSize() &#123;
        modCount++;
        if (size &lt; elementData.length) &#123;
              //å¤åˆ¶äº†elementDataä¸­çš„sizeä¸ªæœ‰æ•ˆå…ƒç´ ï¼Œå†é‡æ–°ç»™elementData
            elementData = (size == 0)
              ? EMPTY_ELEMENTDATA
              : Arrays.copyOf(elementData, size);
        &#125;
    &#125;
</code></pre>
<h2 id="å…³äºmodCount"><a href="#å…³äºmodCount" class="headerlink" title="å…³äºmodCount"></a>å…³äºmodCount</h2><p>ArrayListè™½ç„¶æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¿«é€Ÿå¤±è´¥çš„æœºåˆ¶ï¼Œé€šè¿‡è®°å½•<code>modCount</code>å‚æ•°æ¥å®ç°ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°æºç ä¸­æœ‰å¾ˆå¤š<code>modCount++;</code>çš„æ“ä½œ,æ¯ä¸€æ¬¡ArrayListç»“æ„å‘ç”Ÿæ”¹å˜çš„æ—¶å€™(ä¸Šè¿°æåˆ°çš„æ‰€æœ‰æ–¹æ³•)ï¼Œéƒ½ä¼šè®°å½•ä¸€æ¬¡ï¼Œåœ¨é¢å¯¹å¹¶å‘çš„ä¿®æ”¹æ—¶ï¼Œè¿­ä»£å™¨å¾ˆå¿«å°±ä¼šå®Œå…¨å¤±è´¥ï¼Œè€Œä¸æ˜¯å†’ç€åœ¨å°†æ¥æŸä¸ªä¸ç¡®å®šæ—¶é—´å‘ç”Ÿä»»æ„ä¸ç¡®å®šè¡Œä¸ºçš„é£é™©ã€‚</p>
<p>ç”¨æ­¤å˜é‡æ¥æ£€éªŒåœ¨è¿­ä»£è¿‡ç¨‹ä¸­Listå¯¹è±¡æ˜¯å¦è¢«ä¿®æ”¹äº†ï¼Œå¦‚æœè¢«ä¿®æ”¹äº†åˆ™æŠ›å‡ºæ¥java.util.ConcurrentModificationExceptionå¼‚å¸¸</p>
<h2 id="å…³äº-Arrays-copyOf-å’Œ-System-arraycopy"><a href="#å…³äº-Arrays-copyOf-å’Œ-System-arraycopy" class="headerlink" title="å…³äº Arrays.copyOf å’Œ System.arraycopy"></a>å…³äº Arrays.copyOf å’Œ System.arraycopy</h2><h3 id="Arrays-copyOf"><a href="#Arrays-copyOf" class="headerlink" title="Arrays.copyOf"></a>Arrays.copyOf</h3><pre><code class="java">    public static &lt;T,U&gt; T[] copyOf(U[] original, int newLength, Class&lt;? extends T[]&gt; newType) &#123;
        @SuppressWarnings(&quot;unchecked&quot;)
        T[] copy = ((Object)newType == (Object)Object[].class)
            ? (T[]) new Object[newLength]
            : (T[]) Array.newInstance(newType.getComponentType(), newLength);
        System.arraycopy(original, 0, copy, 0,
                         Math.min(original.length, newLength));
        return copy;
    &#125;
</code></pre>
<h3 id="System-arraycopy"><a href="#System-arraycopy" class="headerlink" title="System.arraycopy"></a>System.arraycopy</h3><pre><code class="java">public static native void arraycopy(Object src,  int  srcPos,
                                        Object dest, int destPos,
                                        int length);
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒArrays.copyOfå†…è°ƒç”¨äº†System.arraycopyã€‚</p>
<p>ç®€å•çš„è¯´ï¼ŒArray.copyOf()å¯ä»¥çœ‹ä½œæ˜¯å—é™çš„System.arraycopy(),å®ƒä¸»è¦æ˜¯ç”¨æ¥å°†åŸæ•°ç»„å…¨éƒ¨æ‹·è´åˆ°ä¸€ä¸ªæ–°é•¿åº¦çš„æ•°ç»„ï¼Œé€‚ç”¨äºæ•°ç»„æ‰©å®¹ã€‚</p>
]]></content>
      <categories>
        <category>JavaCollection</category>
      </categories>
      <tags>
        <tag>JavaCollection</tag>
      </tags>
  </entry>
  <entry>
    <title>ElasticSearchè¸©å‘è®°å½•</title>
    <url>/2021/11/08/ElasticSearch_error/</url>
    <content><![CDATA[<h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><p>å…¥é—¨å°ç™½ä¸€å®šè¦ç»™eså¼€å¤§ä¸€ç‚¹çš„jvmå †ç©ºé—´ï¼åˆ«ä¸ç‚¹è¿›æ¥å°±èµ°ï¼</p>
<span id="more"></span>

<h1 id="ElasticSearchè¸©å‘è®°å½•"><a href="#ElasticSearchè¸©å‘è®°å½•" class="headerlink" title="ElasticSearchè¸©å‘è®°å½•"></a>ElasticSearchè¸©å‘è®°å½•</h1><h3 id="é—®é¢˜æè¿°ï¼š"><a href="#é—®é¢˜æè¿°ï¼š" class="headerlink" title="é—®é¢˜æè¿°ï¼š"></a>é—®é¢˜æè¿°ï¼š</h3><p>ç¯å¢ƒï¼šdockerå®‰è£…äº†eså’Œkibanaï¼Œå…¶ä¸­æœåŠ¡å™¨ä¸º1æ ¸2gï¼Œè€ƒè™‘åˆ°esä¼šå ç”¨è¾ƒå¤§å†…å­˜ï¼Œåœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™å°±é™åˆ¶äº†å †å¤§å°<code>ES_JAVA_OPTS=&quot;-Xms64m -Xmx128m</code></p>
<p>åœ¨å­¦ä¹ esåˆ†è¯å™¨çš„æ—¶å€™ï¼Œåœ¨ç»™eså®‰è£…äº†ikåˆ†è¯å™¨æ’ä»¶åï¼Œrestartåkibanaè¿æ¥ä¸ä¸Šesï¼ŒæŸ¥çœ‹esçš„æ—¥å¿—æ˜¾ç¤º:</p>
<pre><code>&#123;&quot;type&quot;: &quot;server&quot;, &quot;timestamp&quot;: &quot;2021-11-08T13:16:26,709Z&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;component&quot;: &quot;o.e.c.r.a.AllocationService&quot;, &quot;cluster.name&quot;: &quot;elasticsearch&quot;, &quot;node.name&quot;: &quot;aee86155b1ca&quot;, &quot;message&quot;: &quot;Cluster health status changed from [RED] to [YELLOW] (reason: [shards started [[.kibana_1][0]]]).&quot;, &quot;cluster.uuid&quot;: &quot;Q5-PS477TBSHlcrsvR7cEg&quot;, &quot;node.id&quot;: &quot;O_-bMvZZQAG6XjGQvX_UFA&quot;  &#125; 

&#123;&quot;type&quot;: &quot;server&quot;, &quot;timestamp&quot;: &quot;2021-11-08T13:16:26,863Z&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;component&quot;: &quot;o.e.m.j.JvmGcMonitorService&quot;, &quot;cluster.name&quot;: &quot;elasticsearch&quot;, &quot;node.name&quot;: &quot;aee86155b1ca&quot;, &quot;message&quot;: &quot;[gc][6] overhead, spent [355ms] collecting in the last [1s]&quot;, &quot;cluster.uuid&quot;: &quot;Q5-PS477TBSHlcrsvR7cEg&quot;, &quot;node.id&quot;: &quot;O_-bMvZZQAG6XjGQvX_UFA&quot;  &#125;

&#123;&quot;type&quot;: &quot;server&quot;, &quot;timestamp&quot;: &quot;2021-11-08T13:16:51,973Z&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;component&quot;: &quot;o.e.m.j.JvmGcMonitorService&quot;, &quot;cluster.name&quot;: &quot;elasticsearch&quot;, &quot;node.name&quot;: &quot;aee86155b1ca&quot;, &quot;message&quot;: &quot;[gc][31] overhead, spent [310ms] collecting in the last [1s]&quot;, &quot;cluster.uuid&quot;: &quot;Q5-PS477TBSHlcrsvR7cEg&quot;, &quot;node.id&quot;: &quot;O_-bMvZZQAG6XjGQvX_UFA&quot;  &#125;
</code></pre>
<p>ä¸€çœ‹ï¼Œå¥½åƒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œåœ¨postmanå‘eså‘é€è¯·æ±‚ä¹Ÿèƒ½returnï¼ŒæŸ¥çœ‹èŠ‚ç‚¹å¥åº·çŠ¶å†µä¹Ÿæ²¡é—®é¢˜</p>
<p>æ¥ç€æƒ³åˆ°äº†kibanaçš„é—®é¢˜ï¼Œå°è¯•æŸ¥çœ‹kibanaçš„æ—¥å¿—ï¼Œä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼š</p>
<pre><code>[parent] Data too large, data for [&lt;http_request&gt;] would be [125973240/120.1mb], which is larger than the limit of [123273216/117.5mb],
</code></pre>
<blockquote>
<p>æˆªå–äº†å…¶ä¸­ä¸€éƒ¨åˆ†æ—¥å¿—</p>
</blockquote>
<p>å°±æƒ³åˆ°å¯èƒ½åˆ†é…ç»™esçš„å †å†…å­˜ä¸å¤Ÿï¼Œä¸Šç½‘æŸ¥é˜…äº†ä¸€ä¸‹èµ„æ–™ï¼Œå¤§æ¦‚æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>ä¿®æ”¹<code>jvm.options</code>çš„å †å†…å­˜é…ç½®</p>
<pre><code class="yaml">-Xms64m
-Xmx256m
</code></pre>
<p>è¿™é‡Œæ ¹æ®è‡ªå·±æœåŠ¡å™¨çš„é…ç½®ä¿®æ”¹ä½¿ç”¨</p>
</li>
<li><p>ä¿®æ”¹<code>elasticsearch.yml</code>å…³äºå†…å­˜å›æ”¶çš„é…ç½®</p>
<pre><code class="yaml"># æœ‰äº†è¿™ä¸ªè®¾ç½®ï¼Œæœ€ä¹…æœªä½¿ç”¨ï¼ˆLRUï¼‰çš„ fielddata ä¼šè¢«å›æ”¶ä¸ºæ–°æ•°æ®è…¾å‡ºç©ºé—´
# æ§åˆ¶fielddataå…è®¸å†…å­˜å¤§å°ï¼Œè¾¾åˆ°HEAP 20% è‡ªåŠ¨æ¸…ç†æ—§cache
indices.fielddata.cache.size: 20%
indices.breaker.total.use_real_memory: false
# fielddata æ–­è·¯å™¨é»˜è®¤è®¾ç½®å †çš„ 60% ä½œä¸º fielddata å¤§å°çš„ä¸Šé™ã€‚
indices.breaker.fielddata.limit: 40%
# request æ–­è·¯å™¨ä¼°ç®—éœ€è¦å®Œæˆå…¶ä»–è¯·æ±‚éƒ¨åˆ†çš„ç»“æ„å¤§å°ï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªèšåˆæ¡¶ï¼Œé»˜è®¤é™åˆ¶æ˜¯å †å†…å­˜çš„ 40%ã€‚
indices.breaker.request.limit: 40%
# total æ‰åˆ request å’Œ fielddata æ–­è·¯å™¨ä¿è¯ä¸¤è€…ç»„åˆèµ·æ¥ä¸ä¼šä½¿ç”¨è¶…è¿‡å †å†…å­˜çš„ 70%(é»˜è®¤å€¼)ã€‚
indices.breaker.total.limit: 95%
</code></pre>
<p>è¿™ä¸€éƒ¨åˆ†æ˜¯ç›´æ¥æŠ„ä½œä¸šçš„ï¼Œè¯¦ç»†çš„å†…å®¹è¿˜æ˜¯å¾—ä»¥åå†å­¦</p>
</li>
</ul>
<p>ä¿®æ”¹åå¯åŠ¨æŸ¥çœ‹æ—¥å¿—ï¼Œæ¬§çœŸä¸é”™ï¼</p>
<p><img src="/2021/11/08/ElasticSearch_error/11.8_1.png"></p>
<blockquote>
<p>æ”’é’±ä¹°æœåŠ¡å™¨å»äº†ï¼Œå‘œå‘œå‘œï½</p>
</blockquote>
<p><img src="/2021/11/08/ElasticSearch_error/11.8_2.png"></p>
]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title>ElasticSearchåˆæ¢</title>
    <url>/2021/11/06/ElasticSearch/</url>
    <content><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ElasticSearchä½œä¸ºELKæœç´¢å¼•æ“ä¸‰å‰‘å®¢é‡Œä¸€å‘˜ï¼Œä½œä¸ºåˆ†å¸ƒå¼æœç´¢å¼•æ“å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œæä¾›äº†å…¨æ–‡æ£€ç´¢ã€ç»“æ„åŒ–æœç´¢ä»¥åŠèšåˆç­‰åŠŸèƒ½ï¼Œåº”ç”¨äºå¤§æ•°æ®å’Œä½œä¸ºæœç´¢å¼•æ“ç­‰æ–¹å‘</p>
<span id="more"></span>

<h1 id="ElasticSearch"><a href="#ElasticSearch" class="headerlink" title="ElasticSearch"></a>ElasticSearch</h1><h2 id="æ£€ç´¢"><a href="#æ£€ç´¢" class="headerlink" title="æ£€ç´¢"></a>æ£€ç´¢</h2><h3 id="åˆæ­¥"><a href="#åˆæ­¥" class="headerlink" title="åˆæ­¥"></a>åˆæ­¥</h3><ul>
<li><p>_cat</p>
<ul>
<li><p> <strong>GET + /_cat/nodes</strong> ï¼šæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</p>
</li>
<li><p> <strong>GET + /_cat/health</strong> ï¼šæ£€æŸ¥eså¥åº·æƒ…å†µ</p>
</li>
<li><p> <strong>GET + /_cat/master</strong> ï¼šæŸ¥çœ‹ä¸»èŠ‚ç‚¹</p>
</li>
<li><p> <strong>GET + /_cat/indices</strong> ï¼š æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•</p>
</li>
</ul>
</li>
<li><p> ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ï¼ˆä¿å­˜ï¼‰ï¼Œæ ¼å¼ï¼š</p>
</li>
<li><p><strong>PUT +  customer/extend/1 + jsonæ•°æ®</strong>ï¼š PUTè¯·æ±‚ï¼Œä¿å­˜åœ¨<strong>customerç´¢å¼•</strong>ä¸‹çš„<strong>extendç±»å‹</strong>ä¸‹çš„<strong>idä¸º1</strong>çš„<strong>æ•°æ®</strong>(jsonå†…å®¹)</p>
<ul>
<li>å…¶ä¸­ï¼ŒPOSTè¯·æ±‚å¯å¸¦å¯ä¸å¸¦idï¼Œä¸å¸¦çš„è¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„idï¼ˆå¹¶æ–°å¢ç‰ˆæœ¬å·ï¼Œ<code>_seq_no</code>ï¼Œä¹è§‚é”ï¼‰ï¼Œè€ŒPUTè¯·æ±‚å¿…é¡»æŒ‡å®šid</li>
</ul>
</li>
</ul>
<p><img src="/2021/11/06/ElasticSearch/11.6_1.png"></p>
<ul>
<li><p>æŸ¥è¯¢æ–‡æ¡£</p>
<ul>
<li><strong>GET + customer/extend/1</strong> æ ¼å¼åŒä¸Š</li>
</ul>
</li>
<li><p>æ›´æ–°æ–‡æ¡£</p>
<ul>
<li><p><strong>POST + /customer/extend/1/_update</strong></p>
<ul>
<li><p>åªèƒ½ç”¨<strong>post</strong>è¯·æ±‚,æ³¨æ„jsonå†…å®¹</p>
</li>
<li><p>å½“esæ£€ç´¢åˆ°æ›´æ–°å†…å®¹ä¸å˜æ—¶ï¼Œresultæ˜¾ç¤ºnoopï¼ˆè¡¨ç¤ºæ²¡æœ‰å˜æ›´ï¼‰ï¼Œæ­¤æ—¶<code>_version</code>å’Œ<code>_seq_no</code>çš„æ•°å€¼å‡æœªå˜</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/2021/11/06/ElasticSearch/11.6_2.png"></p>
<ul>
<li><p>åˆ é™¤æ–‡æ¡£&amp;&amp;ç´¢å¼•</p>
<ul>
<li><strong>DELETE + customer/extend/1</strong></li>
<li><strong>DELETE + customer</strong><ul>
<li>esæœªæä¾›åˆ é™¤æŸç§ç‰¹å®šç±»å‹çš„æ“ä½œ</li>
</ul>
</li>
</ul>
</li>
<li><p>bulkæ‰¹é‡API</p>
<ul>
<li><p>æ ¼å¼ï¼š</p>
<pre><code class="json">&#123;action:&#123;metadata&#125;&#125;
&#123;requstbody&#125;
</code></pre>
<ul>
<li><code>action</code>æŒ‡è¡Œä¸ºï¼šåŒ…å«createã€updateã€indexã€delete<ul>
<li>å¦‚æœæ•°æ®å­˜åœ¨(ç›¸åŒ)ï¼Œcreateä¼šæ‰§è¡Œå¤±è´¥ï¼Œindexå¯ä»¥æˆåŠŸæ‰§è¡Œ</li>
</ul>
</li>
<li><code>metadata</code>æŒ‡å…·ä½“ç´¢å¼•ä¿¡æ¯ï¼Œéœ€è¦æŒ‡æ˜<code>_index</code>ã€<code>_type</code>ã€-<code>_id</code>(ç”¨æ¥æ›¿ä»£å‘é€requestè¯·æ±‚ä¸­urlçš„ä¿¡æ¯)</li>
<li><code>Requestbody</code>åˆ™æ˜¯å¯¹åº”çš„jsonæ•°æ®ï¼ˆæ‰¹é‡åˆ é™¤æ—¶ä¸éœ€è¦è¯·æ±‚ä½“ï¼‰</li>
</ul>
</li>
<li><p>å¯ä»¥åœ¨kibanaæä¾›çš„æ§åˆ¶å°ä¸­æ“æ§</p>
</li>
<li><blockquote>
<p>æ€è€ƒï¼šä¸ºä»€ä¹ˆæ‰¹é‡å¤„ç†çš„æ•°æ®æ ¼å¼ä¸ä¸º<code>[&#123;&quot;action&quot;:&#123;&#125;,&quot;data&quot;:&#123;&#125;&#125;]</code>å‘¢ï¼Œè¿™æ ·å¯è¯»æ€§æ›´å¥½ï¼Ÿ</p>
<ul>
<li>åˆšå¼€å§‹æˆ‘ä¹Ÿå¾ˆç–‘æƒ‘ï¼ŒæŸ¥é˜…åšå®¢åï¼Œè¯´æ˜¯è€ƒè™‘åˆ°javaè™šæ‹Ÿæœºçš„æ€§èƒ½ï¼Œä½¿ç”¨<code>es</code>ç­‰å·²ç»æ˜¯æ¯”è¾ƒè€—è´¹å†…å­˜çš„äº†ï¼Œè¿˜å¾—è§£æjsonæ•°ç»„ååœ¨è¿›è¡Œæ“ä½œï¼Œå‰è€…ç›¸å¯¹äºåè€…å°‘äº†<strong>è§£æ</strong>è¿™ä¸€æ­¥æ“ä½œ</li>
</ul>
</blockquote>
<blockquote>
<p>ä¸€æ¬¡bulkçš„æ•°æ®ä¸åº”è¯¥å¤ªå¤š</p>
<ul>
<li>å®¹æ˜“å¯¼è‡´è¶…æ—¶ï¼Œé»˜è®¤è¶…æ—¶æ—¶é—´10s</li>
<li>æ•°æ®å¤ªå¤šæ€§èƒ½ä¼šä¸‹é™</li>
</ul>
</blockquote>
</li>
</ul>
</li>
</ul>
<p>ESåœ¨7.0ç‰ˆæœ¬åé€æ¸ç§»é™¤äº†ç±»å‹/typeè¿™ä¸€æ¦‚å¿µ</p>
<p>![æˆªå±2021-11-08 ä¸‹åˆ3.56.10](/Users/kokorozashiguohuang/Library/Application Support/typora-user-images/æˆªå±2021-11-08 ä¸‹åˆ3.56.10.png)</p>
<p>åœ¨7.0ç‰ˆæœ¬ä½¿ç”¨typeç±»å‹è¿›è¡Œæ“ä½œæ—¶ï¼Œä¼šæœ‰warnæç¤º</p>
<p>ä½†8.0ç‰ˆæœ¬åˆ™æ˜¯å¼ºåˆ¶æŠ¥é”™</p>
<p>æŸ¥é˜…äº†esçš„å®˜æ–¹æ–‡æ¡£å’Œä¸€äº›åšå®¢åï¼Œæ€»ç»“äº†ä¸€ä¸‹ï¼š</p>
<p>esåŸºäºluceneå¼€å‘ï¼Œè€Œåœ¨luceneä¸­ï¼Œæ²¡æœ‰typeçš„æ¦‚å¿µçš„ã€‚</p>
<p>è¡¨é¢ä¸Šçœ‹ï¼Œesçš„<strong>index(ç´¢å¼•)<strong>å¯¹æ¯”çš„æ˜¯</strong>æ•°æ®åº“</strong>ï¼Œ<strong>type(ç±»å‹)<strong>å¯¹åº”çš„æ˜¯</strong>è¡¨</strong>ï¼Œ**field(å­—æ®µ)**ç±»æ¯”çš„æ˜¯ä¸€è¡Œæ•°æ®</p>
<p>å¯æ˜¯åœ¨å†…éƒ¨é‡Œï¼Œä¸€ä¸ªindex(ç´¢å¼•)ä¸åŒtype(ç±»å‹)ä¸‹åŒåfield(å­—æ®µ)åœ¨å‚¨å­˜åœ¨luceneå†…éƒ¨åŒä¸€ä¸ªfield(å­—æ®µ)ä¸­ï¼Œesä¹‹å‰ç‰ˆæœ¬é€šè¿‡ç»´æŠ¤_typeå­—æ®µæ¥ä¸“é—¨åŒºåˆ†ä¸åŒçš„typeã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ•°æ®åº“å…è®¸<strong>åŒä¸€ä¸ªåº“</strong>ä¸‹<strong>ä¸åŒè¡¨</strong>æœ‰<strong>åŒåçš„åˆ—</strong>ï¼Œè€Œesä¸å…è®¸ã€‚</p>
<p>è¿™ä¼šå¸¦æ¥æ•°æ®æ£€ç´¢çš„ä¸€äº›ä¸ä¾¿ä»¥åŠç”±äºæ•°æ®ç¨€ç–é€ æˆå½±å“eså‹ç¼©æ•°æ®æ€§èƒ½ç­‰ä¸ä¾¿</p>
<h3 id><a href="#" class="headerlink" title></a></h3>]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title>æ“ä½œç³»ç»Ÿ</title>
    <url>/2021/10/21/Operating_system/</url>
    <content><![CDATA[<p>å­¦ä¹ æ“ä½œç³»ç»Ÿæ—¶å€™çš„ä¸€äº›<strong>è¾“å‡º</strong>ï¼Œç›®çš„æ˜¯ä¸ºäº†åŠ å¼ºè®°å¿†ä»¥åŠåç»­æ—¶é—´èƒ½å¿«é€Ÿå¤ä¹ è¿™ä¸€éƒ¨åˆ†çš„çŸ¥è¯†</p>
<span id="more"></span>

<h2 id="å†…å­˜ç®¡ç†"><a href="#å†…å­˜ç®¡ç†" class="headerlink" title="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†</h2><h3 id="å†…å­˜åˆ†æ®µ"><a href="#å†…å­˜åˆ†æ®µ" class="headerlink" title="å†…å­˜åˆ†æ®µ"></a>å†…å­˜åˆ†æ®µ</h3><p>åˆ†æ®µä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œä»¥åŠå†…å­˜äº¤æ¢çš„æ•ˆç‡ä½çš„é—®é¢˜</p>
<h4 id="ä»€ä¹ˆæ˜¯å†…å­˜äº¤æ¢å‘¢ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å†…å­˜äº¤æ¢å‘¢ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…å­˜äº¤æ¢å‘¢ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å†…å­˜äº¤æ¢å‘¢ï¼Ÿ</h4><ul>
<li><p>åˆ†æ®µå¼å†…å­˜ç®¡ç†ä¼šäº§ç”Ÿä¸€äº›å†…å­˜ç¢ç‰‡</p>
<ul>
<li>å¤–éƒ¨ç¢ç‰‡-&gt;äº§ç”Ÿå¤šä¸ªä¸è¿ç»­çš„å°å†…å­˜</li>
<li>å†…éƒ¨ç¢ç‰‡-&gt;ç¨‹åº<strong>ä¸å¸¸ç”¨</strong>çš„å†…å­˜ä¹Ÿè¢«è£…åœ¨åˆ°ç‰©ç†å†…å­˜ä¸Š</li>
</ul>
</li>
<li><p>ä¸ºäº†åˆ©ç”¨å¥½è¿™ä¸€éƒ¨åˆ†çš„å†…å­˜ç¢ç‰‡ï¼ˆå¤–éƒ¨ï¼‰ï¼Œå¯ä»¥æŠŠé€šè¿‡æŠŠç¨‹åº<strong>ä»å†…å­˜è¯»å…¥ç¡¬ç›˜</strong>å†ä»<strong>ç¡¬ç›˜é‡æ–°è¯»åˆ°å†…å­˜</strong>çš„æ–¹å¼ï¼Œè¿™ä¸€éƒ¨åˆ†åœ¨ç¡¬ç›˜ä¸Šçš„ç©ºé—´å°±å«åšå†…å­˜äº¤æ¢ç©ºé—´</p>
</li>
</ul>
<h4 id="ä¸ºä»€ä¹ˆå†…å­˜åˆ†æ®µçš„å†…å­˜äº¤æ¢ç‡ä½å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå†…å­˜åˆ†æ®µçš„å†…å­˜äº¤æ¢ç‡ä½å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå†…å­˜åˆ†æ®µçš„å†…å­˜äº¤æ¢ç‡ä½å‘¢ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå†…å­˜åˆ†æ®µçš„å†…å­˜äº¤æ¢ç‡ä½å‘¢ï¼Ÿ</h4><ul>
<li>é¢‘ç¹çš„äº¤æ¢å¯èƒ½ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆ</li>
<li>äº¤æ¢çš„ç¨‹åºå ç”¨å†…å­˜æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œæœºå™¨å¯èƒ½å› ä¸ºæ€§èƒ½åŸå› é€ æˆå¡é¡¿</li>
</ul>
<h3 id="å†…å­˜åˆ†é¡µ"><a href="#å†…å­˜åˆ†é¡µ" class="headerlink" title="å†…å­˜åˆ†é¡µ"></a>å†…å­˜åˆ†é¡µ</h3><p>ä¸ºäº†è§£å†³å†…å­˜åˆ†æ®µçš„é—®é¢˜</p>
<p>æŠŠå†…å­˜ç©ºé—´åˆ‡æˆå›ºå®šå°ºå¯¸ï¼ˆ4kbï¼‰çš„è¿ç»­ç©ºé—´ï¼ˆé¡µï¼‰</p>
<h4 id="æ€ä¹ˆè§£å†³å†…å­˜ç¢ç‰‡å’Œäº¤æ¢ç‡ä½çš„é—®é¢˜å‘¢ï¼Ÿ"><a href="#æ€ä¹ˆè§£å†³å†…å­˜ç¢ç‰‡å’Œäº¤æ¢ç‡ä½çš„é—®é¢˜å‘¢ï¼Ÿ" class="headerlink" title="æ€ä¹ˆè§£å†³å†…å­˜ç¢ç‰‡å’Œäº¤æ¢ç‡ä½çš„é—®é¢˜å‘¢ï¼Ÿ"></a>æ€ä¹ˆè§£å†³å†…å­˜ç¢ç‰‡å’Œäº¤æ¢ç‡ä½çš„é—®é¢˜å‘¢ï¼Ÿ</h4><ul>
<li>å†…å­˜ç¢ç‰‡ï¼šå†…å­˜åˆ†é¡µçš„æœºåˆ¶å†³å®šäº†ä¸ä¼šäº§ç”Ÿæ— æ³•åˆ©ç”¨çš„å°å†…å­˜</li>
<li>äº¤æ¢ç‡ä½<ul>
<li>å½“ç¨‹åºåŠ è½½æ—¶ï¼Œç‰©ç†å†…å­˜åªåŠ è½½è™šæ‹Ÿå†…å­˜é¡µé‡Œé¢<strong>éœ€è¦ç”¨åˆ°</strong>çš„æŒ‡ä»¤å’Œæ•°æ®ï¼ˆå¹¶ä¸ä¸€æ¬¡åŠ è½½ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºï¼‰</li>
<li>å†…å­˜ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œä¼šå°†ã€Œä¸å¸¸ç”¨ã€çš„å†…å­˜é¡µç»™å†™å…¥ç¡¬ç›˜ä¸­ï¼ˆ<strong>é‡Šæ”¾</strong>ï¼‰ï¼Œéœ€è¦ç”¨æ—¶å†åŠ è½½è¿›æ¥</li>
</ul>
</li>
</ul>
<h3 id="æ®µé¡µå¼å†…å­˜ç®¡ç†"><a href="#æ®µé¡µå¼å†…å­˜ç®¡ç†" class="headerlink" title="æ®µé¡µå¼å†…å­˜ç®¡ç†"></a>æ®µé¡µå¼å†…å­˜ç®¡ç†</h3><h2 id="è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="è¿›ç¨‹ä¸çº¿ç¨‹"></a>è¿›ç¨‹ä¸çº¿ç¨‹</h2><h2 id="è°ƒåº¦ç®—æ³•"><a href="#è°ƒåº¦ç®—æ³•" class="headerlink" title="è°ƒåº¦ç®—æ³•"></a>è°ƒåº¦ç®—æ³•</h2><hr>
<h3 id="è¿›ç¨‹è°ƒåº¦ç®—æ³•"><a href="#è¿›ç¨‹è°ƒåº¦ç®—æ³•" class="headerlink" title="è¿›ç¨‹è°ƒåº¦ç®—æ³•"></a>è¿›ç¨‹è°ƒåº¦ç®—æ³•</h3><h4 id="å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ï¼ˆFirst-Come-First-Severd-FCFSï¼‰"><a href="#å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ï¼ˆFirst-Come-First-Severd-FCFSï¼‰" class="headerlink" title="å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ï¼ˆFirst Come First Severd, FCFSï¼‰"></a>å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ï¼ˆ<strong>First Come First Severd, FCFS</strong>ï¼‰</h4><h4 id="æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆShortest-Job-First-SJFï¼‰"><a href="#æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆShortest-Job-First-SJFï¼‰" class="headerlink" title="æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆShortest Job First, SJFï¼‰"></a>æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆ<strong>Shortest Job First, SJF</strong>ï¼‰</h4><h4 id="é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆHighest-Response-Ratio-Next-HRRNï¼‰"><a href="#é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆHighest-Response-Ratio-Next-HRRNï¼‰" class="headerlink" title="é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆHighest Response Ratio Next, HRRNï¼‰"></a>é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•ï¼ˆ<strong>Highest Response Ratio Next, HRRN</strong>ï¼‰</h4><p><img src="/2021/10/21/Operating_system/Process_scheduling_1.png"></p>
<h4 id="æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ï¼ˆRound-Robin-RRï¼‰"><a href="#æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ï¼ˆRound-Robin-RRï¼‰" class="headerlink" title="æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ï¼ˆRound Robin, RRï¼‰"></a>æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ï¼ˆ<strong>Round Robin, RR</strong>ï¼‰</h4><ul>
<li>æ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œå…è®¸è¿›ç¨‹åœ¨è¯¥æ—¶é—´æ®µä¸­è¿è¡Œ<ul>
<li>æ—¶é—´ç‰‡ç”¨å®Œï¼Œè¿›ç¨‹è¿˜åœ¨è¿è¡Œåˆ™åˆ‡æ¢å¦ä¸€ä¸ªè¿›ç¨‹</li>
<li>è¿›ç¨‹åœ¨æ—¶é—´ç‰‡ç»“æŸå‰é˜»å¡æˆ–è€…ç»“æŸï¼Œcpuåˆ‡æ¢å¦ä¸€ä¸ªè¿›ç¨‹</li>
</ul>
</li>
</ul>
<h4 id="æœ€é«˜ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•ï¼ˆHighest-Priority-Firstï¼ŒHPFï¼‰"><a href="#æœ€é«˜ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•ï¼ˆHighest-Priority-Firstï¼ŒHPFï¼‰" class="headerlink" title="æœ€é«˜ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•ï¼ˆHighest Priority Firstï¼ŒHPFï¼‰"></a>æœ€é«˜ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•ï¼ˆ<strong>Highest Priority First</strong>ï¼Œ<strong>HPF</strong>ï¼‰</h4><blockquote>
<p>ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹è¿è¡Œ</p>
</blockquote>
<p>è¿›ç¨‹çš„ä¼˜å…ˆçº§å¯ä»¥åˆ†ä¸ºï¼Œé™æ€ä¼˜å…ˆçº§å’ŒåŠ¨æ€ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>é™æ€ä¼˜å…ˆçº§ï¼šè¿›ç¨‹åˆ›å»ºæ—¶å°±å·²ç»ç¡®å®šäº†ä¼˜å…ˆçº§ï¼Œåç»­è¿è¡Œæ—¶é—´å†…æ— æ³•æ”¹å˜</li>
<li>åŠ¨æ€ä¼˜å…ˆçº§ï¼šæ ¹æ®è¿›ç¨‹çš„åŠ¨æ€å˜åŒ–è°ƒæ•´ä¼˜å…ˆçº§ï¼ˆå¦‚ï¼šéšç€æ—¶é—´çš„æ¨ç§»å¢åŠ ç­‰å¾…è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚ï¼‰</li>
</ul>
<p>å¤„ç†ä¼˜å…ˆçº§é«˜çš„æ–¹æ³•ä¹Ÿåˆ†ä¸ºï¼ŒæŠ¢å å¼å’ŒéæŠ¢å å¼ï¼š</p>
<ul>
<li>æŠ¢å å¼ï¼šå°±ç»ªé˜Ÿåˆ—ä¸­å‡ºç°ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹æ—¶ï¼ŒæŒ‚èµ·å½“å‰è¿›ç¨‹ï¼Œè¿è¡Œä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹</li>
<li>éæŠ¢å å¼ï¼šå°±ç»ªé˜Ÿåˆ—ä¸­å‡ºç°ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹æ—¶ï¼Œè¿è¡Œå®Œå½“å‰è¿›ç¨‹ï¼Œå†é€‰æ‹©ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹</li>
</ul>
<h3 id="å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼ˆMultilevel-Feedback-Queueï¼‰"><a href="#å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼ˆMultilevel-Feedback-Queueï¼‰" class="headerlink" title="å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼ˆMultilevel Feedback Queueï¼‰"></a>å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼ˆ<strong>Multilevel Feedback Queue</strong>ï¼‰</h3><p>ç»“åˆäº†ã€Œæ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ã€å’Œã€Œæœ€é«˜ä¼˜å…ˆçº§è°ƒåº¦ã€ç®—æ³•</p>
<p>å…ˆè®¾ç½®äº†å¤šä¸ªé˜Ÿåˆ—ï¼Œ<strong>é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—</strong>å†…çš„è¿›ç¨‹<strong>ä¼˜å…ˆè¢«å¤„ç†</strong>ï¼Œä¸æ­¤åŒæ—¶è¶Šé«˜ä¼˜å…ˆçº§é˜Ÿåˆ—æ‰€<strong>åˆ†é…çš„æ—¶é—´ç‰‡ä¹Ÿè¶ŠçŸ­</strong></p>
<p><img src="/2021/10/21/Operating_system/Process_scheduling_2.png"></p>
<blockquote>
<p>ps:éšä¾¿æ•´äº†å¼ å›¾æ¥ä½“ä¼šä½“ä¼š</p>
</blockquote>
<p>å°è¯•é€šè¿‡ä¸¾ä¸€ä¸ªä¾‹å­æ¥é˜è¿°è¿™ç§è°ƒåº¦ç®—æ³•ï¼š</p>
<ul>
<li><strong>è¿›ç¨‹A</strong>è¿›å…¥é˜Ÿåˆ—ï¼Œæ­¤æ—¶æ²¡æœ‰è¿›ç¨‹åœ¨å¤„ç†ï¼Œå°†è¿›ç¨‹Aæ”¾å…¥æœ€é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—<code>Q1</code>ä¸­ï¼ˆ<strong>å…ˆæ¥å…ˆæœåŠ¡</strong>ï¼‰</li>
<li>è¿‡ä¸€æ®µæ—¶é—´åï¼Œ<strong>è¿›ç¨‹B</strong>è¿›å…¥é˜Ÿåˆ—<ul>
<li>æ­¤æ—¶è‹¥<strong>è¿›ç¨‹A</strong>åœ¨é˜Ÿåˆ—<code>Q1</code>æ‰€è§„å®šçš„æ—¶é—´ç‰‡å†…æœªè¿è¡Œå®Œæˆï¼Œåˆ™å°†<strong>è¿›ç¨‹A</strong>æ”¾å…¥æ¬¡ä¸€çº§é˜Ÿåˆ—<code>Q2</code>ç­‰å¾…è¿è¡Œï¼ˆå°±ç»ªçŠ¶æ€ï¼‰</li>
<li>è‹¥<strong>è¿›ç¨‹A</strong>èƒ½åœ¨<code>Q1</code>æ‰€è§„å®šçš„æ—¶é—´ç‰‡è¿è¡Œå®Œæˆï¼Œåˆ™è¿›ç¨‹Bè¿›å…¥<code>Q1</code>é˜Ÿåˆ—ç­‰å¾…è¿è¡Œ</li>
</ul>
</li>
<li>å†è¿‡ä¸€æ®µæ—¶é—´åï¼Œ<strong>è¿›ç¨‹C</strong>è¿›å…¥é˜Ÿåˆ—<ul>
<li>æ­¤æ—¶è‹¥<strong>è¿›ç¨‹B</strong>åœ¨<code>Q1</code>ä¸­è¿è¡Œï¼Œè¿›ç¨‹Aåœ¨Q2ä¸­ç­‰å¾…ï¼Œåˆ™å°†<strong>è¿›ç¨‹C</strong>æ”¾å…¥<code>Q1</code>é˜Ÿåˆ—ä¸­ç­‰å¾…è¿è¡Œ</li>
<li>å½“è¿›ç¨‹Bè¿è¡Œå®Œæˆåï¼Œç”±äº<strong>è¿›ç¨‹C</strong>æ‰€åœ¨çš„<code>Q1</code>é˜Ÿåˆ—ä¼˜å…ˆçº§æ¯”è¿›ç¨‹Aæ‰€åœ¨çš„<code>Q2</code>é˜Ÿåˆ—é«˜ï¼Œæ‰€ä»¥ä¼˜å…ˆè°ƒåº¦<strong>è¿›ç¨‹C</strong>è¿è¡Œ</li>
</ul>
</li>
</ul>
<hr>
<h3 id="é¡µé¢ç½®æ¢ç®—æ³•"><a href="#é¡µé¢ç½®æ¢ç®—æ³•" class="headerlink" title="é¡µé¢ç½®æ¢ç®—æ³•"></a>é¡µé¢ç½®æ¢ç®—æ³•</h3><h3 id="ç£ç›˜è°ƒåº¦ç®—æ³•"><a href="#ç£ç›˜è°ƒåº¦ç®—æ³•" class="headerlink" title="ç£ç›˜è°ƒåº¦ç®—æ³•"></a>ç£ç›˜è°ƒåº¦ç®—æ³•</h3>]]></content>
      <categories>
        <category>æ“ä½œç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title>Gmallå¼€å‘ç¬”è®°</title>
    <url>/2021/10/20/Gmall_eassy/</url>
    <content><![CDATA[<h2 id="ç®€å•ä»‹ç»"><a href="#ç®€å•ä»‹ç»" class="headerlink" title="ç®€å•ä»‹ç»"></a>ç®€å•ä»‹ç»</h2><p>å­¦ä¹ å®ŒspringCloudåçš„è‡ªå­¦é¡¹ç›®ï¼Œè®°è½½ä¸€äº›å¼€å‘å­¦ä¹ è¿‡ç¨‹ä¸­çš„å¿ƒå¾—</p>
<span id="more"></span>

<h2 id="Gmallå¼€å‘ç¬”è®°"><a href="#Gmallå¼€å‘ç¬”è®°" class="headerlink" title="Gmallå¼€å‘ç¬”è®°"></a>Gmallå¼€å‘ç¬”è®°</h2><h3 id="10-20"><a href="#10-20" class="headerlink" title="10.20"></a>10.20</h3><p>ä¿®å¤äº†å¯åŠ¨äººäººå¼€å‘å¹³å°å¯åŠ¨å¤±è´¥çš„é—®é¢˜ï¼ŒåŸå› æœ‰å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>äº‘æœåŠ¡å™¨çš„mysqlæ•°æ®åº“ç«¯å£æœªå¼€æ”¾ï¼Œä¹‹å‰é…ç½®å¥½çš„å®‰å…¨ç»„è«åæ²¡äº†ï¼Ÿ</li>
<li>åœ¨åŠ å…¥æ–°æ¨¡å—æˆ–è€…å¯¹æ¨¡å—ä¿®æ”¹å®Œè¿›è¡Œ<code>mvn clean/install</code>æ—¶ä¼šæç¤º <code>parent.relativePathâ€˜ of POM io.renren:renren-generator:1.0.0</code>,äºæ˜¯ä¹å‘ç°pom.xmlæ˜¯<strong>parentä¾èµ–</strong>æœªåŠ å…¥<relativePath><ul>
<li><relativePath>çš„ä½œç”¨æ˜¯æŸ¥æ‰¾çˆ¶é¡¹ç›®<strong>pom.xml</strong>çš„ç›¸å¯¹è·¯å¾„ï¼Œç¼ºå°‘è¿™ä¸ªæ ‡ç­¾æ—¶ï¼Œå¯èƒ½ä¼šæ— æ³•ä»å½“å‰pomæ–‡ä»¶çš„ä¸Šä¸€çº§ç›®å½•å»æŸ¥æ‰¾ï¼Œå³å¯èƒ½ä¼šæ— æ³•ç»§æ‰¿çˆ¶æ¨¡å—ä¸­çš„åŒ…<strong>version</strong>ä¿¡æ¯</relativePath></li>
</ul>
</relativePath></li>
<li>å…³äºæ¨¡å—å¯åŠ¨åæ˜¾ç¤ºä¸»ç±»æ— æ³•æ‰¾åˆ°<ul>
<li>å°è¯•<code>mvn clean/install</code>,é‡æ–°åŠ è½½targetæ–‡ä»¶</li>
<li>æŸ¥çœ‹æ¨¡å—çš„å¯åŠ¨é…ç½®æ˜¯å¦æ­£ç¡®</li>
<li>å°è¯•åˆ·æ–°ideaç¼“å­˜å¹¶é‡å¯</li>
</ul>
</li>
</ul>
<h3 id="10-28"><a href="#10-28" class="headerlink" title="10.28"></a>10.28</h3><ul>
<li><p>ä½¿ç”¨<strong>Streamæµ</strong>æ¥ç­›é€‰æ•°æ®(å•è¡¨)ï¼Œåšäº†ä¸€ä¸ªåˆ†çº§çš„æ’åº(å®åœ¨æ²¡æƒ³åˆ°Streamæ“ä½œé‚£ä¹ˆç¥å¥‡)ï¼Œè°ˆè°ˆä½¿ç”¨Streamçš„ä¸€äº›åœºæ™¯ï¼š</p>
<ul>
<li>ç›¸æ¯”äºiteratorï¼Œè¾ƒå¤æ‚çš„å¤šæ­¥å¤„ç†è¿­ä»£é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨streamæµä»¥<strong>æé«˜ä»£ç çš„ç®€æ´æ€§</strong>ï¼ŒæŸå¤±ä¸€äº›å‡ ä¹æ²¡æœ‰çš„æ•ˆç‡(æµè§ˆåšå®¢æ—¶çœ‹åˆ°åˆ«äººåšçš„å®éªŒ)</li>
<li>å¤šæ ¸cpuä¸”æ•°æ®é‡å¤§çš„æ¡ä»¶ä¸‹æ¨èä½¿ç”¨ paralle stream</li>
<li>æ³¨æ„streamä¸­é—´æ“ä½œæ—¶çš„é¢‘ç¹çš„æ‹†ã€è£…ç®±æ“ä½œ</li>
</ul>
</li>
<li><p>åœ¨åå°ç®¡ç†ç³»ç»Ÿï¼Œæ˜¾ç¤ºåç«¯è·å–çš„åˆ†çº§æ’åºåçš„æ•°æ®æ—¶ï¼Œé‡åˆ°äº†<strong>è·¨åŸŸ</strong>çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>
<ul>
<li>é€šè¿‡é…ç½®configç±»ï¼Œæ·»åŠ CorsFilterå’ŒCorsConfigurationæ–¹æ³•ï¼Œæ”¾è¡Œå…è®¸çš„è¯·æ±‚</li>
<li>åœ¨Controllerå±‚ä¸Šæ·»åŠ <code>@CrossOrigin</code>æ³¨è§£</li>
<li>ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ç­‰ä¿¡æ¯</li>
</ul>
</li>
<li><p>ä½¿ç”¨Feignæµ‹è¯•äº†ä¸¤ä¸ªæœåŠ¡æ¨¡å—é—´çš„æœåŠ¡è°ƒç”¨</p>
</li>
<li><p>åå°ç®¡ç†ç³»ç»Ÿçš„å‰ç«¯ä½¿ç”¨äº†Vueå’ŒElementUIï¼ŒèŠ±äº†ä¸€ç‚¹æ—¶é—´å¤ä¹ äº†ä¸¤è€…çš„ä½¿ç”¨</p>
</li>
</ul>
<h3 id="10-31"><a href="#10-31" class="headerlink" title="10.31"></a>10.31</h3><ul>
<li>ä½¿ç”¨é˜¿é‡Œäº‘ossä¸‰æ–¹æœåŠ¡ï¼Œå®Œæˆäº†åå°ç®¡ç†ç³»ç»Ÿ<strong>å›¾ç‰‡</strong>çš„ä¸Šä¼ <br><img src="/2021/10/20/Gmall_eassy/10.31.png"></li>
</ul>
<p>ossæœåŠ¡çš„ç›¸å…³ä¿¡æ¯<strong>å­˜å‚¨åœ¨åç«¯</strong>ä¸­ï¼Œå‰ç«¯å‘åç«¯è¯·æ±‚ç­¾åä¿¡æ¯åï¼Œæ‹¿ç€ç­¾åä¿¡æ¯ç›´æ¥åœ¨å‰ç«¯å°†å›¾ç‰‡å­˜å‚¨åˆ°ossä¸­ï¼Œå…¶ä¸­å›¾ç‰‡åœ¨ossä¸­çš„åœ°å€å­˜å‚¨åœ¨æ•°æ®åº“ä¸­(<strong>æœåŠ¡ç«¯ç­¾ååç›´ä¼ </strong>çš„æ–¹å¼å‡è½»äº†æœåŠ¡ç«¯çš„å‹åŠ›ï¼Œå¹¶ä¿å­˜äº†ossæœåŠ¡)</p>
<ul>
<li>å…³äºéæ³•æ•°æ®çš„æ ¡éªŒ<ul>
<li>å‰ç«¯çš„æ ¡éªŒåªèƒ½ç£ä¿ƒç”¨æˆ·è¾“å…¥åˆæ³•ä¿¡æ¯ï¼Œä½†æ˜¯é€šè¿‡postmanç­‰æ–¹å¼å¯ä»¥ç»•è¿‡å‰ç«¯å‘é€éæ³•ä¿¡æ¯</li>
<li>åç«¯çš„å­—æ®µæ ¡éªŒèƒ½<strong>é¿å…</strong>ç»•è¿‡å‰ç«¯æ–¹å¼å‘é€éæ³•è¯·æ±‚ï¼Œåœ¨åç«¯<strong>Entityç±»</strong>å­—æ®µä¸Šé‡‡ç”¨<code>javax.validation.constraints</code>åŒ…çš„<strong>æ³¨è§£æ ¡éªŒ</strong></li>
</ul>
</li>
</ul>
<h3 id="11-5"><a href="#11-5" class="headerlink" title="11.5"></a>11.5</h3><ul>
<li><p>å…³äºEntityï¼Œåˆ†å‡ºä¸€ä¸ªvoæ¥ç»†åŒ–æ“ä½œï¼Œåœ¨æµè§ˆ<strong>é˜¿é‡ŒJavaå¼€å‘æ‰‹å†Œ</strong>çš„æ—¶å€™ï¼Œä¹Ÿäº†è§£åˆ°é’ˆå¯¹ä¸åŒå±‚ã€é€»è¾‘ä¸“é—¨åŒºåˆ†æœ‰ä¸åŒçš„å¯¹è±¡å¦‚ä¸‹ï¼š</p>
<ul>
<li> <code>POJO</code>ï¼ˆPlain Ordinary Java Objectï¼‰: åœ¨æœ¬è§„çº¦ä¸­ï¼ŒPOJO ä¸“æŒ‡åªæœ‰ setter/getter/toString çš„</li>
</ul>
<p>ç®€å•ç±»ï¼ŒåŒ…æ‹¬ DO/DTO/BO/VO ç­‰ã€‚</p>
<ul>
<li><p> <code>DO</code>ï¼ˆData Objectï¼‰ï¼šé˜¿é‡Œå·´å·´ä¸“æŒ‡æ•°æ®åº“è¡¨ä¸€ä¸€å¯¹åº”çš„ POJO ç±»ã€‚æ­¤å¯¹è±¡ä¸æ•°æ®åº“è¡¨ç»“æ„ä¸€ä¸€å¯¹åº”ï¼Œé€šè¿‡ DAO å±‚å‘ä¸Šä¼ è¾“æ•°æ®æºå¯¹è±¡ã€‚</p>
</li>
<li><p> <code>DTO</code>ï¼ˆData Transfer Objectï¼‰ï¼šæ•°æ®ä¼ è¾“å¯¹è±¡ï¼ŒService æˆ– Manager å‘å¤–ä¼ è¾“çš„å¯¹è±¡ã€‚</p>
</li>
<li><p><code>BO</code>ï¼ˆBusiness Objectï¼‰ï¼šä¸šåŠ¡å¯¹è±¡ï¼Œå¯ä»¥ç”± Service å±‚è¾“å‡ºçš„å°è£…ä¸šåŠ¡é€»è¾‘çš„å¯¹è±¡ã€‚</p>
</li>
<li><p><code>VO</code>ï¼ˆView Objectï¼‰ï¼šæ˜¾ç¤ºå±‚å¯¹è±¡ï¼Œé€šå¸¸æ˜¯ Web å‘æ¨¡æ¿æ¸²æŸ“å¼•æ“å±‚ä¼ è¾“çš„å¯¹è±¡ã€‚</p>
</li>
<li><p><code>AO</code>ï¼ˆApplication Objectï¼‰: é˜¿é‡Œå·´å·´ä¸“æŒ‡ Application Objectï¼Œå³åœ¨ Service å±‚ä¸Šï¼Œæä¸ºè´´è¿‘</p>
<p>ä¸šåŠ¡çš„å¤ç”¨ä»£ç ã€‚</p>
</li>
<li><p><code>DO</code>ï¼ˆData Objectï¼‰ï¼šé˜¿é‡Œå·´å·´ä¸“æŒ‡æ•°æ®åº“è¡¨ä¸€ä¸€å¯¹åº”çš„ POJO ç±»ã€‚æ­¤å¯¹è±¡ä¸æ•°æ®åº“è¡¨ç»“æ„ä¸€</p>
<p>ä¸€å¯¹åº”ï¼Œé€šè¿‡ DAO å±‚å‘ä¸Šä¼ è¾“æ•°æ®æºå¯¹è±¡ã€‚</p>
</li>
</ul>
<p>ä¹‹å‰åœ¨ç¬¬ä¸€æ¬¡åšcurdçš„ä¸šåŠ¡æ“ä½œæ—¶ï¼Œå…¨éƒ¨å¯¹è±¡éƒ½æ”¾åœ¨ä¸€ä¸ªPOJOåŒ…é‡Œï¼Œä¸åŒä¸šåŠ¡çš„entityéƒ½æ”¾åœ¨ä¸€ä¸ªåŒ…é‡Œï¼Œå¼€å‘èµ·æ¥<strong>ååˆ†ä¸æ–¹ä¾¿</strong></p>
</li>
<li><p>å…³äºå•†å“çš„å¸¸ç”¨ä¿¡æ¯ï¼Œæ·»åŠ äº†ä¸€ä¸ªæšä¸¾ç±»æ¥å®šä¹‰å¸¸ç”¨çš„ä¿¡æ¯ï¼Œå¦‚å…³äºé‡‡è´­ä¿¡æ¯ï¼š</p>
<ul>
<li><pre><code class="java">CREATED(0,&quot;æ–°å»º&quot;),ASSIGNED(1,&quot;å·²åˆ†é…&quot;),
RECEIVE(2,&quot;å·²é¢†å–&quot;),FINISH(3,&quot;å·²å®Œæˆ&quot;),
HASERROR(4,&quot;æœ‰å¼‚å¸¸&quot;);
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>åœ¨ä½¿ç”¨æ—¶æ˜¯<code>purchaseEntity.setStatus(WareConstant.PurchaseStatusEnum.CREATED.getCode());</code></p>
<p>è™½ç„¶å¯ä»¥ç›´æ¥å†™<code>purchaseEntity.setStatus(0)</code>ç­‰ï¼Œä½†æ˜¯è¿™æ ·æŠ½å–ä¸€ä¸ª<strong>é€šç”¨ç±»</strong>åœ¨<strong>é€»è¾‘ä¸Šèƒ½æ›´åŠ ç›´è§‚ï¼Ÿ</strong>ä¸ªäººä¹Ÿå€¾å‘äºä½¿ç”¨å‰è€…ã€‚</p>
</li>
<li><p>å…³äºä¸šåŠ¡ä»£ç ï¼Œåœ¨ä¸šåŠ¡ä»£ç éƒ¨åˆ†ï¼Œå¹¶æ²¡æœ‰è¯¦ç»†çš„çœ‹ï¼Œå¤§å¤šæ˜¯å›«å›µåæ£ï¼Œ</p>
<ul>
<li>ä¸»è¦æ˜¯æ ¹æ®æ¥å£æ‰‹å†Œï¼Œç¡®å®šæ•°æ®æ¥æ”¶ç±»å‹</li>
<li>åœ¨serviceå±‚é€šè¿‡<code>mybatisplus</code>+<code>Streamæµå¼ç¼–ç¨‹</code>çš„ä»£ç é£æ ¼æ¥å®ç°crud<ul>
<li>ä¹‹å‰å¼€å‘serviceå±‚æ—¶ï¼Œå›¾æ–¹ä¾¿ä½¿ç”¨çš„æ˜¯<strong>mybatisæ³¨è§£å¼€å‘æ–¹å¼</strong>ï¼Œæ³¨è§£å¼€å‘ä¸ªäººæ„Ÿè§‰åæœŸä¸å¥½ç»´æŠ¤ï¼Œè€Œ<code>mybatisplus</code>+<code>Streamæµå¼ç¼–ç¨‹</code>çš„æ–¹å¼æ„Ÿè§‰ä»£ç ç»´æŠ¤èµ·æ¥æ–¹ä¾¿å¾ˆå¤šï¼Œå¯¹äºç›¸å¯¹åº”çš„æ“ä½œä¹Ÿç›´æ¥æ˜äº†</li>
<li>å…³äºmybatisï¼Œåœ¨å­¦ä¹ springå’Œspringbootçš„æ—¶å€™ï¼Œæ„Ÿè§‰<strong>xmlé…ç½®</strong>çš„æ–¹å¼é€æ¸ä¼šè¢«æ·˜æ±°ï¼Œæ³¨è§£å¼€å‘æ‰æ˜¯è¶‹åŠ¿ï¼Ÿä½†æ˜¯<strong>é’ˆå¯¹ç‰¹å®šéœ€æ±‚</strong>çš„æŸ¥è¯¢æ“ä½œç­‰ï¼Œæ„Ÿè§‰è¿˜æ˜¯éœ€è¦mybatisçš„</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>å…³äºå•†åŸåŸºç¡€ç¯‡çš„å­¦ä¹ å·²ç»ç»“æŸï¼Œåç»­è¿˜æœ‰è®©äººæ‰“é¸¡è¡€çš„å¾®æœåŠ¡å’Œéƒ¨ç½²ç¯‡ï¼ŒESåˆ†å¸ƒå¼æœç´¢å¼•æ“ã€rediså®ç°åˆ†å¸ƒå¼é”ã€çœ‹äº†ä¸€æ¬¡éƒ½çœ‹ä¸æ‡‚çš„ç¼“å­˜ä¸€è‡´æ€§ã€å­¦äº†è¿˜æ²¡ç”¨ä¸Šçš„æ¶ˆæ¯é˜Ÿåˆ—ã€å¥½ç©çš„ci/cdç­‰å“ˆå“ˆå“ˆå“ˆå“ˆï¼Œå¼€è½¦å¼€å†²ï¼</p>
</blockquote>
]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
      <tags>
        <tag>Gmall</tag>
      </tags>
  </entry>
  <entry>
    <title>Mysqlæœ€å·¦åŒ¹é…åŸåˆ™</title>
    <url>/2021/10/15/Mysql_LeftmostMatchingPrinciple/</url>
    <content><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>åœ¨ç¾¤å’Œå¤§ä½¬ä»¬å¹æ°´çš„æ—¶å€™äº†è§£åˆ°æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œäºæ˜¯ä¹æƒ³ç¢ç£¨ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œæ•´ç†ä¸€ä¸‹è‡ªå·±äº†è§£çš„å†…å®¹</p>
<span id="more"></span>

<blockquote>
<p>å¼€é—¨è§å±±ï¼Œé¡¾åæ€ä¹‰:</p>
<p>åœ¨Mysqlå»ºç«‹è”åˆç´¢å¼•æ—¶ï¼Œåˆ©ç”¨è¯¥è”åˆç´¢å¼•æ£€ç´¢æ•°æ®æ—¶ä¼šä¼˜å…ˆä»ç´¢å¼•æœ€å·¦åˆ—å¼€å§‹åŒ¹é…</p>
<p>åœ¨åˆ›å»ºå¤šåˆ—ç´¢å¼•æ—¶ï¼Œè¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œwhereå­å¥ä¸­ä½¿ç”¨<strong>æœ€é¢‘ç¹çš„ä¸€åˆ—</strong>æ”¾åœ¨<strong>æœ€å·¦è¾¹</strong>ã€‚</p>
</blockquote>
<p>æµè§ˆäº†ä¸€äº›åšå®¢ï¼Œæ€»ç»“å‡ºä¸€äº›å†…å®¹å¦‚ä¸‹ï¼š</p>
<h3 id="ä¸ºä»€ä¹ˆå«æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå«æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå«æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå«æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ</h3><p>ç´¢å¼•çš„åº•å±‚æ˜¯ä¸€é¢—b+æ ‘ï¼Œé’ˆå¯¹è”åˆç´¢å¼•(a,b)æ¥è¯´ï¼Œè”åˆç´¢å¼•çš„åº•å±‚ä¹Ÿæ˜¯ä¸€ä¸ªB+æ ‘ï¼Œé‚£æ„å»ºä¸€ä¸ªB+æ ‘åªèƒ½é€šè¿‡ä¸€ä¸ªå€¼<br>æ¥æ„å»º</p>
<p>é‚£è”åˆç´¢å¼•(å¤šä¸ªå€¼)æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£å°±é€šè¿‡æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œä¼˜å…ˆæ ¹æ®aæ¥æ„å»ºä¸€ä¸ªç´¢å¼•b+æ ‘ï¼Œå›¾å¤§è‡´å¦‚ä¸‹ï¼š<br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/5.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºå¤šå€¼çš„è”åˆç´¢å¼•ï¼Œä¼˜å…ˆæ ¹æ®æœ€å·¦è¾¹çš„å€¼(a)è¿›è¡Œæ’åºï¼Œå…¶æ¬¡æ ¹æ®å³è¾¹çš„å€¼(b)æ’åºï¼Œç±»ä¼¼äº<code>ORDER BY aï¼Œb</code></p>
<p>å…‰è¯´ä¸å¦‚å¤šåš:<br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/6.png"><br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/3.png"><br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/4.png"><br>å¯ä»¥çœ‹è§ï¼Œå½“sqlä½¿ç”¨åˆ°ç´¢å¼•aæ—¶ï¼Œæ ¹æ®æœ€å·¦åŒ¹é…åŸåˆ™å®šä½åˆ°è”åˆç´¢å¼•(aï¼Œb)çš„a(å› ä¸ºaæ˜¯æœ‰åºçš„)ï¼Œé€šè¿‡<code>EXPLAIN</code>æŸ¥çœ‹åˆ°<code>type</code>æ˜¯<strong>ref</strong>(æ•ˆç‡å¿«è¿‡index)</p>
<p>è€Œåªä½¿ç”¨åˆ°ç´¢å¼•bæ—¶(æ— æ³•æ ¹æ®å…¶açš„å€¼è¿›è¡Œæœ€å·¦åŒ¹é…)ï¼Œå…¶<code>type</code>æ˜¯<strong>index</strong>(æŒ‰ç…§å…¨è¡¨ç´¢å¼•é¡ºåºä¾æ¬¡æ‰«æ)</p>
<h3 id="èŒƒå›´æŸ¥è¯¢å’Œæ¨¡ç³ŠæŸ¥è¯¢æ˜¯å¦å­˜åœ¨æœ€å·¦åŒ¹é…å‘¢ï¼Ÿ"><a href="#èŒƒå›´æŸ¥è¯¢å’Œæ¨¡ç³ŠæŸ¥è¯¢æ˜¯å¦å­˜åœ¨æœ€å·¦åŒ¹é…å‘¢ï¼Ÿ" class="headerlink" title="èŒƒå›´æŸ¥è¯¢å’Œæ¨¡ç³ŠæŸ¥è¯¢æ˜¯å¦å­˜åœ¨æœ€å·¦åŒ¹é…å‘¢ï¼Ÿ"></a>èŒƒå›´æŸ¥è¯¢å’Œæ¨¡ç³ŠæŸ¥è¯¢æ˜¯å¦å­˜åœ¨æœ€å·¦åŒ¹é…å‘¢ï¼Ÿ</h3><h4 id="èŒƒå›´æŸ¥è¯¢"><a href="#èŒƒå›´æŸ¥è¯¢" class="headerlink" title="èŒƒå›´æŸ¥è¯¢"></a>èŒƒå›´æŸ¥è¯¢</h4><p><strong>åªæœ‰</strong>å¯¹è”åˆç´¢å¼•æœ€å·¦åˆ—è¿›è¡ŒæŸ¥è¯¢æ‰ä¼šä½¿ç”¨åˆ°B+æ ‘ç´¢å¼•</p>
<ul>
<li><p>è”åˆç´¢å¼•ä¸‹çš„B+æ ‘æ˜¯ä¼˜å…ˆæŒ‰ç…§æœ€å·¦åˆ—çš„å­—æ®µè¿›è¡Œæ’åºçš„</p>
</li>
<li><p>è€ƒè™‘<code>SELECT * FROM table WHERE a&gt;1 AND a&lt;10 AND b&gt;1</code>çš„æƒ…å†µæ˜¯å¦ä¼šç”¨åˆ°è”åˆç´¢å¼•å‘¢ï¼Ÿ</p>
<ul>
<li>ä¸ä¸€å®šï¼Œåœ¨[1,10]çš„èŒƒå›´å†…ï¼Œbçš„é¡ºåºå¹¶ä¸æ˜¯æœ‰åºçš„,ä¾‹å­ï¼š(1,5)å’Œ(2,1)ï¼ŒaæŒ‰ç…§é¡ºåº1ã€2æœ€å·¦åŒ¹é…ä¼˜å…ˆæ’åºçš„æƒ…å†µä¸‹ï¼Œbçš„é¡ºåºæ˜¯5ï¼Œ1</li>
</ul>
</li>
</ul>
<h4 id="å­—ç¬¦ä¸²æŸ¥è¯¢"><a href="#å­—ç¬¦ä¸²æŸ¥è¯¢" class="headerlink" title="å­—ç¬¦ä¸²æŸ¥è¯¢"></a>å­—ç¬¦ä¸²æŸ¥è¯¢</h4><p>ä¸Šé¢çš„ä¾‹å­éƒ½æ˜¯å¯¹æ•°å­—ç±»å‹çš„ä¸¾ä¾‹ï¼Œæ ¹æ®å¤§å°è¿›è¡Œæ’åºï¼Œé‚£<strong>å­—ç¬¦å‹</strong>å‘¢ï¼Ÿ</p>
<p>ä¼˜å…ˆæ ¹æ®ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¤§å°è¿›è¡Œæ’åºï¼Œå…¶æ¬¡æ ¹æ®ç¬¬äºŒä¸ªå­—ç¬¦çš„å¤§å°ï¼Œå­—ç¬¦å°çš„æ’åºåœ¨å‰é¢(æ ¹æ®ASCIIç ?è¿™é‡ŒåŸ‹ä¸ªå‘ï¼Œæœ‰æ—¶é—´æ¥å¡«)</p>
<p>æ•…åªæœ‰å‰ç¼€åŒ¹é…èƒ½æ˜¯ä½¿ç”¨ç´¢å¼•ï¼Œä¸­ç¼€å’Œåç¼€åªèƒ½ä½¿ç”¨å…¨è¡¨æ‰«æ</p>
<h3 id="sqlä¸­å­—æ®µé¡ºåºæ˜¯å¦è¦å’Œè”åˆç´¢å¼•é¡ºåºä¸€æ ·å‘¢ï¼Ÿ"><a href="#sqlä¸­å­—æ®µé¡ºåºæ˜¯å¦è¦å’Œè”åˆç´¢å¼•é¡ºåºä¸€æ ·å‘¢ï¼Ÿ" class="headerlink" title="sqlä¸­å­—æ®µé¡ºåºæ˜¯å¦è¦å’Œè”åˆç´¢å¼•é¡ºåºä¸€æ ·å‘¢ï¼Ÿ"></a>sqlä¸­å­—æ®µé¡ºåºæ˜¯å¦è¦å’Œè”åˆç´¢å¼•é¡ºåºä¸€æ ·å‘¢ï¼Ÿ</h3><p>mysqlä¸­å…·æœ‰<strong>æŸ¥è¯¢ä¼˜åŒ–å™¨</strong>ï¼Œéƒ½çŸ¥é“sqlçš„å®é™…æ‰§è¡Œé¡ºåºå¹¶ä¸æ˜¯æˆ‘ä»¬è¡¨é¢ä¸Šçœ‹åˆ°çš„ä»SELECTå¼€å§‹<br>å¯¹äºå»ºç«‹äº†è”åˆç´¢å¼•(a,b)çš„sqlæ¥è¯´ï¼Œé€šè¿‡EXPLAINå¯ä»¥æŸ¥çœ‹åˆ°ä¸¤è€…çš„æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’æ˜¯ä¸€æ ·çš„<br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/1.png"><br><img src="/2021/10/15/Mysql_LeftmostMatchingPrinciple/2.png"></p>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCodeæ¯æ—¥äº¿é¢˜</title>
    <url>/2021/10/09/LeetCodeDaily/</url>
    <content><![CDATA[<h1 id="LeetCodeæ¯æ—¥äº¿é¢˜"><a href="#LeetCodeæ¯æ—¥äº¿é¢˜" class="headerlink" title="LeetCodeæ¯æ—¥äº¿é¢˜"></a>LeetCodeæ¯æ—¥äº¿é¢˜</h1><p>è®°å½•ä¸‹è‡ªå·±è§£é¢˜çš„æƒ³æ³•å’Œæ€è·¯ã€‚<br>æ¯å¤©è¿›æ­¥äº¿ç‚¹ç‚¹ï¼Œå¦ˆå¦ˆå¤¸æˆ‘å°å¤©æ‰</p>
<span id="more"></span>


<h2 id="187-é‡å¤çš„DNAåºåˆ—"><a href="#187-é‡å¤çš„DNAåºåˆ—" class="headerlink" title="187. é‡å¤çš„DNAåºåˆ—"></a><a href="https://leetcode-cn.com/problems/repeated-dna-sequences/">187. é‡å¤çš„DNAåºåˆ—</a></h2><p>æ€è·¯ï¼š</p>
<p>æ»‘åŠ¨çª—å£æ¨¡æ‹Ÿï¼Œæ¯æ¬¡å–é•¿åº¦ä¸ºåçš„å­—ç¬¦ä¸²</p>
<p>ä¸¤ä¸ªHashSeté›†åˆï¼Œ<code>setStr</code>ç»´æŠ¤æ¯æ¬¡å­˜å…¥çš„å­—ç¬¦ä¸²ï¼Œ<code>setAns</code>ç»´æŠ¤å·²å‡ºç°è¿‡çš„å­—ç¬¦ä¸²</p>
<p>æœ€åç”¨<code>listString</code>æ¥æ¥æ”¶<code>setAns</code>çš„ç»“æœé›†å¹¶returnå³å¯</p>
<pre><code class="java">class Solution &#123;
    static final int L = 10;
    public List&lt;String&gt; findRepeatedDnaSequences(String s) &#123;
        Set&lt;String&gt; setStr = new HashSet&lt;String&gt;();
        Set&lt;String&gt; setAns = new HashSet&lt;String&gt;();
        for(int i = 0; i &lt;= s.length() - L; i++)&#123;
            String str = s.substring(i,i+L);
            if(setStr.contains(str))&#123;
                setAns.add(str);
            &#125;else&#123;
                setStr.add(str);
            &#125;
        &#125;
        List&lt;String&gt; listString = new ArrayList&lt;String&gt;();
        for(String ans : setAns)&#123;
            listString.add(ans);
        &#125;
        return listString;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/187.png"></p>
<blockquote>
<p>å®˜è§£ç»™çš„æ–¹æ³•ä¸€å†™çš„æ›´å·§å¦™ï¼Œå¯ä»¥å»çœ‹çœ‹</p>
</blockquote>
<h2 id="352-å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´"><a href="#352-å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´" class="headerlink" title="352. å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´"></a><a href="https://leetcode-cn.com/problems/data-stream-as-disjoint-intervals/">352. å°†æ•°æ®æµå˜ä¸ºå¤šä¸ªä¸ç›¸äº¤åŒºé—´</a></h2><p>æ€è·¯ï¼š</p>
<p>ç”¨ä¸€ä¸ªbooleançš„æ•°ç»„ç»´æŠ¤æ•°æ®æµè¾“å…¥æƒ…å†µ</p>
<p>ç”¨ä¸¤ä¸ªå“¨å…µfirstå’Œlastæ¥åˆ¤æ–­è¿ç»­çš„åŒºé—´æƒ…å†µå¹¶å°†å­˜å…¥åˆ°ä¸€ä¸ªArrayListä¸­</p>
<p>æœ€åå°†ArrayListç±»å‹è½¬æ¢ä¸ºä¸€ä¸ªäºŒç»´æ•°ç»„returnå³å¯</p>
<pre><code class="Java">class SummaryRanges &#123;
    static final int NUM = 10001;
    public boolean[] arr = new boolean[NUM];
    public SummaryRanges() &#123;
    &#125;
    public void addNum(int val) &#123;
        arr[val] = true;
    &#125;
    public int[][] getIntervals() &#123;
        List&lt;int[]&gt; res = new ArrayList&lt;int[]&gt;();
        int first = -1;
        int last = -1;
        for(int i = 0 ;i &lt;= 10000;i++)&#123;
            if(arr[i])&#123;
                if(first == -1)&#123;
                    first = i;
                    last = i;
                &#125;else last = i;
            &#125;else&#123;
                if(first != -1)&#123;
                    res.add(new int[]&#123;first,last&#125;);
                    first = -1;
                    last = -1;
                &#125;
            &#125;
        &#125;
        if(first != -1)&#123;
             res.add(new int[]&#123;first,last&#125;);
        &#125;
        return res.toArray(new int[res.size()][2]);
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<code>addNum()</code> ä¸º O(1)<em>O</em>(1)ï¼Œ<code>getIntervals()</code> ä¸º O(C)ï¼ŒC å›ºå®šä¸º10001ã€‚</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šO(C)ï¼ŒC å›ºå®šä¸º10001ã€‚</p>
<p>ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/352.png"></p>
<h2 id="15-ä¸‰æ•°ä¹‹å’Œ"><a href="#15-ä¸‰æ•°ä¹‹å’Œ" class="headerlink" title="15. ä¸‰æ•°ä¹‹å’Œ"></a><a href="https://leetcode-cn.com/problems/3sum/">15. ä¸‰æ•°ä¹‹å’Œ</a></h2><p>æ€è·¯ï¼š</p>
<p>åˆšå¼€å§‹ç›´æ¥æš´åŠ›æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O(N3)</strong>,è¿˜å¾—è€ƒè™‘å»é‡çš„æ­¥éª¤ï¼Œçœ‹äº†é¢˜è§£ä¸å¦‚ç›´æ¥ä½¿ç”¨<strong>æ’åº+åŒæŒ‡é’ˆ</strong>ï¼Œèƒ½å°†æ—¶é—´å¤æ‚åº¦é™åˆ°O(N2)</p>
<p>å…ˆå°†æ•°ç»„æ’åºï¼Œæ—¶é—´å¤æ‚åº¦<strong>O(NlogN)</strong></p>
<p>ç„¶åå›ºå®šæ•°ç»„æœ€å·¦ç«¯æŒ‡é’ˆ<code>i</code>ï¼Œåœ¨<code>i</code>å³ç«¯ä½¿ç”¨ä¸¤ä¸ªåŠ¨æ€æŒ‡é’ˆ<code>jã€k</code>ç§»åŠ¨ï¼Œå°†ä¸‰æ•°ä¹‹å’Œä¸é›¶è¿›è¡Œæ¯”è¾ƒï¼š</p>
<ul>
<li>ç­‰äºé›¶æ—¶ï¼Œå°†ç»“æœæ·»åŠ è¿›Listé›†åˆä¸­ï¼Œç„¶å<code>j</code>æŒ‡é’ˆå‘å³ç§»ï¼Œ<code>k</code>æŒ‡é’ˆå‘å·¦ç§»</li>
<li>å¤§äºé›¶æ—¶ï¼Œ<code>k</code>æŒ‡é’ˆå‘å·¦ç§»ä¸”å»é‡</li>
<li>å°äºé›¶æ—¶ï¼Œ<code>j</code>æŒ‡é’ˆå‘å³ç§»åŠ¨ä¸”å»é‡</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public List&lt;List&lt;Integer&gt;&gt; threeSum(int[] nums) &#123;
        Arrays.sort(nums);
        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList();
        int length = nums.length;
        for(int i = 0 ; i &lt; length-2; i++)&#123;
            if(nums[i] &gt; 0) break;
            if(i&gt;0 &amp;&amp; nums[i] == nums[i-1]) continue;
            int j = i+1; //å·¦æŒ‡é’ˆ
            int k = length-1; //å³æŒ‡é’ˆ
            while(j&lt;k)&#123;
                int total = nums[i] + nums[j] + nums[k];
                if(total&gt;0)&#123;
                    //å»é‡ä¸”å‘å·¦ç§»
                    while(j&lt;k &amp;&amp; nums[k] == nums[--k]);
                &#125;else if(total&lt;0)&#123;
                    //å»é‡ä¸”å‘å³ç§»
                    while(j&lt;k &amp;&amp; nums[j] == nums[++j]);
                &#125;else &#123;
                    res.add(new ArrayList&lt;Integer&gt;(Arrays.asList(nums[i],nums[j],nums[k])));
                    while(j&lt;k &amp;&amp; nums[k] == nums[--k]);
                    while(j&lt;k &amp;&amp; nums[j] == nums[++j]);
                &#125;
            &#125;   
        &#125;
        return res;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š <strong>O(N2)<strong>ï¼Œå›ºå®šæŒ‡é’ˆ<code>i</code>å¤æ‚åº¦</strong>O(N)</strong>,åŠ¨æ€åŒæŒ‡é’ˆ<code>i</code>ã€<code>j</code>**O(N)**çš„å¤æ‚åº¦</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š**O(1)**ï¼ŒæŒ‡é’ˆå ç”¨å¸¸æ•°å¤§å°ç©ºé—´</p>
<p>ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/15.png"></p>
<blockquote>
<p>ä»£ç ä¸­æœ€ä»¤äººæ„Ÿå¹çš„æ˜¯æŒ‡é’ˆå»é‡ä¸”ç§»åŠ¨çš„æ“ä½œï¼š</p>
<p>å¦‚ï¼š<code>while(j&lt;k &amp;&amp; nums[k] == nums[--k]);</code></p>
<p>æ¯æ¬¡çœ‹å¤§ä½¬é¢˜è§£éƒ½æ„Ÿè§‰å—ç›ŠåŒªæµ…</p>
</blockquote>
<h2 id="59-èºæ—‹çŸ©é˜µ-II"><a href="#59-èºæ—‹çŸ©é˜µ-II" class="headerlink" title="59. èºæ—‹çŸ©é˜µ II"></a><a href="https://leetcode-cn.com/problems/spiral-matrix-ii/">59. èºæ—‹çŸ©é˜µ II</a></h2><p>æ€è·¯ï¼š</p>
<ul>
<li>æ¨¡æ‹Ÿå¡«å…¥è¿‡ç¨‹ï¼š<ul>
<li>è®¾ç«‹<strong>ä¸Šä¸‹å·¦å³</strong>å››ä¸ªè¾¹ç•Œï¼Œä¸Šã€å·¦è¾¹ç•Œåˆå§‹å€¼ä¸º0ï¼Œå³ã€ä¸‹è¾¹ç•Œåˆå§‹å€¼ä¸ºn-1</li>
<li>å§‹ç»ˆæŒ‰ç…§å››ä¸ªæ–¹å‘ï¼šä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹ã€ä»å³åˆ°å·¦ã€ä»ä¸‹åˆ°ä¸Š<ul>
<li>å¡«å…¥æ•°å­—è¾¾åˆ°è¾¹ç•Œåï¼Œå¯¹åº”çš„è¾¹ç•Œå‘å†…ç¼©å°</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="Java">class Solution &#123;
    public int[][] generateMatrix(int n) &#123;
        int[][] res = new int[n][n];
        int count = 1,num = n * n;
        int left = 0,top = 0,right = n-1,down = n-1; //å·¦ä¸Šå³ä¸‹å››ä¸ªè¾¹ç•Œ
        while(count &lt;= num)&#123;
            for(int i =left;i &lt;= right;i++) res[top][i] = count++;//å·¦è¾¹ç•Œleftåˆ°å³è¾¹ç•Œrightï¼Œtopè¡Œå¡«å®Œåtop++
            top++;
            for(int i =top;i &lt;= down;i++) res[i][right] = count++;//ä¸Šè¾¹ç•Œtopåˆ°ä¸‹è¾¹ç•Œdownï¼Œrightåˆ—å¡«å®Œåright--
            right--;
            for(int i =right;i &gt;= left;i--) res[down][i] = count++;//å³è¾¹ç•Œrightåˆ°å·¦è¾¹ç•Œleftï¼Œdownè¡Œå¡«å®Œådown--
            down--;
            for(int i =down;i &gt;= top;i--) res[i][left] = count++;//ä¸‹è¾¹ç•Œdownåˆ°ä¸Šè¾¹ç•Œtopï¼Œleftåˆ—å¡«å®Œåleft++
            left++;
        &#125;
        return res;
    &#125;
&#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š<br><img src="/2021/10/09/LeetCodeDaily/59.png"></p>
<h2 id="435-æ— é‡å åŒºé—´"><a href="#435-æ— é‡å åŒºé—´" class="headerlink" title="435. æ— é‡å åŒºé—´"></a><a href="https://leetcode-cn.com/problems/non-overlapping-intervals/">435. æ— é‡å åŒºé—´</a></h2><p>æ€è·¯ï¼š</p>
<ul>
<li>æŒ‰ç…§æ•°ç»„å³åŒºé—´å¤§å°å‡åºæ’åºï¼Œå‚è€ƒå¤§ä½¬<strong>ä»£ç éšæƒ³å½•</strong>çš„ä¸€å¼ å›¾ï¼š<img src="/2021/10/09/LeetCodeDaily/435_1.png"><ul>
<li>ä½¿ç”¨å³åŒºé—´æœ€å°æ•°ç»„1ä¾æ¬¡å‘å³åˆ¤æ–­ï¼Œå½“è¾¾åˆ°æ•°ç»„4æ—¶ç¬¦åˆæ¡ä»¶<code>count++</code>,æ­¤æ—¶ä»æ•°ç»„4ç»§ç»­å‘å³åˆ¤æ–­</li>
</ul>
</li>
<li>æ ¹æ®æ¡ä»¶åˆ¤æ–­å‡ºç¬¦åˆæ¡ä»¶çš„åŒºé—´æ•°é‡<code>count</code>ï¼Œåˆ™å‰©ä¸‹çš„å°±æ˜¯éœ€è¦ç§»é™¤çš„åŒºé—´æ•°é‡</li>
</ul>
<pre><code class="java">class Solution &#123;
    public int eraseOverlapIntervals(int[][] intervals) &#123;
        if(intervals.length == 0) return 0;
        Arrays.sort(intervals,(a,b) -&gt; a[1] - b[1]);
        int count = 1;
        int num = intervals[0][1];
        for(int i = 1 ;i &lt; intervals.length; i++)&#123;
            if(num &lt;= intervals[i][0])&#123;
                num = intervals[i][1];
                count++;
            &#125;
        &#125;
        return intervals.length - count;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(nlogn)</strong>,æœ‰ä¸€ä¸ªå¿«æ’</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<strong>O(1)</strong></p>
<p>ç»“æœå¦‚å›¾ï¼š<br><img src="/2021/10/09/LeetCodeDaily/435_2.png"></p>
<h2 id="29-ä¸¤æ•°ç›¸é™¤"><a href="#29-ä¸¤æ•°ç›¸é™¤" class="headerlink" title="29. ä¸¤æ•°ç›¸é™¤"></a><a href="https://leetcode-cn.com/problems/divide-two-integers/">29. ä¸¤æ•°ç›¸é™¤</a></h2><p>æ€è·¯ï¼š</p>
<ul>
<li>å‡æ³•ï¼Œè¢«é™¤æ•°å¾ªç¯å‡å»é™¤æ•°ï¼Œä½†æ˜¯æ•ˆç‡æ¯”è¾ƒä½<ul>
<li>ä½è¿ç®—ï¼Œè®¡ç®—æœºè¿›è¡Œä½è¿ç®—æ—¶çš„æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œé€šè¿‡å³ä½ç§»æ‰¾å‡ºæ»¡è¶³**<code>2^i</code><em>é™¤æ•°&lt;=è¢«é™¤æ•°*<em>æœ€å¤§çš„<code>i</code>,æ­¤æ—¶è¢«é™¤æ•°å‡å»</em></em><code>2^i</code>*é™¤æ•°**ï¼Œå†æ‰¾å‰©ä¸‹æ»¡è¶³æ¡ä»¶çš„<code>i</code>,ä»¥æ­¤ç±»æ¨</li>
<li>ä¸¾ä¸ªä¾‹å­ï¼Œ100/6â€”&gt; <em><em><code>2^4</code><em>6&lt;=100</em></em>,æ­¤æ—¶æœ€å¤§çš„<code>i</code>æ˜¯4,å‰©ä¸‹çš„100-96 = 4æ— æ³•æ»¡è¶³</em><em><code>2^i</code><em>é™¤æ•°&lt;=è¢«é™¤æ•°</em></em>,åˆ™å•†ä¸º16</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public int divide(int dividend, int divisor) &#123;
        if(dividend == 0) return 0;
        if(dividend == Integer.MIN_VALUE &amp;&amp; divisor == -1) return Integer.MAX_VALUE;
        boolean negative = (dividend ^ divisor) &lt; 0;//ç¬¦å·åˆ¤æ–­
        int res = 0;
        long num1 = Math.abs((long)dividend);
        long num2 = Math.abs((long)divisor);
        for(int i = 31 ; i &gt;= 0 ; i--)&#123; 
            if((num1 &gt;&gt; i) &gt;= num2)&#123; //æ‰¾å‡ºæœ€å¤§çš„æ•°divisor*2^n
                res += 1&lt;&lt;i;         //ç»“æœåŠ ä¸Š2^n
                num1 -= num2&lt;&lt;i;     //è®¡ç®—å‰©ä½™è¢«é™¤æ•°
            &#125;
        &#125;
        return negative ? -res:res;  //ç¬¦å·äº’å¼‚å–å
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/29.png"></p>
<h2 id="38-å¤–è§‚æ•°åˆ—"><a href="#38-å¤–è§‚æ•°åˆ—" class="headerlink" title="38. å¤–è§‚æ•°åˆ—"></a><a href="https://leetcode-cn.com/problems/count-and-say/">38. å¤–è§‚æ•°åˆ—</a></h2><p>æ€è·¯ï¼š</p>
<ul>
<li><p>ä½¿ç”¨åŒæŒ‡é’ˆï¼Œæˆªå–<strong>ç›¸åŒå­—ç¬¦</strong>çš„æ¯ä¸ªç»„ï¼ŒæŒ‰ç…§é¢˜æ„æ¨¡æ‹Ÿå³å¯</p>
<ul>
<li>ä¾æ¬¡éå†æ¯ä¸ªç»„</li>
<li>ä¾æ¬¡å¡«å…¥<code>n</code>(æŒ‡é’ˆä¸‹æ ‡<strong>ç›¸å‡</strong>)ä¸ª<code>m</code>ï¼ˆå¡«å…¥<strong>first</strong>æŒ‡é’ˆçš„æ•°ï¼‰</li>
<li>è¿›è¡Œä¸‹ä¸€æ¬¡éå†</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public String countAndSay(int n) &#123;
        String str = &quot;1&quot;;
        for(int i = 2; i &lt;= n ; i++)&#123;
            int first = 0 ,last = 0;
            StringBuffer sb = new StringBuffer();
            while(last &lt; str.length())&#123;
                while(last &lt; str.length() &amp;&amp; str.charAt(first) == str.charAt(last)) last++;
                sb.append(Integer.toString(last - first)).append(str.charAt(first));
                first = last;
            &#125;
            str = sb.toString();
        &#125;
        return str;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/38.png"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(N*M),N-&gt;ç»™å®šæ­£æ•´æ•°nï¼ŒM-&gt;ç”Ÿæˆå­—ç¬¦ä¸²é•¿åº¦</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šO(M)ï¼ŒM-&gt;ç”Ÿæˆå­—ç¬¦ä¸²é•¿åº¦</p>
<h2 id="763-åˆ’åˆ†å­—æ¯åŒºé—´"><a href="#763-åˆ’åˆ†å­—æ¯åŒºé—´" class="headerlink" title="763. åˆ’åˆ†å­—æ¯åŒºé—´"></a><a href="https://leetcode-cn.com/problems/partition-labels/">763. åˆ’åˆ†å­—æ¯åŒºé—´</a></h2><p>æ€è·¯ï¼š</p>
<ul>
<li>æœ€éš¾çš„æ˜¯å¦‚ä½•åˆ’åˆ†å¥½ç¬¦åˆæ¡ä»¶çš„ç‰‡æ®µ<ul>
<li>å…ˆç”¨ä¸€ä¸ª<strong>æ•°ç»„</strong>è®°å½•æ¯ä¸ªå­—æ¯çš„æœ€è¿œä¸‹æ ‡(ä¹Ÿå¯ä»¥ç”¨<strong>HashMap</strong>æ¥è®°å½•)</li>
<li>ç”¨ä¸¤ä¸ªä¸‹æ ‡æˆªå–ç‰‡æ®µ<ul>
<li>å½“å‰éå†å­—æ¯çš„æœ€è¿œä¸‹æ ‡ä¸€å®šæ˜¯åœ¨å½“å‰ç‰‡æ®µä¸­ï¼Œå³<code>end</code>å¤§äºç­‰äºå½“å‰å­—æ¯çš„æœ€è¿œä¸‹æ ‡</li>
<li>å½“éå†<code>i</code>è®¿é—®åˆ°ä¸‹æ ‡<code>end</code>æ—¶ï¼Œè¿™ä¸ªç‰‡æ®µå³æ˜¯ç¬¦åˆæ¡ä»¶çš„ç‰‡æ®µ(è´ªå¿ƒ)</li>
</ul>
</li>
<li>å°†å½“å‰ç‰‡æ®µç»“æœåŠ å…¥ç»“æœé›†ï¼Œè¿›è¡Œåç»­ç‰‡æ®µçš„éå†</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public List&lt;Integer&gt; partitionLabels(String s) &#123;
        int len = s.length();
        List&lt;Integer&gt; res = new ArrayList&lt;Integer&gt;();
        int[] arr = new int[26];
        for(int i = 0 ; i &lt; len ; i++)&#123;
            arr[s.charAt(i) - &#39;a&#39;] = i; //è®°å½•å­—æ¯æœ€è¿œä¸‹æ ‡
        &#125; 
        int start = 0, end = 0;
        for(int i = 0 ; i &lt; len ; i++)&#123;
            end = Math.max(end,arr[s.charAt(i) - &#39;a&#39;]); //å½“å‰éå†å­—æ¯çš„æœ€è¿œä¸‹æ ‡ä¸€å®šæ˜¯åœ¨å½“å‰ç‰‡æ®µä¸­
            if(i == end)&#123;
                res.add(end - start + 1);
                start = end + 1;
            &#125;
        &#125;
        return res;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/763.png"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼šlog(N),éå†ä¸¤æ¬¡æ•°ç»„</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šlog(m),mæ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦é›†ï¼Œè¿™é¢˜ä¸­mä¸º26(åªåŒ…å«26ä¸ªå°å†™å­—æ¯)</p>
<blockquote>
<p>Tipsï¼š</p>
<p>å¯¹äºè´ªå¿ƒçš„æ€æƒ³æŒæ¡çš„è¿˜æ˜¯ä¸å¤Ÿå¥½ï¼Œä»¥å±€éƒ¨æœ€ä¼˜æ±‚å‡ºå…¨å±€æœ€ä¼˜ã€‚</p>
</blockquote>
<h2 id="43-å­—ç¬¦ä¸²ç›¸ä¹˜"><a href="#43-å­—ç¬¦ä¸²ç›¸ä¹˜" class="headerlink" title="43. å­—ç¬¦ä¸²ç›¸ä¹˜"></a><a href="https://leetcode-cn.com/problems/multiply-strings/">43. å­—ç¬¦ä¸²ç›¸ä¹˜</a></h2><p>æ€è·¯ï¼š</p>
<p>å°†ä¹˜æ•°æ¯ä¸€ä½å’Œè¢«ä¹˜æ•°<strong>ç›¸ä¹˜ç´¯åŠ </strong>çš„ç»“æœæ”¾å…¥å¯¹åº”æ•°ç»„ä¸­ï¼Œä¹˜æ•°å’Œè¢«ä¹˜æ•°é•¿åº¦åˆ†åˆ«ä¸º<code>en1</code>å’Œ<code>len2</code>ï¼Œæ•…æ•°ç»„çš„å¤§å°ä¸è¶…è¿‡<strong>len1+len2</strong>ï¼ˆä¾‹å¦‚100 * 100 = 1000ï¼Œ3 + 3 &gt;= 4 ï¼‰</p>
<ul>
<li>ä¸¤ä¸ªforå¾ªç¯å¾—åˆ°ç»“æœæ•°ç»„åï¼Œè¿˜å¾—å¯¹æ•°ç»„è¿›è¡Œæ“ä½œæ‰èƒ½è·å¾—æœ€ç»ˆæ•°ç»„(æ¨¡æ‹Ÿä¹˜æ³•)<ul>
<li>æ•°ç»„ä¸‹æ ‡ä»å³åˆ°å·¦ï¼Œå°†å½“å‰æ•°ç»„ä¸‹æ ‡çš„å€¼ä¸10é™¤<strong>å–å•†</strong>ç´¯åŠ åˆ°å·¦ä¸€ä½</li>
<li>å½“å‰æ•°ç»„ä¸‹æ ‡ä¸10é™¤<strong>å–ä½™</strong></li>
</ul>
</li>
<li>è·å¾—æœ€ç»ˆæ•°ç»„åï¼Œåˆ¤æ–­æ•°ç»„arr[0]ä¸º0æˆ–1è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œï¼ˆé¢˜ç›®è¦æ±‚ä¸ä»¥0å¼€å¤´ï¼‰</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public String multiply(String num1, String num2) &#123;
        if(num1.equals(&quot;0&quot;) || num2.equals(&quot;0&quot;)) return &quot;0&quot;;
        
        int len1 = num1.length(),len2 = num2.length();
        int[] arr = new int[len1 + len2];

        for(int i = len1 - 1; i &gt;= 0; i--)&#123;
            int curnum1 = num1.charAt(i) - &#39;0&#39;;
            for(int j = len2 - 1; j &gt;= 0; j--)&#123;
                int curnum2 = num2.charAt(j) - &#39;0&#39;;
                arr[i + j + 1] += curnum1 * curnum2;
            &#125;
        &#125;

        for(int k = len1 + len2 -1 ; k &gt; 0; k--)&#123;
            arr[k - 1] += arr[k]/10;
            arr[k] %= 10;
        &#125;

        int index = arr[0] == 0 ? 1 : 0;
        StringBuffer res = new StringBuffer();
        while(index &lt; len1 + len2)&#123;
            res.append(arr[index]);
            index++;
        &#125;
        return res.toString();
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/43.png"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(m*n)</strong>,å…¶ä¸­<code>m</code>å’Œ<code>n</code>åˆ†åˆ«æ˜¯<code>num1</code>å’Œ<code>num2</code>çš„é•¿åº¦</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š**O(m+n)**ï¼Œ</p>
<h2 id="230-äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ "><a href="#230-äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ " class="headerlink" title="230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ "></a><a href="https://leetcode-cn.com/problems/kth-smallest-element-in-a-bst/">230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </a></h2><p>æ€è·¯ï¼š</p>
<p>å› ä¸ºæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ ˆæŒ‰ä¸­åºéå†æ¥è®¿é—®äºŒå‰æ ‘</p>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public int kthSmallest(TreeNode root, int k) &#123;
        Deque&lt;TreeNode&gt; stk = new LinkedList&lt;&gt;();
        while(root != null|| !stk.isEmpty())&#123;
            while(root != null)&#123;
                stk.push(root);
                root = root.left;
            &#125;
            root = stk.pop();
            k--;
            if( k == 0 )&#123;
                break;
            &#125;
            root = root.right;
        &#125;
        return root.val;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/230.png"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(H+k)</code>,Hæ˜¯æ ‘çš„é«˜åº¦,å½“æ ‘æ˜¯å¹³è¡¡æ ‘æ—¶ï¼Œå¯ä»¥å–<code>O(logN+k)</code></p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(H)</code>,æ ˆä¸­æœ€å¤šå­˜Hä¸ªå…ƒç´ </p>
<blockquote>
<p>Tips;</p>
<p>è®°å½•è¿™é¢˜çš„ç›®çš„æ˜¯è‡ªä»å­¦ä¹ æ•°æ®ç»“æ„åå¾ˆä¹…æ²¡åšæ ‘çš„é¢˜ç›®äº†ï¼Œæœ€è¿‘å¼€å§‹åˆ·é¢˜æ—¶é‡åˆ°çš„ç¬¬ä¸€é“æ ‘çš„é¢˜ç›®ï¼Œæ•…è®°å½•ä¸‹æ¥ã€‚</p>
</blockquote>
<h2 id="211-æ·»åŠ ä¸æœç´¢å•è¯-æ•°æ®ç»“æ„è®¾è®¡"><a href="#211-æ·»åŠ ä¸æœç´¢å•è¯-æ•°æ®ç»“æ„è®¾è®¡" class="headerlink" title="211. æ·»åŠ ä¸æœç´¢å•è¯ - æ•°æ®ç»“æ„è®¾è®¡"></a><a href="https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/">211. æ·»åŠ ä¸æœç´¢å•è¯ - æ•°æ®ç»“æ„è®¾è®¡</a></h2><p>æ€è·¯ï¼š</p>
<p>ç®€å•æš´åŠ›çš„æ–¹æ³•</p>
<ul>
<li>ç”¨<strong>HashMap</strong>å­˜**<code>é”®ï¼šå€¼</code><strong>ä¸º</strong><code>å­—ç¬¦ä¸²é•¿åº¦ï¼šç›¸åŒé•¿åº¦ä¸‹ä¸åŒçš„å•è¯</code>**</li>
<li>æŸ¥æ‰¾çš„æ—¶å€™ï¼Œä»<strong>HashMap</strong>å–å‡ºç›¸åŒé•¿åº¦ä¸‹çš„<strong>seté›†åˆ</strong><ul>
<li>å…ˆè€ƒè™‘ä¸å¸¦ <code>&#39;.&#39;</code>çš„å•è¯</li>
<li>å¯¹äºå«æœ‰ <code>&#39;.&#39;</code>çš„å•è¯å†æ‹†æ”¾å…¥æ•°ç»„ä¸­é€ä¸ªæ¯”è¾ƒ</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class WordDictionary &#123;
    Map&lt;Integer,Set&lt;String&gt;&gt; map = new HashMap&lt;&gt;();//æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦åˆ†å¼€å­˜æ”¾
    public WordDictionary() &#123;
        
    &#125;
    public void addWord(String word) &#123;
        int len = word.length();
        if(map.get(len) != null)&#123;
            map.get(len).add(word);
        &#125;else&#123;
            Set&lt;String&gt; set = new HashSet&lt;&gt;();
            set.add(word);
            map.put(len,set);
        &#125;
    &#125;
    public boolean search(String word) &#123;
        Set&lt;String&gt; set = map.get(word.length());
      
        if(set == null) return false;
        if(set.contains(word)) return true;
      
        char[] charword = word.toCharArray(); 
        P:for(String str : set)&#123;
            if(str.length() != word.length()) continue;
            char[]  charstr = str.toCharArray();
            for(int i = 0 ; i &lt; word.length(); i++)&#123; //æ¯ä¸ªå­—ç¬¦æ¯”è¾ƒ
                if(charword[i] != &#39;.&#39; &amp;&amp; charword[i] != charstr[i]) continue P; //éå†ä¸‹ä¸€ä¸ªå­—ç¬¦
            &#125;
            return true;
        &#125;
        return false;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/211.png"></p>
<blockquote>
<p>è¯¥é¢˜çš„å®˜æ–¹è§£æ³•æ˜¯ä½¿ç”¨å‰ç¼€æ ‘è¿›è¡Œæ±‚è§£</p>
</blockquote>
<h2 id="647-å›æ–‡å­ä¸²"><a href="#647-å›æ–‡å­ä¸²" class="headerlink" title="647. å›æ–‡å­ä¸²"></a><a href="https://leetcode-cn.com/problems/palindromic-substrings/">647. å›æ–‡å­ä¸²</a></h2><p>æ€è·¯ï¼š</p>
<p>å›æ–‡å­—ç¬¦ä¸²ï¼Œå¯ä»¥æŒ‰ç…§<strong>å›æ–‡ä¸­å¿ƒå‘ä¸¤ä¾§å»¶ä¼¸</strong>çš„æ€è·¯æ¥æŸ¥æ‰¾æœ‰å¤šå°‘ä¸ªå›æ–‡å­—ç¬¦ä¸²</p>
<ul>
<li>å›æ–‡ä¸­å¿ƒï¼ŒæŒ‰ç…§å¥‡å¶çš„åŒºåˆ†æ¥è¯´ï¼Œå›æ–‡ä¸­å¿ƒä¸æ˜¯å•ä¸ªå­—ç¬¦å°±æ˜¯ä¸¤ä¸ªåŒæ ·çš„å­—ç¬¦å¦‚<code>a</code>æˆ–<code>aa</code>,å½“ä¸‰ä¸ªå­—ç¬¦çš„æƒ…å†µå¯ä»¥è§†ä½œä¸ºä¸€ä¸ªå›æ–‡ä¸²</li>
<li>å…¶æ¬¡ï¼Œå›æ–‡ä¸­å¿ƒçš„æ•°é‡æŒ‰ç…§è§‚å¯Ÿæ¥è¯´ï¼Œæœ‰<code>2*len-2</code>ä¸ª(å…¶ä¸­lenä¸ºå­—ç¬¦ä¸²é•¿åº¦)</li>
<li>æœ€åå¯ä»¥å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆå‘ä¸¤ä¾§å»¶ä¼¸<ul>
<li>å½“å›æ–‡ä¸­å¿ƒä¸ºå¥‡æ•°æ—¶ï¼Œä¸¤æŒ‡é’ˆé‡å </li>
<li>å½“å›æ–‡ä¸­å¿ƒä¸ºå¶æ•°æ—¶ï¼Œä¸¤æŒ‡é’ˆä¸€å·¦ä¸€å³</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public int countSubstrings(String s) &#123;
        int len = s.length(), ans = 0;
        for (int i = 0; i &lt; 2 * len - 1; ++i) &#123;
            int l = i / 2, r = i / 2 + i % 2;
            while (l &gt;= 0 &amp;&amp; r &lt; len &amp;&amp; s.charAt(l) == s.charAt(r)) &#123;
                --l;
                ++r;
                ++ans;
            &#125;
        &#125;
        return ans;
    &#125;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<p><img src="/2021/10/09/LeetCodeDaily/647.png"></p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(n^2)</strong>,æšä¸¾å›æ–‡ä¸­å¿ƒ<strong>O(n)</strong>,æŒ‡é’ˆå»¶å±•æŸ¥æ‰¾å›æ–‡å­ä¸²<strong>O(n)</strong></p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<strong>O(1)</strong></p>
<h2 id="229-æ±‚ä¼—æ•°-II"><a href="#229-æ±‚ä¼—æ•°-II" class="headerlink" title="229. æ±‚ä¼—æ•° II"></a><a href="https://leetcode-cn.com/problems/majority-element-ii/">229. æ±‚ä¼—æ•° II</a></h2><p>å…ˆæ”¾ä¸Šä»£ç </p>
<pre><code class="Java">class Solution &#123;
    public List&lt;Integer&gt; majorityElement(int[] nums) &#123;
        Map&lt;Integer,Integer&gt; map = new HashMap&lt;&gt;();
        List&lt;Integer&gt; res = new ArrayList&lt;&gt;();
        int count = 0,len = nums.length;
        for(int num : nums)&#123;
            map.put(num,map.getOrDefault(num,0)+1);
        &#125;
        for (Integer key : map.keySet()) &#123;
            if(map.get(key) &gt; len/3) res.add(key);
        &#125;
        return res;
    &#125;
&#125;
</code></pre>
<p>è¿™æ˜¯æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦å‡ä¸º**O(n)**çš„è§£æ³•,å…¶ä¸­<code>n</code>ä¸ºæ•°ç»„çš„é•¿åº¦</p>
<p>ä½†æ˜¯é¢˜ç›®çš„è¿›é˜¶è¦æ±‚æ˜¯æŠŠç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°<strong>O(1)</strong>,é¢˜è§£ç»™äº†ä¸€ç§å¾ˆç¥å¥‡çš„æ–¹æ³•â€”â€”<strong>æ‘©å°”æŠ•ç¥¨æ³•</strong>,æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>é¢˜ç›®è¦æ±‚æ‰¾å‡ºè¶…è¿‡ã€n/3ã€‘çš„å…ƒç´ ï¼Œå®é™…ä¸Šéšå«äº†ä¸€ä¸ªæ¡ä»¶â€”â€”ç»“æœé›†å†…åªæœ‰ä¸¤ä¸ªç»“æœ</p>
</li>
<li><p>å¤§è‡´cvä¸€ä¸‹æ‘©å°”æŠ•ç¥¨æ³•çš„æ€è·¯</p>
<ul>
<li>é€‰ç¥¨æ•°è¶…è¿‡ä¸€åŠçš„å€™é€‰äººæ—¶ï¼ŒæŠ•ç¥¨ç»“æœå¦‚æ•°ç»„ã€A,B,C,C,C,Aã€‘</li>
<li>ç¬¬ä¸€å¼ ç¥¨å’Œç¬¬äºŒå¼ ç¥¨ä¸åŒï¼Œåˆ†åˆ«ä¸ºAå’ŒBï¼Œäº’ç›¸æŠµæ¶ˆ</li>
<li>ç¬¬ä¸‰å››äº”å¼ ç¥¨ç›¸åŒï¼Œåˆ™å¢åŠ Cå€™é€‰äººå¯ä»¥æŠµæ¶ˆçš„ç¥¨æ•°</li>
<li>åé¢è¿˜æœ‰ä¸€å¼ AæŠµæ¶ˆCä¸€æ¬¡ï¼Œæ­¤æ—¶å€™é€‰äººæ˜¯Cï¼Œåˆ™ç»Ÿè®¡ä¸€ä¸‹Cåœ¨æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œè¶…è¿‡ä¸€åŠåˆ™å€™é€‰äººæ˜¯C</li>
</ul>
</li>
<li><p>å¯ä»¥çœ‹å‡ºæ‘©å°”æŠ•ç¥¨æ³•æ˜¯ä¸€ä¸ªæŠµæ¶ˆçš„æ€è·¯ï¼ŒåŒæ—¶ç”±ç¥¨æ•°<strong>è¶…è¿‡1/2å³è¢«é€‰å–</strong>æ‰©å±•ä¸€ä¸‹è‡³ç¥¨æ•°<strong>è¶…è¿‡1/næ—¶è¢«é€‰å–</strong>ï¼Œåˆ™æœ€ç†æƒ³æƒ…å†µä¸‹ä¼šæœ‰<strong>n-1ä¸ªè¢«é€‰å–</strong></p>
</li>
</ul>
<p>è´´ä¸Šä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    public List&lt;Integer&gt; majorityElement(int[] nums) &#123;
        // åˆ›å»ºè¿”å›å€¼
        List&lt;Integer&gt; res = new ArrayList&lt;&gt;();
        if (nums == null || nums.length == 0) return res;
        // åˆå§‹åŒ–ä¸¤ä¸ªå€™é€‰äººcandidateï¼Œå’Œä»–ä»¬çš„è®¡ç¥¨
        int cand1 = nums[0], count1 = 0;
        int cand2 = nums[0], count2 = 0;

        // æ‘©å°”æŠ•ç¥¨æ³•ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šé…å¯¹é˜¶æ®µå’Œè®¡æ•°é˜¶æ®µ
        // é…å¯¹é˜¶æ®µ
        for (int num : nums) &#123;
            // æŠ•ç¥¨
            if (cand1 == num) &#123;
                count1++;
                continue;
            &#125;
            if (cand2 == num) &#123;
                count2++;
                continue;
            &#125;

            // ç¬¬1ä¸ªå€™é€‰äººé…å¯¹
            if (count1 == 0) &#123;
                cand1 = num;
                count1++;
                continue;
            &#125;
            // ç¬¬2ä¸ªå€™é€‰äººé…å¯¹
            if (count2 == 0) &#123;
                cand2 = num;
                count2++;
                continue;
            &#125;

            count1--;
            count2--;
        &#125;

        // è®¡æ•°é˜¶æ®µ
        // æ‰¾åˆ°äº†ä¸¤ä¸ªå€™é€‰äººä¹‹åï¼Œéœ€è¦ç¡®å®šç¥¨æ•°æ˜¯å¦æ»¡è¶³å¤§äº N/3
        count1 = 0;
        count2 = 0;
        for (int num : nums) &#123;
            if (cand1 == num) count1++;
            else if (cand2 == num) count2++;
        &#125;

        if (count1 &gt; nums.length / 3) res.add(cand1);
        if (count2 &gt; nums.length / 3) res.add(cand2);

        return res;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ä¾ç„¶æ˜¯**O(n),<strong>ä½†æ˜¯ç©ºé—´å¤æ‚åº¦å·²ç»åªæœ‰</strong>O(1)**äº†</p>
<h2 id="105-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"><a href="#105-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" class="headerlink" title="105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/">105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></h2><blockquote>
<p>å¾ˆç»å…¸çš„ä¸€é“é¢˜ï¼Œè®°å½•ä¸€ä¸‹</p>
</blockquote>
<p>æ€è·¯</p>
<p>å®˜è§£è¯´å¯ä»¥ç”¨<strong>Hashmap</strong>æ¥å­˜å‚¨ä¸­åºéå†æ•°ç»„çš„ä¸‹æ ‡ï¼Œè¿™æ ·åœ¨åç»­é€’å½’ä¸­ï¼Œä¸­åºéå†æ•°ç»„ï¼Œå®šä½æ ¹èŠ‚ç‚¹ä½ç½®æ—¶æ—¶é—´å¤æ‚åº¦åªæœ‰O(1)ï¼ŒçœŸæ˜¯å¦™è›™ç§å­åƒç€å¦™è„†è§’å¦™è¿›äº†ç±³å¥‡å¦™å¦™å±‹ï¼Œå¦™åˆ°å®¶äº†ï½</p>
<ul>
<li><p>æ ¹æ®<strong>å…ˆåºéå†</strong>æ•°ç»„çš„<strong>ç¬¬ä¸€ä½</strong>åˆ¤æ–­ä¸ºæ ¹èŠ‚ç‚¹</p>
</li>
<li><p>æ ¹æ®æ ¹èŠ‚ç‚¹åˆ¤æ–­<strong>ä¸­åºéå†</strong>çš„å·¦å­æ ‘å’Œå³å­æ ‘</p>
<ul>
<li><p>é€’å½’ä¼ å…¥ä¸‹æ ‡æ—¶ï¼Œæ³¨æ„å­æ ‘å·¦å³è¾¹ç•Œï¼š</p>
<ul>
<li><p>å¾ˆæ˜¾ç„¶ä¸­åºéå†æ•°ç»„ä¸­æŸ¥æ‰¾åˆ°æ ¹èŠ‚ç‚¹å<strong>å…¶å·¦å³åˆ†åˆ«æ˜¯å·¦å³å­æ ‘çš„åŒºé—´</strong></p>
</li>
<li><p>å…ˆåºéå†æ•°ç»„ä¸­<strong>æœ€å·¦ä¸‹æ ‡å¯¹åº”çš„ä¸ºæ ¹èŠ‚ç‚¹</strong>ï¼Œæ ¹æ®ä¸­åºéå†å·¦ä¾§æ•°ç»„ä¸‹æ ‡æ¥æ±‚å¾—<strong>å·¦å­æ ‘æ•°é‡</strong>ï¼ŒåŒç†æ±‚å¾—å³<strong>å­æ ‘æ•°é‡</strong></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä»£ç </p>
<pre><code class="java">class Solution &#123;
    Map&lt;Integer,Integer&gt; res = new HashMap&lt;&gt;();
    public TreeNode buildTree(int[] preorder, int[] inorder) &#123;
        for(int i = 0 ; i &lt; inorder.length; i++)&#123;
            res.put(inorder[i],i); 
        &#125; 

        return makeTree(preorder,inorder,0,preorder.length - 1,0,inorder.length - 1);

    &#125;

    public TreeNode makeTree(int[] preorder, int[] inorder, int pre_left,int pre_right,int in_left,int in_right)&#123;

        if(pre_left &gt; pre_right) return null;
        //å…ˆåºéå†æ•°ç»„çš„ç¬¬ä¸€ä½å³æ˜¯æ ¹èŠ‚ç‚¹
        int pre_root = pre_left;

        //åœ¨ä¸­åºéå†ä¸­å®šä½æ ¹èŠ‚ç‚¹
        int in_root = res.get(preorder[pre_root]);

        //å»ºç«‹æ ¹èŠ‚ç‚¹
        TreeNode root = new TreeNode((preorder[pre_root]));

        //ä¸­åºéå†æ•°ç»„æ ¹èŠ‚ç‚¹çš„å·¦ä¾§ -&gt; å¾—åˆ°å·¦å­æ ‘ä¸­èŠ‚ç‚¹çš„æ•°ç›®
        int size_left_subtree = in_root - in_left;

        //é€’å½’æ„é€ å·¦å­æ ‘
        root.left = makeTree(preorder,inorder,pre_left + 1,pre_left + size_left_subtree ,in_left,in_right - 1);

        //é€’å½’æ„é€ å³å­æ ‘
        root.right = makeTree(preorder,inorder,pre_left + size_left_subtree + 1,pre_right,in_root + 1,in_right);

        return root;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(n)</strong>,nä¸ºæ ‘ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š**O(n)**ï¼Œnä¸ºHashMapçš„ç©ºé—´+è¿”å›ç»“æœçš„ç©ºé—´+é€’å½’æ—¶æ ˆç©ºé—´(æ ‘é«˜åº¦)</p>
<h2 id="102-äºŒå‰æ ‘çš„å±‚åºéå†"><a href="#102-äºŒå‰æ ‘çš„å±‚åºéå†" class="headerlink" title="102. äºŒå‰æ ‘çš„å±‚åºéå†"></a><a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal/">102. äºŒå‰æ ‘çš„å±‚åºéå†</a></h2><blockquote>
<p>æœ€ç»å…¸çš„BFSäº†</p>
<p>ä¹‹å‰å­¦æ•°æ®ç»“æ„æ—¶ç”¨c++å®ç°çš„ï¼Œç°åœ¨æ—¶éš”å¾ˆä¹…ï¼Œæ­£å¼å¼€å§‹ç®—æ³•æ—¶ç”¨javaå®ç°</p>
</blockquote>
<p>æ€è·¯</p>
<p>è¿­ä»£æ–¹æ³•ï¼š</p>
<p>ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥ç»´æŠ¤å½“å‰å±‚çš„èŠ‚ç‚¹ï¼Œç”¨ä¸€ä¸ªlisté›†åˆæ¥ç»´æŠ¤å½“å‰å±‚èŠ‚ç‚¹çš„å€¼ï¼Œæ¯éå†ä¸€æ¬¡é˜Ÿåˆ—åï¼Œå†å°†listé›†åˆæ·»åŠ è¿›æœ€ç»ˆç»“æœé›†ä¸­</p>
<ul>
<li>ç”¨**é˜Ÿåˆ—(queue)**æ¥å­˜æ”¾å½“å‰å±‚çš„èŠ‚ç‚¹</li>
<li>åœ¨éå†<strong>é˜Ÿåˆ—</strong>(èŠ‚ç‚¹)æ—¶,ä¸´æ—¶åˆ›å»ºä¸€ä¸ª**é›†åˆ(ArrayList)**æ¥å­˜æ”¾æ¯ä¸€å±‚èŠ‚ç‚¹çš„å€¼</li>
</ul>
<p>ä»£ç </p>
<pre><code class="java">class Solution &#123;
    public List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;
        if(root==null) &#123;
            return new ArrayList&lt;List&lt;Integer&gt;&gt;();
        &#125;
        List&lt;List&lt;Integer&gt;&gt; res = new ArrayList&lt;List&lt;Integer&gt;&gt;(); //å­˜æ”¾ç»“æœé›†
        LinkedList&lt;TreeNode&gt; queue = new LinkedList&lt;TreeNode&gt;(); //å­˜æ”¾ç»“ç‚¹
        //å°†æ ¹èŠ‚ç‚¹æ”¾å…¥é˜Ÿåˆ—ä¸­
        queue.add(root);
        while(queue.size()&gt;0) &#123;
            //è·å–å½“å‰é˜Ÿåˆ—çš„é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦ç›¸å½“äº å½“å‰è¿™ä¸€å±‚çš„èŠ‚ç‚¹ä¸ªæ•°
            int size = queue.size();
            ArrayList&lt;Integer&gt; tmp = new ArrayList&lt;Integer&gt;();
            //å°†é˜Ÿåˆ—ä¸­çš„å…ƒç´ éƒ½æ‹¿å‡ºæ¥(ä¹Ÿå°±æ˜¯è·å–è¿™ä¸€å±‚çš„èŠ‚ç‚¹)ï¼Œæ”¾åˆ°ä¸´æ—¶listä¸­
            //å¦‚æœèŠ‚ç‚¹çš„å·¦/å³å­æ ‘ä¸ä¸ºç©ºï¼Œä¹Ÿæ”¾å…¥é˜Ÿåˆ—ä¸­
            for(int i=0;i&lt;size;++i) &#123;
                TreeNode t = queue.remove();
                tmp.add(t.val);
                if(t.left!=null) &#123;
                    queue.add(t.left);
                &#125;
                if(t.right!=null) &#123;
                    queue.add(t.right);
                &#125;
            &#125;
            //å°†ä¸´æ—¶liståŠ å…¥æœ€ç»ˆè¿”å›ç»“æœä¸­
            res.add(tmp);
        &#125;
        return res;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(N)</strong></p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<strong>O(h)</strong>,hæ˜¯æ ‘çš„é«˜åº¦</p>
<h2 id="496-ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -I"><a href="#496-ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -I" class="headerlink" title="496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I"></a><a href="https://leetcode-cn.com/problems/next-greater-element-i/">496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I</a></h2><blockquote>
<p>è®°å½•è¿™é¢˜çš„ç›®çš„æ˜¯å› ä¸ºç›¸æ¯”äºæš´åŠ›æ³•O(n^2)çš„æ—¶é—´å¤æ‚åº¦ï¼Œæœ‰ä¸€ç§ä¼˜åŒ–æ–¹æ³•â€”â€”å•è°ƒæ ˆæ³•ï¼Œæ—¶é—´å¤æ‚åº¦å¯ä»¥ä¼˜åŒ–åˆ°O(n+m)ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæ˜¯ä¸“é—¨è§£è¿™ä¸€ç±»é¢˜ç›®çš„ä¼˜åŒ–è§£æ³•</p>
</blockquote>
<p>æ€è·¯</p>
<ul>
<li>ç”¨ä¸€ä¸ª<strong>HashMap</strong>æ¥è®°å½•<code>nums2</code>æ•°ç»„ä¸­æ¯ä¸ªæ•°å…¶å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„æ•°å­—<ul>
<li>ç”¨ä¸€ä¸ªæ ˆæ¥é€†åºéå†<code>nums2</code>ï¼Œè®°å½•æ¯”<code>nums2[i]</code>å¤§çš„æ•°,é€†åºéå†å­˜å…¥æ ˆæ—¶ï¼Œç¦»<code>nums2[i]</code>å³è¾¹æœ€è¿‘çš„æ•°åœ¨æ ˆé¡¶<ul>
<li>è¿™ä¸€æ­¥æ˜¯<strong>å•è°ƒæ ˆæ³•</strong>çš„ç²¾åï¼Œå¦™åˆ°æˆ‘æ— æ³•ç”¨<strong>ç²¾ç‚¼çš„æ–‡å­—</strong>æ¥æè¿°ï¼Œé¢˜ç›®è¦æ±‚å·¦è¾¹æ›´å¤§çš„å…ƒç´ æ—¶ï¼Œå°±å¯ä»¥é¡ºåºéå†</li>
</ul>
</li>
</ul>
</li>
<li>åœ¨<strong>HashMap</strong>ä¸­æŸ¥çœ‹<code>nums1</code>å¯¹åº”çš„ç»“æœ</li>
</ul>
<p>ä»£ç </p>
<pre><code class="java">class Solution &#123;
    public int[] nextGreaterElement(int[] nums1, int[] nums2) &#123;
        int n = nums1.length, m = nums2.length;
        Deque&lt;Integer&gt; d = new ArrayDeque&lt;&gt;();
        Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();
        for (int i = m - 1; i &gt;= 0; i--) &#123;
            int x = nums2[i];
            while (!d.isEmpty() &amp;&amp; d.peekLast() &lt;= x) d.pollLast(); //æ¯”nums2[i]å°çš„å…ƒç´ å‡ºæ ˆ
            map.put(x, d.isEmpty() ? -1 : d.peekLast());
            d.addLast(x);
        &#125;
        int[] ans = new int[n];
        for (int i = 0; i &lt; n; i++) ans[i] = map.get(nums1[i]);
        return ans;
    &#125;
&#125;
ä½œè€…ï¼šAC_OIer
é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/next-greater-element-i/solution/gong-shui-san-xie-yi-ti-shuang-jie-bian-n6nwz/
æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
</code></pre>
<blockquote>
<p>ä»£ç è½¬è½½è‡ªä¸‰å¶å§ï¼Œé—®å°±æ˜¯å¥¹çš„æš´åŠ›æ³•å†™çš„å¤ªä¼˜é›…äº†ï¼Œè‡ªæ„§ä¸å¦‚</p>
</blockquote>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(m+n)</strong>, **O(m)**ç»´æŠ¤å•è°ƒæ ˆ+O(n)æ„é€ ç­”æ¡ˆ</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<strong>O(m)</strong></p>
<h2 id="869-é‡æ–°æ’åºå¾—åˆ°-2-çš„å¹‚"><a href="#869-é‡æ–°æ’åºå¾—åˆ°-2-çš„å¹‚" class="headerlink" title="869. é‡æ–°æ’åºå¾—åˆ° 2 çš„å¹‚"></a><a href="https://leetcode-cn.com/problems/reordered-power-of-2/">869. é‡æ–°æ’åºå¾—åˆ° 2 çš„å¹‚</a></h2><blockquote>
<p>è®°å½•è¿™é¢˜çš„ç›®çš„æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™å¹¶æ²¡æœ‰æƒ³å‡ºä¸€ä¸ªå¾ˆå¥½çš„è§£é¢˜æ€è·¯(ç®€å•orç®€æ´)ï¼Œå¯èƒ½æ˜¯é¢˜é‡è¿˜ä¸å¤Ÿï¼Œæ€è·¯è¿˜æ²¡æ‰©å±•å¼€æ¥</p>
</blockquote>
<p>æ€è·¯ï¼š</p>
<p>ç›´æ¥æš´åŠ›å›æº¯çš„ï¼Œ åœ¨èŒƒå›´å†…æ»¡è¶³<code>2 çš„å¹‚</code>çš„æ•°å­—ä¸å¤š</p>
<p>ä½†æ˜¯åŒ¹é…ä¸Šå†™çš„æ–¹æ³•å¾ˆä¹±ï¼Œè¿™é‡Œæ”¾ä¸Šä¸€ç§å¾ˆå¥½çš„æ€è·¯</p>
<p><strong>è¯é¢‘ç»Ÿè®¡</strong></p>
<ul>
<li>æå‰æ‰¾å‡ºç¬¦åˆèŒƒå›´å†…æ»¡è¶³<code>2 çš„å¹‚</code>çš„æ•°å­—ï¼Œéå†æ¯ä¸€ä¸ªæ•°å­—æ—¶ï¼Œå°†è¯¥æ•°å­—è½¬æ¢ä¸ºnum[å¯¹åº”ä½æ•°å­—]{è¯¥æ•°å­—å‡ºç°æ¬¡æ•°}<ul>
<li>æŠŠç»™å®š<code>æ­£æ•´æ•°N</code>è½¬æ¢ä¸ºnum[å¯¹åº”ä½æ•°å­—]{è¯¥æ•°å­—å‡ºç°æ¬¡æ•°}</li>
<li>ä¸¤ä¸ªæ•°ç»„è¿›è¡ŒåŒ¹é…</li>
</ul>
</li>
</ul>
<p>ä»£ç ï¼š</p>
<pre><code class="java">class Solution &#123;
    Set&lt;Integer&gt; res = new HashSet&lt;&gt;();

    public boolean reorderedPowerOf2(int n) &#123;
        for(int i = 1 ; i&lt;= (int)1e9+10; i*=2)&#123;
            res.add(i);
        &#125;

        int[] cnt = new int[10];
        while(n != 0)&#123;
            cnt[n%10]++;
            n /= 10;
        &#125;

        lo:for(int num : res)&#123;
            int[] resCnt = new int[10];
            while(num != 0)&#123;
                resCnt[num%10]++;
                num /= 10;
            &#125;

            for(int i = 0 ; i &lt; 10; i++)&#123;
                if(cnt[i] != resCnt[i]) continue lo;
            &#125;
            return true;
        &#125;
        return false;

    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š O(Câˆ—logn)</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šO(C),Cä¸ºæ•°ç»„ç©ºé—´å¤§å°</p>
<h2 id="1218-æœ€é•¿å®šå·®å­åºåˆ—"><a href="#1218-æœ€é•¿å®šå·®å­åºåˆ—" class="headerlink" title="1218. æœ€é•¿å®šå·®å­åºåˆ—"></a><a href="https://leetcode-cn.com/problems/longest-arithmetic-subsequence-of-given-difference/">1218. æœ€é•¿å®šå·®å­åºåˆ—</a></h2><p>æ€è·¯</p>
<p>åˆšå¼€å§‹è€ƒè™‘ä½¿ç”¨<code>n^2</code>æ—¶é—´å¤æ‚åº¦çš„æš´åŠ›ï¼Œä¸€æƒ³å¯èƒ½ä¼šè¶…æ—¶ï¼Œé‚æ‰“ç®—ç”¨Hashmapæ¥è§£å†³ï¼Œä½†æ˜¯è‡ªå·±å¯¹dpçš„å­¦ä¹ è¿˜æ˜¯ä¸å¤Ÿæ·±å…¥ï¼Œåœ¨è½¬ç§»æ–¹ç¨‹ä¸Šå¡ä½äº†ã€‚ã€‚ã€‚</p>
<p>å“ˆå¸Œè¡¨+DP</p>
<p>è¿™é¢˜çš„å…³é”®æ˜¯åœ¨äºæ‰¾åˆ°æ­£ç¡®çš„è½¬ç§»æ–¹ç¨‹ï¼š</p>
<ul>
<li><em>dp</em>[<em>v</em>]=<em>dp</em>[<em>v</em>âˆ’<em>d</em>]+1</li>
</ul>
<p>ä»£ç </p>
<blockquote>
<p>è¿™é‡Œæ”¾çš„æ˜¯å®˜æ–¹çš„é¢˜è§£ï¼Œé—®å°±æ˜¯å†™çš„æ¯”æˆ‘ä¼˜é›…ç®€æ´ã€‚ã€‚ã€‚</p>
</blockquote>
<pre><code class="java">class Solution &#123;
    public int longestSubsequence(int[] arr, int difference) &#123;
        int ans = 0;
        Map&lt;Integer, Integer&gt; dp = new HashMap&lt;Integer, Integer&gt;();
        for (int v : arr) &#123;
            dp.put(v, dp.getOrDefault(v - difference, 0) + 1);
            ans = Math.max(ans, dp.get(v));
        &#125;
        return ans;
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O</em>(<em>n</em>)ï¼Œå…¶ä¸­ <em>n</em> æ˜¯æ•°ç»„ <em>arr</em> çš„é•¿åº¦ã€‚</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O</em>(<em>n</em>)ã€‚å“ˆå¸Œè¡¨éœ€è¦ O*(*n) çš„ç©ºé—´ã€‚</p>
<h2 id="319-ç¯æ³¡å¼€å…³-æ•°è®º"><a href="#319-ç¯æ³¡å¼€å…³-æ•°è®º" class="headerlink" title="319. ç¯æ³¡å¼€å…³ æ•°è®º"></a><a href="https://leetcode-cn.com/problems/bulb-switcher/">319. ç¯æ³¡å¼€å…³</a> æ•°è®º</h2><blockquote>
<p>å¾ˆç»å…¸çš„æ•°è®ºé¢˜</p>
</blockquote>
<p>æ€è·¯</p>
<p>é¦–å…ˆï¼Œä»çº¦æ•°ä¸‹æ‰‹ï¼Œä¸éš¾å¾—å‡ºï¼Œçº¦æ•°ä¸ºå¶æ•°çš„çš„ç¯æ³¡ï¼Œæœ€åä¼šç†„ç­ï¼ŒåŒç†ï¼Œçº¦æ•°ä¸ºå¥‡æ•°çš„ç¯æ³¡ï¼Œæœ€åä¼šäº®ç€ã€‚</p>
<p>ç„¶åï¼Œç”±çº¦æ•°çš„å®šä¹‰å¯å¾—ï¼Œå¯¹äºæ•°å­—<strong>k</strong>è€Œè¨€ï¼Œå¦‚æœä»–æœ‰çº¦æ•°xï¼Œé‚£ä¹ˆä¸€å®šæœ‰ç›¸å¯¹åº”çš„çº¦æ•°å­—<strong>y</strong>æˆå¯¹å‡ºç°ï¼Œä½¿å¾—<strong>k=x*y</strong>ï¼ŒåŒæ—¶ï¼Œåªæœ‰çº¦æ•°ä¸º<strong>ã€Œå®Œå…¨å¹³æ–¹æ•°ã€</strong>æ—¶ï¼Œæ‰ä¼šæœ‰<strong>å¥‡æ•°ä¸ª</strong>çš„çº¦æ•°ï¼Œå¦åˆ™åˆ™ä¸º<strong>å¶æ•°ä¸ª</strong></p>
<p>ä¸¾ä¸ªğŸŒ°ï¼š</p>
<p>ğŸ’¡ç¯æ³¡8âƒ£ï¸çš„çº¦æ•°æœ‰ï¼š1ã€2ã€4ã€8ï¼Œç›¸å¯¹åº”çš„æ˜¯-&gt;äº®ã€ç­ã€äº®ã€ç­</p>
<p>ğŸ’¡ç¯æ³¡9âƒ£ï¸çš„çº¦æ•°æœ‰ï¼š1ã€3ã€9ï¼Œç›¸å¯¹åº”çš„æ˜¯-&gt;äº®ã€ç­ã€äº®</p>
<p>æœ€åï¼Œå°±æ˜¯æ±‚ç»™å®šnçš„çº¦æ•°ï¼Œè€ƒè™‘åˆ°å¼€æ–¹ï¼Œç»“æœå‘ä¸‹å–æ•´ã€‚</p>
<p>ä»£ç </p>
<pre><code class="Java">class Solution &#123;
    public int bulbSwitch(int n) &#123;
        return (int)Math.floor(Math.sqrt(n));
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</p>
<h2 id="1143-æœ€é•¿å…¬å…±å­åºåˆ—-åŠ¨æ€è§„åˆ’"><a href="#1143-æœ€é•¿å…¬å…±å­åºåˆ—-åŠ¨æ€è§„åˆ’" class="headerlink" title="1143. æœ€é•¿å…¬å…±å­åºåˆ— åŠ¨æ€è§„åˆ’"></a><a href="https://leetcode-cn.com/problems/longest-common-subsequence/">1143. æœ€é•¿å…¬å…±å­åºåˆ—</a> åŠ¨æ€è§„åˆ’</h2><p>æ€è·¯</p>
<p>äºŒç»´æ•°ç»„+DP</p>
<p>çŠ¶æ€å®šä¹‰ï¼š<code>dp[i][j]</code>ä»£è¡¨è€ƒè™‘text1 å‰<code>i</code>ä¸ªå­—ç¬¦ã€è€ƒè™‘text2å‰<code>j</code>ä¸ªå­—ç¬¦</p>
<p>é‚£ä¹ˆå¯¹äºã€Œè½¬ç§»æ–¹ç¨‹ã€æ¥è¯´</p>
<ul>
<li>å½“å­—ç¬¦ä¸²<code>cs1[i] == cs[j]</code>ï¼š<code>dp[i][j] == dp[i-1][j-1] +1</code></li>
<li>å½“å­—ç¬¦ä¸²<code>cs1[i] != cs[j]</code>ï¼š<code>dp[i][j]=max(dp[i][j-1],dp[i-1][j])</code></li>
</ul>
<blockquote>
<p>è¿™é‡Œæ”¾ä¸€å¼ å®˜è§£çš„å›¾</p>
</blockquote>
<p><img src="/2021/10/09/LeetCodeDaily/1143.png"></p>
<p>ä»£ç </p>
<pre><code class="java">class Solution &#123;
    public int longestCommonSubsequence(String text1, String text2) &#123;
        int n = text1.length(), m = text2.length();
        char[] cs1 = text1.toCharArray();
        char[] cs2 = text2.toCharArray();
        int[][] dp = new int[n + 1][m + 1];
        for(int i = 1; i &lt;= n;i++)&#123;
            for(int j = 1 ;j &lt;= m; j++)&#123;
                if(cs1[i-1] == cs2[j-1]) dp[i][j] = dp[i-1][j-1] + 1;
                else dp[i][j] = Math.max(dp[i][j-1],dp[i-1][j]); 
            &#125;
        &#125;
        return dp[n][m];
    &#125;
&#125;
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼šO(n * m)</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼šO(n * m)</p>
]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Golangå…¥é—¨</title>
    <url>/2021/10/02/Go/</url>
    <content><![CDATA[<h2 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h2><p>Goï¼ˆåˆç§°Golangï¼‰æ˜¯è°·æ­Œå¼€å‘çš„ä¸€ç§å…·æœ‰å¹¶å‘å‹ï¼Œç®€å•æ€§ï¼Œå¹¶å…·æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½çš„é™æ€å¼ºç±»å‹è¯­è¨€ã€‚</p>
<span id="more"></span>

<p>ç»ƒä¹ ç›¸å…³ä»£ç å·²ç»pushåˆ°githubä¸Šï¼š<a href="https://github.com/Super-ZZGuo/FirstGo">https://github.com/Super-ZZGuo/FirstGo</a></p>
<h2 id="Golang-å­¦ä¹ ç¬”è®°"><a href="#Golang-å­¦ä¹ ç¬”è®°" class="headerlink" title="Golang å­¦ä¹ ç¬”è®°"></a>Golang å­¦ä¹ ç¬”è®°</h2><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p><strong>å®šä¹‰é•¿åº¦</strong>çš„æ•°ç»„åªèƒ½ä¼ ç»™<strong>é™åˆ¶äº†ç›¸åŒæ•°ç»„é•¿åº¦</strong>çš„å‡½æ•°</p>
<p><strong>æœªå®šä¹‰é•¿åº¦</strong>çš„æ•°ç»„åªèƒ½ä¼ ç»™<strong>ä¸é™åˆ¶æ•°ç»„é•¿åº¦</strong>çš„å‡½æ•°</p>
<p>Goæ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°å€¼ä¼ é€’æ—¶ï¼Œå‡½æ•°ä¸­çš„ä¿®æ”¹å¯¹è°ƒç”¨è€…ä¸å½±å“</p>
<p>åŒç†ï¼Œ<strong>ä¼ é€’æ•°ç»„çš„å†…å­˜åœ°å€</strong>æ—¶ï¼Œå‡½æ•°ä¸­çš„ä¿®æ”¹ä¼šæ”¹å˜æ•°ç»„çš„å€¼</p>
<h3 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h3><blockquote>
<p>æœªå®šä¹‰é•¿åº¦çš„æ•°ç»„</p>
</blockquote>
<p>åˆ‡ç‰‡æ˜¯åŸºäºæ•°ç»„ç±»å‹çš„ä¸€å±‚å°è£…ï¼Œæ˜¯å¯¹æ•°ç»„ä¸€ä¸ªè¿ç»­ç‰‡æ®µçš„<strong>å¼•ç”¨</strong>(æ„å‘³ç€å¤šä¸ªåˆ‡ç‰‡è¡¨ç¤ºç”¨ä¸€ä¸ªæ•°ç»„ç‰‡æ®µçš„è¯ï¼Œé‚£è¿™å‡ ä¸ªåˆ‡ç‰‡å¯ä»¥å…±äº«æ•°æ®ï¼)</p>
<p>åˆ‡ç‰‡çš„æ•°æ®ç»“æ„ = æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ + åˆ‡ç‰‡é•¿åº¦ + åˆ‡ç‰‡å®¹é‡<strong>ï¼ˆåˆ‡ç‰‡æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ï¼‰</strong></p>
<pre><code class="go">//åˆ‡ç‰‡çš„æœ¬è´¨
arr := [...]int&#123;1,2,3,4&#125;
slice := []int&#123;1,2,3,4&#125;
fmt.Printf(&quot;arrçš„é¦–åœ°å€ä¸ºï¼š%p\n&quot;, &amp;arr)
//åˆ‡ç‰‡æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰“å°åœ°å€çš„æ—¶å€™æ— éœ€&amp;åœ°å€å¼•ç”¨
fmt.Printf(&quot;sliceçš„é¦–åœ°å€ä¸ºï¼š%p\n&quot;, slice)
</code></pre>
<p>nilåˆ‡ç‰‡(è¡¨ç¤ºä¸å­˜åœ¨çš„åˆ‡ç‰‡)æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆä¸ºnilï¼Œç©ºåˆ‡ç‰‡(è¡¨ç¤ºç©ºé›†åˆ)çš„æŒ‡é’ˆåˆ™æ˜¯ä¸€ä¸ªåœ°å€</p>
<p><code>len(slice)</code>:è¿”å›åˆ‡ç‰‡<code>slice</code>çš„é•¿åº¦</p>
<p><code>cap(slice)</code>:è¿”å›åˆ‡ç‰‡<code>slice</code>çš„å®¹é‡</p>
<p>0 &lt;= <code>len(slice)</code> &lt;= <code>cap(slice)</code></p>
<p><strong>åˆ‡ç‰‡å®¹é‡çš„å˜åŒ–</strong></p>
<ul>
<li>å¯¹äºåº•å±‚æ•°ç»„å®¹é‡ä¸ºkçš„åˆ‡ç‰‡<code>slice[i,j]</code><ul>
<li>åˆ‡ç‰‡<code>slice</code>çš„<strong>é•¿åº¦len:  j - i</strong></li>
<li>åˆ‡ç‰‡<code>slice</code>çš„<strong>å®¹é‡cap: k - i</strong></li>
</ul>
</li>
</ul>
<p><code>append()</code>ï¼šè¿½åŠ å…ƒç´ </p>
<ul>
<li>åº•å±‚æ•°ç»„çš„æ™ºèƒ½ç®—æ³•ï¼š<ul>
<li>å½“åº•å±‚æ•°ç»„å®¹é‡(é•¿åº¦)å°äº1000æ—¶ï¼Œéœ€è¦æ‰©å®¹æ—¶æ€»æ˜¯æˆå€å¢é•¿</li>
<li>å½“åº•å±‚æ•°ç»„å®¹é‡(é•¿åº¦)å¤§äº1000æ—¶ï¼Œå¢é•¿å› å­è®¾ä¸º1.25ï¼Œå®¹é‡ä»¥1.25å€é€Ÿåº¦æ‰©å®¹</li>
</ul>
</li>
</ul>
<pre><code class="go">//æµ‹è¯•appendæ‰©å®¹
var i int
var testSlice []int
for i = 0 ;i &lt; 1100; i++&#123;
   testSlice = append(testSlice,i)
   fmt.Println(cap(testSlice))
&#125;
</code></pre>
<p>åœ¨**$GOROOT /src/runtime/slice.go** å¯ä»¥æŸ¥çœ‹å…³äºappendæ‰©å®¹çš„ç›¸å…³ä»£ç </p>
<p><img src="/2021/10/02/Go/slice.png"></p>
<p><code>copy(dst,src)</code>ï¼šå¤åˆ¶å…ƒç´ srcåˆ°ç›®æ ‡dstï¼Œè¿”å›å¤åˆ¶å…ƒç´ çš„ä¸ªæ•°</p>
<ul>
<li>dstçš„sizeéœ€è¦åˆå§‹åŒ–ï¼Œå¦åˆ™æ— æ³•å¤åˆ¶</li>
</ul>
<h3 id="Rangeå…³é”®å­—"><a href="#Rangeå…³é”®å­—" class="headerlink" title="Rangeå…³é”®å­—"></a>Rangeå…³é”®å­—</h3><p>Rangeä¸€èˆ¬é…åˆForè¿›è¡Œéå†ï¼Œèƒ½è¿­ä»£éå†æ•°ç»„ã€åˆ‡ç‰‡ã€Mapã€channelç­‰</p>
<p>éå†åˆ‡ç‰‡çš„ä¸€ä¸ªæ ·ä¾‹ï¼ˆåŒç†æ•°ç»„ï¼‰ï¼š</p>
<pre><code class="go">//ä½¿ç”¨indexç´¢å¼•å’Œvalueå€¼
    fmt.Println(&quot;---------ä½¿ç”¨indexç´¢å¼•å’Œvalueå€¼---------&quot;)
    array := []int&#123;1,2,3,4,5&#125;
    for index,value := range array&#123;
        fmt.Printf(&quot;åˆ‡ç‰‡ç´¢å¼•æ˜¯ï¼š%d çš„å€¼æ˜¯ï¼š%d \n&quot; ,index,value)
    &#125;

    //åªä½¿ç”¨iç´¢å¼•æ¥è·å–æ•°ç»„çš„å€¼
    fmt.Println(&quot;---------åªä½¿ç”¨iç´¢å¼•æ¥è·å–æ•°ç»„çš„å€¼---------&quot;)
    for i , _ := range array&#123;
        fmt.Printf(&quot;åˆ‡ç‰‡ç´¢å¼•æ˜¯ï¼š%d çš„å€¼æ˜¯ï¼š%d \n&quot; ,i,array[i])
    &#125;

    //åªä½¿ç”¨vå€¼
    fmt.Println(&quot;---------åªä½¿ç”¨vå€¼---------&quot;)
    for _ , v := range array&#123;
        fmt.Printf(&quot;åˆ‡ç‰‡çš„å€¼æ˜¯ï¼š%d \n&quot; ,v)
    &#125;
</code></pre>
<blockquote>
<p>ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><strong>é€‚å½“</strong>æ”¾å¼ƒæ¥å—indexæˆ–è€…valueï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦æå‡æ€§èƒ½ï¼ˆfor-rangeæ¯æ¬¡è¿­ä»£éƒ½ä¼šå¯¹indexå’Œvalueè¿›è¡Œèµ‹å€¼ï¼Œæ•°æ®é‡å¤§æ—¶ä¸”valueä¸ºStringæ—¶ä¸å¦¨è€ƒè™‘åªç”¨ç´¢å¼•æ¥å¼•ç”¨valueå€¼ï¼ˆå‚è€ƒæ ·ä¾‹ç¬¬äºŒæ®µä»£ç ï¼‰ï¼‰</li>
<li>åŠ¨æ€éå†ä¸­æ“ä½œåˆ‡ç‰‡é•¿åº¦æ—¶ï¼Œä¸å½±å“å¾ªç¯æ¬¡æ•°ï¼Œå› ä¸ºå¾ªç¯æ¬¡æ•°åœ¨å¼€å§‹å‰å·²ç»ç¡®å®šäº†</li>
<li>éå†channelæ—¶ï¼Œå¦‚æœchannelæ²¡æœ‰æ•°æ®ï¼Œå¯èƒ½ä¼šé˜»å¡ç­‰å¾…</li>
</ul>
</blockquote>
<h3 id="Mapé›†åˆ"><a href="#Mapé›†åˆ" class="headerlink" title="Mapé›†åˆ"></a>Mapé›†åˆ</h3><p>mapæ˜¯æ— åºçš„é”®å€¼å¯¹é›†åˆï¼Œæ•…éå†å‡ºæ¥çš„ç»“æœé¡ºåºå¯èƒ½ä¸åŒ</p>
<p>mapä¸åˆå§‹åŒ–æ—¶ï¼Œåˆ›å»ºçš„æ˜¯ä¸€ä¸ªnil mapï¼Œåç»­æ— æ³•æ’å…¥æ–°çš„é”®å€¼å¯¹</p>
<p>mapå’Œåˆ‡ç‰‡ç±»ä¼¼ï¼Œæ˜¯å¼•ç”¨ç±»å‹</p>
<h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>ä¼ é€’æŒ‡é’ˆèƒ½ä½¿å¤šä¸ªå‡½æ•°æ˜ç¡®æ“ä½œåŒä¸€ä¸ªå¯¹è±¡</p>
<p>ä¼ é€’æŒ‡é’ˆç›¸æ¯”äºä¼ é€’ä½“ç§¯è¾ƒå¤§çš„ç»“æ„ä½“æ›´è½»é‡åŒ–ï¼ˆ8bytesï¼‰</p>
<h4 id="deferå»¶è¿Ÿå‡½æ•°"><a href="#deferå»¶è¿Ÿå‡½æ•°" class="headerlink" title="deferå»¶è¿Ÿå‡½æ•°"></a>deferå»¶è¿Ÿå‡½æ•°</h4><pre><code class="go">str := &quot;string&quot;
fmt.Printf(&quot;%s \n&quot;,string(str))
for _ , v := range str&#123;
   defer fmt.Printf(&quot;%c&quot;,v)
&#125;
</code></pre>
<p>æ³¨æ„ç‚¹:</p>
<ul>
<li>ä¸€ä¸ªå‡½æ•°ä¸­å½“æ‰€æœ‰å»¶è¿Ÿæ“ä½œéƒ½å®Œæˆåï¼Œè¯¥å‡½æ•°æ‰ç®—å®Œæˆï¼ˆå¤–å›´å‡½æ•°çš„è¯­å¥æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œåªæœ‰å½“å»¶è¿Ÿå‡½æ•°éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œè¯¥å¤–å›´å‡½æ•°æ‰ç®—ç»“æŸæ‰§è¡Œï¼‰</li>
</ul>
<h4 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h4><p>å‡½æ•°ä¹Ÿå±äºä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯ä»¥çœ‹åš<strong>å‡½æ•°å</strong>æ˜¯æŒ‡å‘å‡½æ•°ä½“çš„å†…å­˜åœ°å€</p>
<h4 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h4><p>ä¸€ä¸ªå‡½æ•°(<strong>å›è°ƒå‡½æ•°</strong>)ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°(<strong>é«˜é˜¶å‡½æ•°</strong>)çš„å‚æ•°</p>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><blockquote>
<p>ä¸€ä¸ª<strong>æ–¹æ³•</strong>æ˜¯ä¸€ä¸ªå¸¦æœ‰æ¥å—è€…çš„å‡½æ•°</p>
</blockquote>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
<h3 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h3><p><img src="/2021/10/02/Go/pointer.png"></p>
<h3 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h3><p>é¦–å­—æ¯å¤§å°å†™é—®é¢˜ï¼ˆç›¸å¯¹äºåŒ…çš„å¯è§æ€§ï¼‰</p>
<ul>
<li>é¦–å­—æ¯å¤§å†™ç›¸å½“äºpublic</li>
<li>é¦–å­—æ¯å°å†™ç›¸å½“äºprivate</li>
<li>ç»“æ„ä½“å†…<strong>å¤§å†™</strong>å¼€å¤´çš„å±æ€§èƒ½è¢«<strong>å…¶ä»–åŒ…</strong>å¼•ç”¨(public)</li>
<li>ç»“æ„ä½“å†…å°å†™å¼€å¤´çš„å±æ€§åªèƒ½åŒ…å†…å¼•ç”¨(private)</li>
</ul>
<h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p>æ¥å£åªæ˜¯ä¸€ç»„å…±æ€§æ–¹æ³•çš„ç­¾å(åªå£°æ˜ä¸å®ç°)</p>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
<h3 id="é”™è¯¯"><a href="#é”™è¯¯" class="headerlink" title="é”™è¯¯"></a>é”™è¯¯</h3><p>ä½¿ç”¨ <code>defer</code>+  <code>recover()</code>æ¥æ•è·\å¤„ç†å¼‚å¸¸<code>panic</code></p>
<p>ä¸€ä¸ªç®€å•çš„demoï¼š</p>
<pre><code class="go">func test()&#123;
   defer func() &#123;
      err := recover() //æ•è·å¼‚å¸¸
      if err != nil &#123;  //è¯´æ˜æ•è·åˆ°å¼‚å¸¸
         fmt.Println(&quot;æ•è·åˆ°å¼‚å¸¸ï¼š&quot;, err)
      &#125;
   &#125;()
   num1 := 10
   num2 := 0
   res := num1 / num2
   fmt.Printf(&quot;è®¡ç®—ç»“æœä¸º: %d&quot;,res )
&#125;
func main()&#123;
   test()
   fmt.Println(&quot;ç¨‹åºæ­£å¸¸è¿è¡Œ...&quot;)
&#125;
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š<br><img src="/2021/10/02/Go/error1.png"></p>
<blockquote>
<p>Tips:</p>
<ul>
<li><p>Goä¸­<code>recover</code>åªåœ¨<code>defer</code>è°ƒç”¨çš„å‡½æ•°ä¸­æœ‰æ•ˆï¼Œè€Œä¸”<code>defer</code>è¦åœ¨<code>panic</code>å‘ç”Ÿå‰å…ˆæ³¨å†Œ</p>
</li>
<li><p>é¡¹ç›®çš„å¼€å‘åˆæœŸå¤šä½¿ç”¨<code>panic</code>æ¥å¼ºåˆ¶å‘ç°é”™è¯¯,å°½å¿«ä¿®å¤</p>
</li>
<li><p>é¡¹ç›®ä¸Šçº¿éƒ¨ç½²åä½¿ç”¨<code>defer</code> + <code>recover</code>æ¥é¿å…æ•´ä¸ªGolangè¿›ç¨‹å¼‚å¸¸é€€å‡º</p>
</li>
</ul>
</blockquote>
<h4 id="è‡ªå®šä¹‰é”™è¯¯"><a href="#è‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="è‡ªå®šä¹‰é”™è¯¯"></a>è‡ªå®šä¹‰é”™è¯¯</h4><p>å†…ç½®<code>error</code>æ˜¯ä¸€ç§æ•°æ®ç±»å‹</p>
<p>ä½¿ç”¨structç»“æ„ä½“æ¥è‡ªå®šä¹‰æ›´å¤šé”™è¯¯ä¿¡æ¯ï¼š</p>
<blockquote>
<p>è¿™ç±»ç»“æ„ä½“ä¸€èˆ¬å‘½åä¸º<code>xxxError</code></p>
</blockquote>
<pre><code class="go">//ä½¿ç”¨ç»“æ„ä½“çš„æ–¹å¼èƒ½è‡ªå®šä¹‰/æä¾›æ›´å¤šçš„é”™è¯¯ä¿¡æ¯
type radiusError struct &#123;
   err string
   radius float64
   area float64
&#125;
//å®ç°erroræ¥å£
func (e *radiusError) Error() string &#123;
   return fmt.Sprintf(&quot;è¾“å…¥åŠå¾„ä¸ºï¼š%0.2fï¼ŒæŠ¥é”™ä¿¡æ¯ï¼š %sï¼Œè®¡ç®—å‡ºé¢ç§¯ä¸ºï¼š%0.2f&quot;, e.radius, e.err, e.area)
&#125;
</code></pre>
<p><code>errors.New</code> ï¼šå¯ä»¥è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯</p>
<p><code>fmt.Errorf</code>ï¼šå¯ä»¥è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯(æ ¼å¼åŒ–)</p>
<h3 id="åŒ…ç®¡ç†"><a href="#åŒ…ç®¡ç†" class="headerlink" title="åŒ…ç®¡ç†"></a>åŒ…ç®¡ç†</h3><h4 id="init-å‡½æ•°"><a href="#init-å‡½æ•°" class="headerlink" title="init()å‡½æ•°"></a><code>init()å‡½æ•°</code></h4><p>ä¸€èˆ¬ç”¨äºåˆå§‹åŒ–åŒ…æ‰€éœ€è¦çš„ç‰¹å®šèµ„æ–™ï¼Œå’Œ<code>main()</code>å‡½æ•°ä½œä¸ºGoä¸­çš„ä¿ç•™å‡½æ•°</p>
<p>ç›¸åŒç‚¹ï¼š</p>
<ul>
<li>ä¸¤ä¸ªå‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™ä¸èƒ½æœ‰ä»»ä½•çš„å‚æ•°å’Œè¿”å›å€¼ï¼Œåªèƒ½ç”±goç¨‹åºè‡ªåŠ¨è°ƒç”¨</li>
</ul>
<p>ä¸åŒç‚¹ï¼š</p>
<ul>
<li><code>init()</code> å¯ä»¥åœ¨ä¸€ä¸ªåŒ…ä¸­å®šä¹‰å¤šä¸ª</li>
</ul>
<p><code>init()</code> å‡½æ•°çš„æ‰§è¡Œé¡ºåºï¼š</p>
<ul>
<li>åŒä¸€ä¸ªåŒ…ä¸­è‡ªä¸Šå‘ä¸‹</li>
<li>åŒä¸€ä¸ªåŒ…ä¸­ä¸åŒæ–‡ä»¶ï¼Œå°†æ–‡ä»¶åæŒ‰å­—ç¬¦ä¸²è¿›è¡Œâ€œä»å°åˆ°å¤§â€æ’åºï¼Œä¹‹åé¡ºåºè°ƒç”¨å„æ–‡ä»¶ä¸­çš„init()å‡½æ•°ã€‚</li>
<li>ä¸åŒåŒ…ä¸­ï¼Œç›¸äº’ä¾èµ–çš„è¯ï¼Œæœ€åè¢«ä¾èµ–çš„æœ€å…ˆæ‰§è¡Œ<code>init()</code> (è¢«åˆ«çš„åŒ…è°ƒç”¨ä¹‹å‰å…ˆä¿è¯è‡ªå·±çš„<strong>åŠŸèƒ½å®Œæ•´</strong>)</li>
</ul>
<h4 id="ä¸€äº›æ³¨æ„ç‚¹"><a href="#ä¸€äº›æ³¨æ„ç‚¹" class="headerlink" title="ä¸€äº›æ³¨æ„ç‚¹"></a>ä¸€äº›æ³¨æ„ç‚¹</h4><ul>
<li>å¯¼å…¥åŒ…çš„è·¯å¾„åï¼Œæ¨èä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆä»å·¥ç¨‹æ ¹ç›®å½•å¼€å§‹ï¼‰</li>
<li>å¯¼å…¥å¤–éƒ¨çš„åŒ…æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åœ¨å‘½ä»¤è¡Œä½¿ç”¨<code>go get [å¤–éƒ¨åŒ…è·¯å¾„]</code>çš„æ–¹å¼å–åˆ°GOPATHå¯¹åº”çš„ç›®å½•ä¸­</li>
</ul>
<h3 id="å¹¶å‘Goroutine-amp-Channel"><a href="#å¹¶å‘Goroutine-amp-Channel" class="headerlink" title="å¹¶å‘Goroutine&amp;Channel"></a>å¹¶å‘Goroutine&amp;Channel</h3><p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼š</p>
<ul>
<li><p><code>è¿›ç¨‹</code>ï¼šä¸€ä¸ªç¨‹åºåœ¨ä¸€ä¸ªæ•°æ®é›†ä¸­çš„ä¸€æ¬¡åŠ¨æ€æ‰§è¡Œè¿‡ç¨‹</p>
<ul>
<li>ç”± ç¨‹åº + æ•°æ®é›† + è¿›ç¨‹æ§åˆ¶å—(PCB) ç»„æˆ</li>
</ul>
</li>
<li><p><code>çº¿ç¨‹</code>ï¼šåŸºæœ¬çš„CPUæ‰§è¡Œå•å…ƒï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹</p>
</li>
<li><p><code>åç¨‹</code>ï¼šç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œç±»æ¯”ç†è§£æˆå­ç¨‹åº(å‡½æ•°)</p>
<ul>
<li>è¯­è¨€ä¸­çš„çº¿ç¨‹å’Œ<strong>æ“ä½œç³»ç»Ÿå†…æ ¸</strong>æ€çº¿ç¨‹(KSE)æœ‰æ‰€åŒºåˆ«</li>
</ul>
</li>
</ul>
<p>é‡çº§ï¼š<strong>è¿›ç¨‹</strong> &gt; <strong>çº¿ç¨‹</strong> &gt; <strong>åç¨‹</strong></p>
<h4 id="Goroutine"><a href="#Goroutine" class="headerlink" title="Goroutine"></a>Goroutine</h4><p>åœ¨å‡½æ•°å’Œæ–¹æ³•è°ƒç”¨å‰åŠ ä¸Š<code>go</code>,ä¼šåŒæ—¶è¿è¡Œä¸€ä¸ªæ–°çš„Goroutine</p>
<p>ä¸€ä¸ªå°demoï¼š</p>
<pre><code class="go">func numbers()&#123;
   for i:=0 ; i &lt;= 5 ; i++&#123;
      time.Sleep(250 * time.Millisecond)
      fmt.Printf(&quot;%d &quot;,i)
   &#125;
&#125;

func alphabets()&#123;
   for i:=&#39;a&#39; ; i &lt;= &#39;e&#39; ; i++&#123;
      time.Sleep(400 * time.Millisecond)
      fmt.Printf(&quot;%c &quot;,i)
   &#125;
&#125;
func main()&#123;
   go numbers()
   go alphabets()
   time.Sleep(5 * time.Second)
   fmt.Println(&quot;main terminated&quot;)
&#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2021/10/02/Go/Goroutine1.png"></p>
<h4 id="å¹¶å‘æ¨¡å‹"><a href="#å¹¶å‘æ¨¡å‹" class="headerlink" title="å¹¶å‘æ¨¡å‹"></a>å¹¶å‘æ¨¡å‹</h4><h5 id="çº¿ç¨‹æ¨¡å‹"><a href="#çº¿ç¨‹æ¨¡å‹" class="headerlink" title="çº¿ç¨‹æ¨¡å‹"></a>çº¿ç¨‹æ¨¡å‹</h5><ul>
<li><p><code>å†…æ ¸çº§çº¿ç¨‹æ¨¡å‹</code>ï¼šç”¨æˆ·çº¿ç¨‹ä¸KSEæ˜¯1å¯¹1å…³ç³»**(1:1)**ï¼Œè°ƒåº¦å®Œå…¨ç”±OSè°ƒåº¦å™¨æ“ä½œ![æˆªå±2021-10-04 ä¸‹åˆ11.04.12](/Users/kokorozashiguohuang/Library/Application Support/typora-user-images/æˆªå±2021-10-04 ä¸‹åˆ11.04.12.png)</p>
<ul>
<li>ä¼˜ç‚¹ï¼šå®ç°äº†çœŸæ­£çš„å¹¶è¡Œï¼Œå¹¶å‘èƒ½åŠ›è¾ƒå¼º</li>
<li>ç¼ºç‚¹ï¼šå¯¹ç°åœºå¼€é”€å¤§ï¼Œå½±å“æ€§èƒ½<br><img src="/2021/10/02/Go/Goroutine2.png"></li>
</ul>
</li>
<li><p>ç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹ï¼šç”¨æˆ·çº¿ç¨‹ä¸KSEæ˜¯å¤šå¯¹1å…³ç³»**(M:1)**</p>
<ul>
<li>ä¼˜ç‚¹ï¼šçº¿ç¨‹ä¸Šä¸‹é—®å‘ç”Ÿåœ¨ç”¨æˆ·ç©ºé—´ï¼Œé¿å…äº†æ¨¡æ€åˆ‡æ¢</li>
<li>ç¼ºç‚¹ï¼šåªæœ‰ä¸€ä¸ªå¤„ç†å™¨å¯ä»¥è¢«åˆ©ç”¨<br><img src="/2021/10/02/Go/Goroutine3.png"></li>
</ul>
</li>
<li><p>ä¸¤çº§çº¿ç¨‹æ¨¡å‹ï¼šç”¨æˆ·çº¿ç¨‹ä¸KSEæ˜¯å¤šå¯¹å¤šå…³ç³»**(M:N)**</p>
</li>
</ul>
<p> <img src="/2021/10/02/Go/Goroutine4.png"></p>
<h5 id="Goå¹¶å‘è°ƒåº¦ï¼šG-P-Mæ¨¡å‹"><a href="#Goå¹¶å‘è°ƒåº¦ï¼šG-P-Mæ¨¡å‹" class="headerlink" title="Goå¹¶å‘è°ƒåº¦ï¼šG-P-Mæ¨¡å‹"></a>Goå¹¶å‘è°ƒåº¦ï¼šG-P-Mæ¨¡å‹</h5><p>ï¼ˆæœ‰ç‚¹ç¡¬æ ¸ï¼Œæœ‰æœºä¼šå•ç‹¬å†™ä¸€ç¯‡åšå®¢ï¼‰</p>
<h4 id="runtimeåŒ…"><a href="#runtimeåŒ…" class="headerlink" title="runtimeåŒ…"></a>runtimeåŒ…</h4><ul>
<li><p>**<code>NumCPU</code>**ï¼šè¿”å›å½“å‰ç³»ç»Ÿçš„ <code>CPU</code> æ ¸æ•°é‡</p>
</li>
<li><p>**<code>GOMAXPROCS</code>**ï¼šè®¾ç½®æœ€å¤§çš„å¯åŒæ—¶ä½¿ç”¨çš„ <code>CPU</code> æ ¸æ•°(åœ¨<code>initå‡½æ•°</code>ä¸­æ“ä½œï¼Œå³åœ¨Goç¨‹åºä¹‹å‰è®¾ç½®å¥½)</p>
</li>
<li><p>**<code>NumGoroutine</code>**ï¼šè¿”å›æ­£åœ¨æ‰§è¡Œå’Œæ’é˜Ÿçš„ä»»åŠ¡æ€»æ•°</p>
</li>
<li><p>**<code>GOOS</code>**ï¼šè¿”å›ç›®æ ‡æ“ä½œç³»ç»Ÿ</p>
</li>
<li><p><strong><code>runtime.GC</code></strong>:ä¼šè®©è¿è¡Œæ—¶ç³»ç»Ÿè¿›è¡Œä¸€æ¬¡å¼ºåˆ¶æ€§çš„åƒåœ¾æ”¶é›†</p>
</li>
<li><p><strong><code>GOROOT</code></strong> :è·å–gorootç›®å½•</p>
</li>
<li><p>**<code>Gosched</code>**ï¼šè®©å½“å‰çº¿ç¨‹è®©å‡º <code>cpu</code> ä»¥è®©å…¶å®ƒçº¿ç¨‹è¿è¡Œ,å®ƒä¸ä¼šæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œå› æ­¤å½“å‰çº¿ç¨‹æœªæ¥ä¼šç»§ç»­æ‰§è¡Œ</p>
<pre><code class="go">go func() &#123;
   for i := 0; i &lt; 5; i++ &#123;
      fmt.Println(&quot;goroutineæ‰§è¡Œä¸­ã€‚ã€‚ã€‚&quot;)
   &#125;
   fmt.Println(&quot;goroutineæ‰§è¡Œå®Œæ¯•ã€‚&quot;)
&#125;()
for i := 0; i &lt; 4; i++ &#123;
   //è®©å‡ºæ—¶é—´ç‰‡ï¼Œå…ˆè®©åˆ«çš„åè®®æ‰§è¡Œï¼Œå®ƒæ‰§è¡Œå®Œï¼Œå†å›æ¥æ‰§è¡Œæ­¤åç¨‹
   runtime.Gosched()
   fmt.Println(&quot;mainæ‰§è¡Œä¸­ã€‚ã€‚ã€‚&quot;)
&#125;
fmt.Println(&quot;mainæ‰§è¡Œå®Œæ¯•&quot;)
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="/2021/10/02/Go/Goroutine5.png"></p>
</li>
<li><p>**<code>Goexit</code>**ï¼šé€€å‡ºå½“å‰ <code>goroutine</code>(ä½†æ˜¯<code>defer</code>è¯­å¥ä¼šç…§å¸¸æ‰§è¡Œ)</p>
<pre><code class="go">func main()&#123;

   go func()&#123;

      fmt.Println(&quot;å¼€å§‹ä¸€ä¸ªgoroutine&quot;)
      defer fmt.Println(&quot;å¼€å§‹deferã€‚ã€‚ã€‚&quot;)

      //ç»ˆæ­¢æ‰€åœ¨çš„åç¨‹
      runtime.Goexit()

      fmt.Println(&quot;goroutineç»“æŸ&quot;)
   &#125;()

   //åŒºåˆ†ä¸»åç¨‹
   time.Sleep(5 * time.Second)
   fmt.Println(&quot;ä¸»goroutineå³å°†ç»“æŸ&quot;)
&#125;
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„goroutineæ‰“å°çš„ä¿¡æ¯å¹¶æ²¡æœ‰å‡ºæ¥ï¼Œè€Œ<strong>defer</strong>æ‰“å°çš„ä¿¡æ¯å´å‡ºæ¥äº†</p>
</blockquote>
<p><img src="/2021/10/02/Go/Goroutine6.png"></p>
</li>
</ul>
<h4 id="channelé€šé“"><a href="#channelé€šé“" class="headerlink" title="channelé€šé“"></a>channelé€šé“</h4><blockquote>
<p>â€œä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œåº”è¯¥é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜â€</p>
</blockquote>
<p>ç”¨æ¥å®ç°goroutineä¹‹é—´çš„é€šé“(ç›¸äº’é€šä¿¡)</p>
<p>é€šé“å®šä¹‰æ—¶çš„ç±»å‹å†³å®šäº†é€šé“å…è®¸ä¼ è¾“çš„æ•°æ®ç±»å‹</p>
<ul>
<li><strong>nil chan</strong>å’Œ<strong>nil map</strong>ä¸€æ ·ï¼Œæ— æ³•ä½¿ç”¨</li>
</ul>
<blockquote>
<p>Tips:</p>
<p>å¯ä»¥é€šè¿‡okæ˜¯å¦ä¸ºtrueå’Œflaseæ¥æ£€æŸ¥é€šé“æ˜¯å¦å…³é—­</p>
</blockquote>
<pre><code>v, ok := &lt;-ch
if !ok &#123;
   fmt.Println(&quot;&quot;)
   break
&#125;
</code></pre>
<h5 id="ç¼“å†²é€šé“"><a href="#ç¼“å†²é€šé“" class="headerlink" title="ç¼“å†²é€šé“"></a>ç¼“å†²é€šé“</h5><p><code>ch := make(chan type,  capacity)</code></p>
<h5 id="å®šå‘é€šé“"><a href="#å®šå‘é€šé“" class="headerlink" title="å®šå‘é€šé“"></a>å®šå‘é€šé“</h5><p><code>ch := make(chan &lt;- int)</code>:å•å‘é€šé“ åªå†™</p>
<p><code>ch := make(&lt;- chan int)</code>:å•å‘é€šé“ åªè¯»</p>
<h3 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h3><p>Goçš„åå°„é€šè¿‡ç©ºæ¥å£æ¥è¿›è¡Œçš„</p>
<p>(æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚)</p>
]]></content>
      <categories>
        <category>å¼€å‘è¯­è¨€</category>
      </categories>
      <tags>
        <tag>Golang</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginxå­¦ä¹ è®°å½•</title>
    <url>/2021/09/02/Web_nginx/</url>
    <content><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Nginxï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Nginxï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Nginxï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Nginxï¼Ÿ</h1><p>Nginx æ˜¯é«˜æ€§èƒ½çš„ HTTP å’Œåå‘ä»£ç†çš„webæœåŠ¡å™¨ï¼Œå¤„ç†é«˜å¹¶å‘èƒ½åŠ›æ˜¯ååˆ†å¼ºå¤§çš„ï¼Œèƒ½ç»å—é«˜è´Ÿè½½çš„è€ƒéªŒ,æœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾ 50,000 ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚</p>
<span id="more"></span>

<p>å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ä¹Ÿçœ‹åˆ°äº†å…³äºWebæœåŠ¡å™¨çš„ç»Ÿè®¡,Nginxå·²ç„¶æˆä¸ºä½¿ç”¨ç‡ç¬¬ä¸€çš„WebæœåŠ¡å™¨äº†</p>
<p><img src="/2021/09/02/Web_nginx/1.png"></p>
<p>å…¶ä¸­ï¼ŒNginxèƒ½åšçš„äº‹è€³ç†Ÿèƒ½è¯¦çš„å°±æœ‰åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€åŠ¨é™åˆ†ç¦»ç­‰</p>
<h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><p>æ—¢ç„¶Nginxè¢«ç§°ä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œ è®²åå‘ä»£ç†ä¹‹å‰å¯ä»¥ä»‹ç»ä¸€ä¸‹æ­£å‘ä»£ç†</p>
<h3 id="æ­£å‘ä»£ç†"><a href="#æ­£å‘ä»£ç†" class="headerlink" title="æ­£å‘ä»£ç†"></a>æ­£å‘ä»£ç†</h3><p><img src="/2021/09/02/Web_nginx/2.png"></p>
<h3 id="åå‘ä»£ç†-1"><a href="#åå‘ä»£ç†-1" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h3><p><img src="/2021/09/02/Web_nginx/3.png"><br>ä½¿ç”¨åå‘ä»£ç†æœ‰ä¸€äº›å¥½å¤„å¦‚ä¸‹:</p>
<ul>
<li><p>éšè—äº†èµ„æºæœåŠ¡å™¨çš„ipã€ç«¯å£å·ï¼Œä¸€å®šç¨‹åº¦ä¸Šä¿è¯äº†ä¸»æœºçš„å®‰å…¨</p>
</li>
<li><p>è¯·æ±‚é‡è¿‡å¤šçš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡åˆ†å‘è¯·æ±‚ç»™å¤šå°å…·æœ‰åŒæ ·èµ„æºçš„æœåŠ¡å™¨ï¼Œæé«˜äº†æ•ˆç‡çš„åŒæ—¶è¿˜ä¿è¯äº†ä¸€å®šçš„å®‰å…¨æ€§</p>
</li>
</ul>
<h2 id="Nginxé…ç½®æ–‡ä»¶"><a href="#Nginxé…ç½®æ–‡ä»¶" class="headerlink" title="Nginxé…ç½®æ–‡ä»¶"></a>Nginxé…ç½®æ–‡ä»¶</h2><p>Nginxçš„åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€åŠ¨é™åˆ†ç¦»ç­‰åŠŸèƒ½çš†æ˜¯é€šè¿‡ä¿®æ”¹<strong>é…ç½®æ–‡ä»¶</strong>æ¥å®ç°çš„<br>è¿™é‡Œä»‹ç»ä¸€ä¸‹<strong>é…ç½®æ–‡ä»¶</strong>çš„ç›¸å…³å†…å®¹<br>é…ç½®æ–‡ä»¶ä¸»è¦åŒ…å«</p>
<ul>
<li>å…¨å±€å—</li>
<li>eventså—</li>
<li>httpå—<ul>
<li>httpå—åˆåŒ…å«serverå—<ul>
<li>serverå—åˆåŒ…å«serverå…¨å±€å—å’Œlocationå—</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>worker_processes 4;  
... #å…¨å±€å—
events  #eventså—
&#123;
   ...
&#125;
http  #httpå—
&#123; 
   ...   #httpå…¨å±€å—
   server  #serverå— ç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿæœº
   &#123;
      ... #serverå…¨å±€å—
      location [Pattern]
      &#123;
         ...
      &#125;
   &#125;
   server
   &#123;
      ...
   &#125;
   ...
&#125;
</code></pre>
<h3 id="Nginxé…ç½®è´Ÿè½½å‡è¡¡"><a href="#Nginxé…ç½®è´Ÿè½½å‡è¡¡" class="headerlink" title="Nginxé…ç½®è´Ÿè½½å‡è¡¡"></a>Nginxé…ç½®è´Ÿè½½å‡è¡¡</h3><p><strong>è´Ÿè½½å‡è¡¡</strong>é€šè¿‡é…ç½®æ–‡ä»¶ä¸­çš„<code>upstreamæ¨¡å—</code>æ¥å®ç°å¯¹è¯·æ±‚çš„åˆ†å‘<br>å…¶ä¸­ï¼Œè´Ÿè½½å‡è¡¡æœ‰å‡ ç§åˆ†å‘ç­–ç•¥:</p>
<ul>
<li><p>è½®è¯¢</p>
<pre><code>upstream lunxun &#123;
      server xx.xxx.x.xxx:8080;
      server xx.xxx.x.xxx:8081;
  &#125;

  server &#123;
      listen 80;

      location / &#123;
          proxy_pass http://lunxun;
      &#125;
  &#125;
</code></pre>
<p>æ‰€æœ‰è¯·æ±‚è½®æµå‘é€è‡³ä¸¤å°æœåŠ¡å™¨å¯¹åº”çš„ç«¯å£ä¸­</p>
</li>
<li><p>åŠ æƒè½®è¯¢</p>
<pre><code>upstream quanzhong &#123;
      server xx.xxx.x.xxx:8080 weight=1; 
      server xx.xxx.x.xxx:8081 weight=2;
  &#125;

  server &#123;
      listen 80;

      location / &#123;
          proxy_pass http://quanzhong;
      &#125;
  &#125;
</code></pre>
<p>è¯·æ±‚æ ¹æ®æƒé‡åˆ†å‘ç»™ä¸åŒæœåŠ¡å™¨ï¼Œä¸¾ä¾‹:å…­ä¸ªè¯·æ±‚åˆ†å‘4ä¸ªç»™weight=2çš„æœåŠ¡å™¨,åˆ†å‘2ä¸ªç»™weight=1çš„æœåŠ¡å™¨</p>
</li>
<li><p>æºåœ°å€å“ˆå¸Œ(æ–°ç‰ˆæœ¬çš„Nginxä¸­å·²ç»é›†æˆ)</p>
<pre><code>upstream url_hash &#123;
      ip_hash;
      server xx.xxx.x.xxx:8080; 
      server xx.xxx.x.xxx:8081;
  &#125;

  server &#123;
      listen 80;

      location / &#123;
          proxy_pass http://url_hash;
      &#125;
  &#125;
</code></pre>
<p>å°†è®¿é—®ç”¨æˆ·çš„ipè¿›è¡Œå“ˆå¸Œåçš„ç»“æœè¿›è¡Œåˆ†é…ï¼Œæ¯ä¸ªç”¨æˆ·å®šå‘è®¿é—®åˆ°ä¸€ä¸ªæœåŠ¡å™¨ä¸­</p>
<blockquote>
<p>æ³¨æ„</p>
<blockquote>
<p>é…ç½®ä¸­NginxæœåŠ¡å™¨åº”å¤„äºæœ€å‰ç«¯çš„æœåŠ¡å™¨ï¼Œè¿™æ ·æ‰èƒ½è·å–ç”¨æˆ·çš„ipåœ°å€ï¼Œå¦åˆ™è·å–çš„æ˜¯å‰ä¸€ä¸ªæœåŠ¡å™¨çš„åœ°å€</p>
</blockquote>
<blockquote>
<p>ip_hash åä¸èƒ½é…ç½®weight(æƒé‡)</p>
</blockquote>
<blockquote>
<p>å½“ç”¨æˆ·å›ºå®šè®¿é—®çš„æœåŠ¡å™¨å¤„äº(down)æ—¶ï¼Œå®¢æˆ·ç«¯æ‰ä¼šè¢«ä¸‹ä¸€ä¸ªæœåŠ¡å™¨æ¥å—</p>
</blockquote>
</blockquote>
</li>
<li><p>ç¬¬ä¸‰æ–¹è°ƒåº¦ç®—æ³•(ä¸¾ä¾‹)</p>
<pre><code>upstream fair &#123;
      fair;
      server xx.xxx.x.xxx:8080; 
      server xx.xxx.x.xxx:8081;
  &#125;

  server &#123;
      listen 80;

      location / &#123;
          proxy_pass http://url_hash;
      &#125;
  &#125;
</code></pre>
<p>fairï¼šç”¨äºä¸ºå“åº”æ—¶é—´åˆ†é…æœåŠ¡å™¨ç»„å†…çš„æœåŠ¡å™¨ï¼Œä»–æ˜¯æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´è¶ŠçŸ­çš„è¶Šä¼˜å…ˆåˆ†é…ï¼Œéœ€è¦ç¬¬ä¸‰æ–¹æ¨¡å—çš„æ”¯æŒ<code>nginx-upstream-fair-master</code></p>
</li>
</ul>
<blockquote>
<p>å¦‚æœæƒ³äº†è§£æ›´å¤šå…³äºé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œå¯ä»¥æŸ¥é˜…Nginxå®˜æ–¹ä¸­æ–‡æ–‡æ¡£<br><a href="https://www.nginx.cn/doc/index.html">https://www.nginx.cn/doc/index.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>Cookieã€Sessionå­¦ä¹ è®°å½•</title>
    <url>/2021/08/30/Web_cookie_session/</url>
    <content><![CDATA[<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><ul>
<li>Cookie ç¿»è¯‘è¿‡æ¥æ˜¯é¥¼å¹²çš„æ„æ€ã€‚</li>
<li>Cookie æ˜¯æœåŠ¡å™¨é€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜é”®å€¼å¯¹çš„ä¸€ç§æŠ€æœ¯ã€‚</li>
<li>å®¢æˆ·ç«¯æœ‰äº† Cookie åï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘é€ç»™æœåŠ¡å™¨ã€‚</li>
<li>æ¯ä¸ª Cookie çš„å¤§å°ä¸èƒ½è¶…è¿‡ 4kb</li>
</ul>
<span id="more"></span>

<hr>
<h3 id="å¦‚ä½•åˆ›å»º-Cookie"><a href="#å¦‚ä½•åˆ›å»º-Cookie" class="headerlink" title="å¦‚ä½•åˆ›å»º Cookie"></a>å¦‚ä½•åˆ›å»º Cookie</h3><p>åˆ›å»ºä¸€ä¸ª Cookie å¯ä»¥é€šè¿‡<code>respone.addcookie(cookie)</code>æ¥åˆ›å»º</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸€ä¸ª Cookie çš„åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹:</p>
<p><img src="/2021/08/30/Web_cookie_session/13.jpg"></p>
<hr>
<h3 id="æœåŠ¡å™¨å¦‚ä½•è·å–-Cookie"><a href="#æœåŠ¡å™¨å¦‚ä½•è·å–-Cookie" class="headerlink" title="æœåŠ¡å™¨å¦‚ä½•è·å– Cookie"></a>æœåŠ¡å™¨å¦‚ä½•è·å– Cookie</h3><p>æœåŠ¡å™¨è·å–å®¢æˆ·ç«¯çš„ Cookie åªéœ€è¦ä¸€è¡Œä»£ç ï¼š<code>request.getCookies()</code></p>
<p>å…¶ä¸­<code>request.getCookies()</code>è·å–çš„æ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„ Cookie æ•°ç»„ï¼Œå³æ˜¯<strong>å…¨éƒ¨</strong>Cookie</p>
<p>å…¶åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹:</p>
<p><img src="/2021/08/30/Web_cookie_session/14.jpg"></p>
<hr>
<h3 id="Cookie-å€¼çš„ä¿®æ”¹"><a href="#Cookie-å€¼çš„ä¿®æ”¹" class="headerlink" title="Cookie å€¼çš„ä¿®æ”¹"></a>Cookie å€¼çš„ä¿®æ”¹</h3><ul>
<li>æ–¹æ¡ˆä¸€ï¼š</li>
</ul>
<p>1ã€å…ˆåˆ›å»ºä¸€ä¸ªè¦ä¿®æ”¹çš„åŒåï¼ˆæŒ‡çš„å°±æ˜¯ keyï¼‰çš„ Cookie å¯¹è±¡</p>
<p>2ã€åœ¨æ„é€ å™¨ï¼ŒåŒæ—¶èµ‹äº<strong>æ–°çš„</strong>Cookie å€¼ã€‚</p>
<pre><code class="java">Cookie cookie = new Cookie(&quot;key1&quot;,&quot;newValue1&quot;);
</code></pre>
<p>3ã€è°ƒç”¨<code>response.addCookie(Cookie)</code>;</p>
<ul>
<li>æ–¹æ¡ˆäºŒï¼š</li>
</ul>
<p>1ã€å…ˆæŸ¥æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„ Cookie å¯¹è±¡</p>
<p>2ã€è°ƒç”¨<code>setValue()</code>æ–¹æ³•èµ‹äºæ–°çš„ Cookie å€¼ã€‚</p>
<pre><code class="java">cookie.setValue(&quot;newValue2&quot;);
</code></pre>
<p>3ã€è°ƒç”¨<code>response.addCookie()</code>é€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜ä¿®æ”¹</p>
<blockquote>
<p>åŒºåˆ«:</p>
</blockquote>
<blockquote>
<ul>
<li>æ–¹æ¡ˆä¸€æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„åŒå Cookie æ¥è¦†ç›–æ‰åŸæ¥ Cookie</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>æ–¹æ¡ˆäºŒæ˜¯ç›´æ¥ä¿®æ”¹éœ€è¦ä¿®æ”¹çš„ Cookie å€¼</li>
</ul>
</blockquote>
<hr>
<h3 id="æµè§ˆå™¨æŸ¥çœ‹-Cookie"><a href="#æµè§ˆå™¨æŸ¥çœ‹-Cookie" class="headerlink" title="æµè§ˆå™¨æŸ¥çœ‹ Cookie"></a>æµè§ˆå™¨æŸ¥çœ‹ Cookie</h3><ul>
<li>è°·æ­Œæµè§ˆå™¨æŸ¥çœ‹ Cookie</li>
</ul>
<p><img src="/2021/08/30/Web_cookie_session/15.jpg"></p>
<ul>
<li>ç«ç‹æµè§ˆå™¨æŸ¥çœ‹ Cookie</li>
</ul>
<p><img src="/2021/08/30/Web_cookie_session/16.jpg"></p>
<hr>
<h3 id="Cookie-çš„ç”Ÿå‘½æ§åˆ¶"><a href="#Cookie-çš„ç”Ÿå‘½æ§åˆ¶" class="headerlink" title="Cookie çš„ç”Ÿå‘½æ§åˆ¶"></a>Cookie çš„ç”Ÿå‘½æ§åˆ¶</h3><ul>
<li><p>Cookie çš„ç”Ÿå‘½æ§åˆ¶æŒ‡çš„æ˜¯å¦‚ä½•ç®¡ç† Cookie ä»€ä¹ˆæ—¶å€™è¢«é”€æ¯ï¼ˆåˆ é™¤ï¼‰</p>
</li>
<li><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>setMaxAge()</code>æ¥è®¾ç½® Cookie çš„ç”Ÿå‘½æ§åˆ¶</p>
</li>
</ul>
<p><code>setMaxAge(æ­£æ•°)</code>ï¼Œè¡¨ç¤ºåœ¨æŒ‡å®šçš„ç§’æ•°åè¿‡æœŸ</p>
<p><code>setMaxAge(è´Ÿæ•°)</code>ï¼Œè¡¨ç¤ºæµè§ˆå™¨ä¸€å…³ï¼ŒCookie å°±ä¼šè¢«åˆ é™¤ï¼ˆé»˜è®¤å€¼æ˜¯-1ï¼‰</p>
<p><code>setMaxAge(0)</code>ï¼Œè¡¨ç¤ºé©¬ä¸Šåˆ é™¤ Cookie</p>
<ul>
<li>å…¶ä¸­ï¼ŒCookie çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥åœ¨æµè§ˆå™¨é‡ŒæŸ¥çœ‹</li>
</ul>
<p><img src="/2021/08/30/Web_cookie_session/17.png"></p>
<hr>
<h3 id="Cookie-æœ‰æ•ˆè·¯å¾„-Path-çš„è®¾ç½®"><a href="#Cookie-æœ‰æ•ˆè·¯å¾„-Path-çš„è®¾ç½®" class="headerlink" title="Cookie æœ‰æ•ˆè·¯å¾„ Path çš„è®¾ç½®"></a>Cookie æœ‰æ•ˆè·¯å¾„ Path çš„è®¾ç½®</h3><ul>
<li><p>Cookie çš„ path å±æ€§å¯ä»¥æœ‰æ•ˆçš„è¿‡æ»¤å“ªäº› Cookie å¯ä»¥å‘é€ç»™æœåŠ¡å™¨ã€‚å“ªäº›ä¸å‘ã€‚</p>
</li>
<li><p>path å±æ€§æ˜¯é€šè¿‡è¯·æ±‚çš„åœ°å€æ¥è¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ã€‚</p>
</li>
<li><p><code>getContextPath()</code> ===&gt;&gt;&gt;&gt; å¾—åˆ°å·¥ç¨‹è·¯å¾„</p>
</li>
</ul>
<p><img src="/2021/08/30/Web_cookie_session/18.png"></p>
<ul>
<li>ä»£ç å¦‚ä¸‹:</li>
</ul>
<pre><code class="java">cookie.setPath( req.getContextPath() + &quot;/abc&quot; );
</code></pre>
<hr>
<h3 id="Cookie-éªŒè¯ç™»å½•çš„ä¸€ä¸ªç®€å•æµç¨‹"><a href="#Cookie-éªŒè¯ç™»å½•çš„ä¸€ä¸ªç®€å•æµç¨‹" class="headerlink" title="Cookie éªŒè¯ç™»å½•çš„ä¸€ä¸ªç®€å•æµç¨‹"></a>Cookie éªŒè¯ç™»å½•çš„ä¸€ä¸ªç®€å•æµç¨‹</h3><p><img src="/2021/08/30/Web_cookie_session/19.jpg"></p>
<blockquote>
<h2 id="Session-ä¼šè¯"><a href="#Session-ä¼šè¯" class="headerlink" title="Session ä¼šè¯"></a>Session ä¼šè¯</h2></blockquote>
<hr>
<h3 id="ä»€ä¹ˆæ˜¯-Session-ä¼šè¯"><a href="#ä»€ä¹ˆæ˜¯-Session-ä¼šè¯" class="headerlink" title="ä»€ä¹ˆæ˜¯ Session ä¼šè¯?"></a>ä»€ä¹ˆæ˜¯ Session ä¼šè¯?</h3><ul>
<li>Session å°±ä¸€ä¸ªæ¥å£ï¼ˆHttpSessionï¼‰ã€‚</li>
<li>Session å°±æ˜¯ä¼šè¯ã€‚å®ƒæ˜¯ç”¨æ¥ç»´æŠ¤ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å…³è”çš„ä¸€ç§æŠ€æœ¯ã€‚</li>
<li>æ¯ä¸ªå®¢æˆ·ç«¯éƒ½æœ‰è‡ªå·±çš„ä¸€ä¸ª Session ä¼šè¯ã€‚</li>
<li>Session ä¼šè¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨æ¥ä¿å­˜ç”¨æˆ·ç™»å½•ä¹‹åçš„ä¿¡æ¯ã€‚</li>
</ul>
<hr>
<h3 id="å¦‚ä½•åˆ›å»º-Session-å’Œè·å–-id-å·-æ˜¯å¦ä¸ºæ–°"><a href="#å¦‚ä½•åˆ›å»º-Session-å’Œè·å–-id-å·-æ˜¯å¦ä¸ºæ–°" class="headerlink" title="å¦‚ä½•åˆ›å»º Session å’Œè·å–(id å·,æ˜¯å¦ä¸ºæ–°)"></a>å¦‚ä½•åˆ›å»º Session å’Œè·å–(id å·,æ˜¯å¦ä¸ºæ–°)</h3><p>å¦‚ä½•åˆ›å»ºå’Œè·å– Sessionã€‚å®ƒä»¬çš„ API æ˜¯ä¸€æ ·çš„ã€‚</p>
<ul>
<li><code>request.getSession()</code></li>
</ul>
<p>ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯ï¼šåˆ›å»º Session ä¼šè¯</p>
<p>ä¹‹åè°ƒç”¨éƒ½æ˜¯ï¼šè·å–å‰é¢åˆ›å»ºå¥½çš„ Session ä¼šè¯å¯¹è±¡ã€‚ï¼ˆå•ä¾‹æ¨¡å¼ï¼Ÿï¼‰</p>
<ul>
<li><code>isNew()</code>; åˆ¤æ–­åˆ°åº•æ˜¯ä¸æ˜¯åˆšåˆ›å»ºå‡ºæ¥çš„ï¼ˆæ–°çš„ï¼‰</li>
</ul>
<p><strong>true</strong>è¡¨ç¤ºåˆšåˆ›å»º</p>
<p><strong>false</strong>è¡¨ç¤ºè·å–ä¹‹å‰åˆ›å»º</p>
<ul>
<li><code>getId()</code> å¾—åˆ° Session çš„ä¼šè¯ id å€¼ã€‚</li>
</ul>
<p>æ¯ä¸ªä¼šè¯éƒ½æœ‰ä¸€ä¸ªèº«ä»½è¯å·ã€‚ä¹Ÿå°±æ˜¯ ID å€¼ã€‚è€Œä¸”è¿™ä¸ª ID æ˜¯å”¯ä¸€çš„ã€‚</p>
<hr>
<h3 id="Session-åŸŸæ•°æ®çš„å­˜å–"><a href="#Session-åŸŸæ•°æ®çš„å­˜å–" class="headerlink" title="Session åŸŸæ•°æ®çš„å­˜å–"></a>Session åŸŸæ•°æ®çš„å­˜å–</h3><p><code>setAttribute()</code>è®¾ç½®å½“å‰ Session çš„åŸŸæ•°æ®</p>
<p><code>getAttribute()</code>è·å–å½“å‰ Session çš„åŸŸæ•°æ®</p>
<pre><code class="java">req.getSession().setAttribute(&quot;key1&quot;, &quot;value1&quot;);
req.getSession().getAttribute(&quot;key1&quot;);
</code></pre>
<h3 id="Session-ç”Ÿå‘½å‘¨æœŸæ§åˆ¶"><a href="#Session-ç”Ÿå‘½å‘¨æœŸæ§åˆ¶" class="headerlink" title="Session ç”Ÿå‘½å‘¨æœŸæ§åˆ¶"></a>Session ç”Ÿå‘½å‘¨æœŸæ§åˆ¶</h3><ul>
<li><code>session.setMaxInactiveInterval(int interval)</code></li>
</ul>
<p>è®¾ç½® Session çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼Œè¶…è¿‡æŒ‡å®šçš„æ—¶é•¿ï¼ŒSession å°±ä¼šè¢«é”€æ¯ã€‚</p>
<p>å€¼ä¸º<strong>æ­£æ•°</strong>çš„æ—¶å€™ï¼Œè®¾å®š Session çš„è¶…æ—¶æ—¶é•¿ã€‚</p>
<p><strong>è´Ÿæ•°</strong>è¡¨ç¤ºæ°¸ä¸è¶…æ—¶ï¼ˆæå°‘ä½¿ç”¨ï¼‰</p>
<ul>
<li><code>getMaxInactiveInterval()</code>è·å– Session çš„è¶…æ—¶æ—¶é—´</li>
<li><code>session.invalidate()</code> è®©å½“å‰ Session ä¼šè¯é©¬ä¸Šè¶…æ—¶æ— æ•ˆã€‚</li>
</ul>
<p>!&gt;Session é»˜è®¤çš„è¶…æ—¶æ—¶é—´é•¿ä¸º 30 åˆ†é’Ÿã€‚</p>
<hr>
<h3 id="æµè§ˆå™¨å’Œ-Session-å…³è”çš„å†…å¹•"><a href="#æµè§ˆå™¨å’Œ-Session-å…³è”çš„å†…å¹•" class="headerlink" title="æµè§ˆå™¨å’Œ Session å…³è”çš„å†…å¹•"></a>æµè§ˆå™¨å’Œ Session å…³è”çš„å†…å¹•</h3><p>Session æŠ€æœ¯ï¼Œåº•å±‚å…¶å®æ˜¯åŸºäº Cookie æŠ€æœ¯æ¥å®ç°çš„ã€‚</p>
<p><img src="/2021/08/30/Web_cookie_session/20.jpg"></p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Cookieã€Session</tag>
      </tags>
  </entry>
  <entry>
    <title>Filterå­¦ä¹ è®°å½•</title>
    <url>/2021/08/30/Web_filter/</url>
    <content><![CDATA[<h1 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h1><ul>
<li><p>Filterè¿‡æ»¤å™¨å®ƒæ˜¯JavaWebçš„ä¸‰å¤§ç»„ä»¶ä¹‹ä¸€ã€‚ ä¸‰å¤§ç»„ä»¶åˆ†åˆ«æ˜¯ï¼š<strong>Servlet</strong>ç¨‹åºã€<strong>Listener</strong>ç›‘å¬å™¨ã€<strong>Filter</strong>è¿‡æ»¤å™¨</p>
</li>
<li><p>Filterè¿‡æ»¤å™¨å®ƒæ˜¯JavaEEçš„è§„èŒƒ,ä¹Ÿå°±æ˜¯æ¥å£ã€‚</p>
</li>
<li><p>Filterè¿‡æ»¤å™¨å®ƒçš„ä½œç”¨æ˜¯ï¼š<strong>æ‹¦æˆªè¯·æ±‚</strong>ï¼Œ<strong>è¿‡æ»¤å“åº”</strong>ã€‚</p>
</li>
<li><p>æ‹¦æˆªè¯·æ±‚å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰ï¼š<br>æƒé™æ£€æŸ¥,æ—¥è®°æ“ä½œ,äº‹åŠ¡ç®¡ç†ç­‰</p>
</li>
</ul>
<span id="more"></span>

<p>Filterçš„ä¸€ä¸ªå¤§è‡´åŠŸèƒ½å¦‚ä¸‹å›¾:<br><img src="/2021/08/30/Web_filter/21.jpg"></p>
<h2 id="Filter-çš„ä½“éªŒ"><a href="#Filter-çš„ä½“éªŒ" class="headerlink" title="Filter çš„ä½“éªŒ"></a>Filter çš„ä½“éªŒ</h2><p>Filterè¿‡æ»¤å™¨çš„ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ul>
<li><p>ç¼–å†™ä¸€ä¸ªç±»å»å®ç°Filteræ¥å£</p>
</li>
<li><p>å®ç°è¿‡æ»¤æ–¹æ³•<code>doFilter()</code></p>
</li>
<li><p>åˆ°web.xmlä¸­å»é…ç½®Filterçš„æ‹¦æˆªè·¯å¾„</p>
</li>
</ul>
<h2 id="Filter-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Filter-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Filter çš„ç”Ÿå‘½å‘¨æœŸ"></a>Filter çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>Filterçš„ç”Ÿå‘½å‘¨æœŸåŒ…å«å‡ ä¸ªæ–¹æ³•</p>
<ul>
<li><strong>æ„é€ å™¨æ–¹æ³•</strong></li>
</ul>
<pre><code class="java">  public Filter() &#123;

  &#125;
</code></pre>
<ul>
<li><strong>initåˆå§‹åŒ–æ–¹æ³•</strong></li>
</ul>
<pre><code class="java">public void init(FilterConfig filterConfig) throws ServletException &#123;

    &#125;
</code></pre>
<p>ç¬¬1ï¼Œ2æ­¥ï¼Œåœ¨web å·¥ç¨‹å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œï¼ˆFilter å·²ç»åˆ›å»ºï¼‰</p>
<ul>
<li><strong>doFilterè¿‡æ»¤æ–¹æ³•</strong></li>
</ul>
<pre><code class="java">public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;

        &#125;
</code></pre>
<p>ç¬¬3æ­¥ï¼Œæ¯æ¬¡æ‹¦æˆªåˆ°è¯·æ±‚ï¼Œå°±ä¼šæ‰§è¡Œ</p>
<ul>
<li><strong>destroyé”€æ¯</strong></li>
</ul>
<pre><code class="java">  public void destroy() &#123;

  &#125;
</code></pre>
<p>ç¬¬4æ­¥ï¼Œåœæ­¢webå·¥ç¨‹çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œï¼ˆåœæ­¢web å·¥ç¨‹ï¼Œä¹Ÿä¼šé”€æ¯Filter è¿‡æ»¤å™¨ï¼‰</p>
<h2 id="FilterConfig-ç±»"><a href="#FilterConfig-ç±»" class="headerlink" title="FilterConfig ç±»"></a>FilterConfig ç±»</h2><p><strong>FilterConfig</strong>ç±»è§åçŸ¥ä¹‰ï¼Œå®ƒæ˜¯Filterè¿‡æ»¤å™¨çš„<strong>é…ç½®æ–‡ä»¶ç±»</strong>ã€‚</p>
<p>Tomcatæ¯æ¬¡åˆ›å»ºFilterçš„æ—¶å€™ï¼Œä¹Ÿä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ª<strong>FilterConfig</strong>ç±»ï¼Œè¿™é‡ŒåŒ…å«äº†Filteré…ç½®æ–‡ä»¶çš„é…ç½®ä¿¡æ¯ã€‚</p>
<p><strong>FilterConfig</strong>ç±»çš„ä½œç”¨æ˜¯è·å–filterè¿‡æ»¤å™¨çš„é…ç½®å†…å®¹</p>
<ul>
<li><p>è·å–Filterçš„åç§°<code>filter-name</code>çš„å†…å®¹</p>
</li>
<li><p>è·å–åœ¨Filterä¸­é…ç½®çš„<code>init-param</code>åˆå§‹åŒ–å‚æ•°</p>
</li>
<li><p>è·å–<code>ServletContext</code>å¯¹è±¡</p>
</li>
</ul>
<h3 id="FilterChain-è¿‡æ»¤å™¨é“¾"><a href="#FilterChain-è¿‡æ»¤å™¨é“¾" class="headerlink" title="FilterChain è¿‡æ»¤å™¨é“¾"></a>FilterChain è¿‡æ»¤å™¨é“¾</h3><blockquote>
<p>FilterChain å°±æ˜¯è¿‡æ»¤å™¨é“¾ï¼ˆå¤šä¸ªè¿‡æ»¤å™¨å¦‚ä½•ä¸€èµ·å·¥ä½œï¼‰</p>
</blockquote>
<p><img src="/2021/08/30/Web_filter/22.jpg"></p>
<p>å½“è®¿é—®ç›®æ ‡èµ„æºæ—¶ï¼Œæ§åˆ¶å°å¾—åˆ°çš„ä¿¡æ¯å¦‚ä¸‹:</p>
<p><img src="/2021/08/30/Web_filter/23.png"></p>
<p>å¯ä»¥çŸ¥é“FilterChainæœ‰å¦‚å›¾ä¸€çš„æ€§è´¨ã€‚</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Filter</tag>
      </tags>
  </entry>
  <entry>
    <title>Servletå­¦ä¹ è®°å½•</title>
    <url>/2021/08/30/Web_servlet/</url>
    <content><![CDATA[<h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><p> <strong>Servlet</strong> æ˜¯è¿è¡Œåœ¨ Web æœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œ</p>
<p>å®ƒæ˜¯ä½œä¸ºæ¥è‡ª Web æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯çš„è¯·æ±‚å’Œ HTTP æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ã€‚</p>
<span id="more"></span>

<blockquote>
<h2 id="ServletæŠ€æœ¯"><a href="#ServletæŠ€æœ¯" class="headerlink" title="ServletæŠ€æœ¯"></a>ServletæŠ€æœ¯</h2></blockquote>
<hr>
<h3 id="ä»€ä¹ˆæ˜¯Servlet"><a href="#ä»€ä¹ˆæ˜¯Servlet" class="headerlink" title="ä»€ä¹ˆæ˜¯Servlet"></a>ä»€ä¹ˆæ˜¯Servlet</h3><ul>
<li><p><strong>Servlet</strong>æ˜¯JavaEEè§„èŒƒä¹‹ä¸€ï¼Œè§„èŒƒå°±æ˜¯æ¥å£ã€‚</p>
</li>
<li><p><strong>Servlet</strong>å°±JavaWebä¸‰å¤§ç»„ä»¶ä¹‹ä¸€ã€‚ä¸‰å¤§ç»„ä»¶åˆ†åˆ«æ˜¯ï¼š<strong>Servlet</strong>ç¨‹åºã€<strong>Filter</strong>è¿‡æ»¤å™¨ã€<strong>Listener</strong>ç›‘å¬å™¨ã€‚</p>
</li>
<li><p><strong>Servlet</strong>æ˜¯è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªjavaå°ç¨‹åºï¼Œå®ƒå¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¹¶å“åº”æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚</p>
</li>
</ul>
<hr>
<h3 id="ç®€å•å®ç°ä¸€ä¸ªServletç¨‹åº"><a href="#ç®€å•å®ç°ä¸€ä¸ªServletç¨‹åº" class="headerlink" title="ç®€å•å®ç°ä¸€ä¸ªServletç¨‹åº"></a>ç®€å•å®ç°ä¸€ä¸ªServletç¨‹åº</h3><p>(å®ç°å‰éœ€é…ç½®å¥½Tomcatï¼Œè¿™é‡Œä¸åšèµ˜è¿°)</p>
<p>1ã€ç¼–å†™ä¸€ä¸ªç±»å»å®ç°<strong>Servlet</strong>æ¥å£</p>
<p>å®ç°<strong>service</strong>æ–¹æ³•ï¼Œå¤„ç†è¯·æ±‚ï¼Œå¹¶å“åº”æ•°æ®</p>
<pre><code class="java">public class HelloServlet implements Servlet &#123;
/**
* service æ–¹æ³•æ˜¯ä¸“é—¨ç”¨æ¥å¤„ç†è¯·æ±‚å’Œå“åº”çš„
* @param servletRequest
* @param servletResponse
* @throws ServletException
* @throws IOException
  */
  @Override
  public void service(ServletRequest servletRequest, ServletResponse servletResponse) 
          throws ServletException, IOException &#123; 
      System.out.println(&quot;Hello Servlet è¢«è®¿é—®äº†&quot;);
  &#125;
&#125;
</code></pre>
<p>2ã€åˆ°web.xmlä¸­å»é…ç½®servletç¨‹åºçš„è®¿é—®åœ°å€</p>
<pre><code class="xml">
&lt;!-- servlet æ ‡ç­¾ç»™Tomcat é…ç½®Servlet ç¨‹åº--&gt;
&lt;servlet&gt;
    &lt;!--servlet-name æ ‡ç­¾Servlet ç¨‹åºèµ·ä¸€ä¸ªåˆ«åï¼ˆä¸€èˆ¬æ˜¯ç±»åï¼‰ --&gt;
    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
    &lt;!--servlet-class æ˜¯Servlet ç¨‹åºçš„å…¨ç±»å--&gt;
    &lt;servlet-class&gt;com.zhiguo.servlet.HelloServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;!--servlet-mapping æ ‡ç­¾ç»™servlet ç¨‹åºé…ç½®è®¿é—®åœ°å€--&gt;
&lt;servlet-mapping&gt;
    &lt;!--servlet-name æ ‡ç­¾çš„ä½œç”¨æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘å½“å‰é…ç½®çš„åœ°å€ç»™å“ªä¸ªServlet ç¨‹åºä½¿ç”¨--&gt;
    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
    &lt;!--url-pattern æ ‡ç­¾é…ç½®è®¿é—®åœ°å€&lt;br/&gt;
        / æ–œæ åœ¨æœåŠ¡å™¨è§£æçš„æ—¶å€™ï¼Œè¡¨ç¤ºåœ°å€ä¸ºï¼šhttp://ip:port/å·¥ç¨‹è·¯å¾„&lt;br/&gt;
        /hello è¡¨ç¤ºåœ°å€ä¸ºï¼šhttp://ip:port/å·¥ç¨‹è·¯å¾„/hello &lt;br/&gt;
        --&gt;
    &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre>
<hr>
<h3 id="url-åœ°å€åˆ°-Servlet-ç¨‹åºçš„è®¿é—®"><a href="#url-åœ°å€åˆ°-Servlet-ç¨‹åºçš„è®¿é—®" class="headerlink" title="url åœ°å€åˆ° Servlet ç¨‹åºçš„è®¿é—®"></a>url åœ°å€åˆ° Servlet ç¨‹åºçš„è®¿é—®</h3><p><img src="/2021/08/30/Web_servlet/2.jpg"></p>
<hr>
<h3 id="Servlet-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Servlet-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Servlet çš„ç”Ÿå‘½å‘¨æœŸ"></a>Servlet çš„ç”Ÿå‘½å‘¨æœŸ</h3><ul>
<li>æ‰§è¡Œ<strong>Servletæ„é€ å™¨æ–¹æ³•</strong><pre><code class="java">public HellowServlet() &#123;

&#125;
</code></pre>
å…¶ä¸­<code>HellowServlet</code>ä¸ºç±»å</li>
</ul>
<ul>
<li><p>æ‰§è¡Œ<strong>initåˆå§‹åŒ–æ–¹æ³•</strong><br>(æ‰§è¡Œæ„é€ å™¨å’Œåˆå§‹åŒ–æ–¹æ³•æ˜¯åœ¨ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™åˆ›å»º Servlet ç¨‹åºä¼šè°ƒç”¨ã€‚)</p>
<pre><code class="java">  public void init(ServletConfig servletConfig) throws ServletException &#123;

  &#125;
</code></pre>
</li>
</ul>
<ul>
<li><p>æ‰§è¡Œ<strong>Serviceæ–¹æ³•</strong><br>(æ‰§è¡ŒServletæ–¹æ³•æ¯æ¬¡è®¿é—®éƒ½ä¼šè°ƒç”¨ã€‚)</p>
<pre><code class="java">public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws ServletException, IOException &#123;

      &#125;
</code></pre>
</li>
</ul>
<ul>
<li><p>æ‰§è¡Œ<strong>destroyé”€æ¯æ–¹æ³•</strong><br>(é”€æ¯æ–¹æ³•ï¼Œåœ¨webå·¥ç¨‹åœæ­¢çš„æ—¶å€™è°ƒç”¨ã€‚)</p>
<pre><code class="java">public void destroy() &#123;

      &#125;
</code></pre>
</li>
</ul>
<hr>
<h3 id="é€šè¿‡ç»§æ‰¿-HttpServlet-å®ç°Servlet-ç¨‹åº"><a href="#é€šè¿‡ç»§æ‰¿-HttpServlet-å®ç°Servlet-ç¨‹åº" class="headerlink" title="é€šè¿‡ç»§æ‰¿ HttpServlet å®ç°Servlet ç¨‹åº"></a>é€šè¿‡ç»§æ‰¿ HttpServlet å®ç°Servlet ç¨‹åº</h3><p>ä¸€èˆ¬åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œéƒ½æ˜¯ä½¿ç”¨ç»§æ‰¿<strong>HttpServlet</strong>ç±»çš„æ–¹å¼å»å®ç°<strong>Servlet</strong>ç¨‹åºã€‚</p>
<p>1ã€ç¼–å†™ä¸€ä¸ªç±»å»ç»§æ‰¿<strong>HttpServlet</strong>ç±»</p>
<p>2ã€æ ¹æ®ä¸šåŠ¡éœ€è¦é‡å†™<code>doGet</code>æˆ–<code>doPost</code>æ–¹æ³•</p>
<pre><code class="java">public class HelloServlet2 extends HttpServlet &#123;
/**
* doGetï¼ˆï¼‰åœ¨get è¯·æ±‚çš„æ—¶å€™è°ƒç”¨
* @param req
* @param resp
* @throws ServletException
* @throws IOException
  */
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException,
  IOException &#123; 
      System.out.println(&quot;HelloServlet2 çš„doGet æ–¹æ³•&quot;);
  &#125;
  /**
* doPostï¼ˆï¼‰åœ¨post è¯·æ±‚çš„æ—¶å€™è°ƒç”¨
* @param req
* @param resp
* @throws ServletException
* @throws IOException
  */
  @Override
  protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException,
  IOException &#123; 
      System.out.println(&quot;HelloServlet2 çš„doPost æ–¹æ³•&quot;);
  &#125;
&#125;
</code></pre>
<p>3ã€åˆ°web.xmlä¸­é…ç½®Servletç¨‹åºçš„è®¿é—®åœ°å€</p>
<pre><code class="xml">&lt;servlet&gt;
    &lt;servlet-name&gt;HelloServlet2&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.zhiguo.servlet.HelloServlet2&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;HelloServlet2&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/hello2&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre>
<hr>
<h3 id="Servlet-ç±»çš„ç»§æ‰¿ä½“ç³»"><a href="#Servlet-ç±»çš„ç»§æ‰¿ä½“ç³»" class="headerlink" title="Servlet ç±»çš„ç»§æ‰¿ä½“ç³»"></a>Servlet ç±»çš„ç»§æ‰¿ä½“ç³»</h3><p><img src="/2021/08/30/Web_servlet/3.jpg"></p>
<blockquote>
<h2 id="ServletConfig-ç±»"><a href="#ServletConfig-ç±»" class="headerlink" title="ServletConfig ç±»"></a>ServletConfig ç±»</h2></blockquote>
<hr>
<h3 id="ä»€ä¹ˆæ˜¯ServletConfig-ç±»"><a href="#ä»€ä¹ˆæ˜¯ServletConfig-ç±»" class="headerlink" title="ä»€ä¹ˆæ˜¯ServletConfig ç±»"></a>ä»€ä¹ˆæ˜¯ServletConfig ç±»</h3><p><strong>Servlet</strong>ç¨‹åºå’Œ<strong>ServletConfig</strong>å¯¹è±¡éƒ½æ˜¯ç”±<strong>Tomcat</strong>è´Ÿè´£åˆ›å»ºï¼Œæˆ‘ä»¬è´Ÿè´£ä½¿ç”¨ã€‚</p>
<p><strong>Servlet</strong>ç¨‹åºé»˜è®¤æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™åˆ›å»ºï¼Œ<strong>ServletConfig</strong>æ˜¯æ¯ä¸ª<strong>Servlet</strong>ç¨‹åºåˆ›å»ºæ—¶ï¼Œ<br>å°±åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„<strong>ServletConfig</strong>å¯¹è±¡ã€‚</p>
<hr>
<h3 id="ServletConfig-ç±»çš„ä¸‰å¤§ä½œç”¨"><a href="#ServletConfig-ç±»çš„ä¸‰å¤§ä½œç”¨" class="headerlink" title="ServletConfig ç±»çš„ä¸‰å¤§ä½œç”¨"></a>ServletConfig ç±»çš„ä¸‰å¤§ä½œç”¨</h3><ul>
<li><p>å¯ä»¥è·å–Servlet ç¨‹åºçš„åˆ«å<code>servlet-name</code>çš„å€¼</p>
</li>
<li><p>è·å–åˆå§‹åŒ–å‚æ•°<code>init-param</code></p>
</li>
<li><p>è·å–<strong>ServletContext</strong>å¯¹è±¡</p>
</li>
</ul>
<p>web.xml ä¸­çš„é…ç½®ï¼š</p>
<pre><code class="xml">&lt;!-- servlet æ ‡ç­¾ç»™Tomcat é…ç½®Servlet ç¨‹åº--&gt;
&lt;servlet&gt;
    &lt;!--servlet-name æ ‡ç­¾Servlet ç¨‹åºèµ·ä¸€ä¸ªåˆ«åï¼ˆä¸€èˆ¬æ˜¯ç±»åï¼‰ --&gt;
    &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
    &lt;!--servlet-class æ˜¯Servlet ç¨‹åºçš„å…¨ç±»å--&gt;
    &lt;servlet-class&gt;com.zhiguo.servlet.HelloServlet&lt;/servlet-class&gt;

    &lt;!--init-param æ˜¯åˆå§‹åŒ–å‚æ•°--&gt;
    &lt;init-param&gt;
        &lt;!--æ˜¯å‚æ•°å--&gt;
        &lt;param-name&gt;username&lt;/param-name&gt;
        &lt;!--æ˜¯å‚æ•°å€¼--&gt;
        &lt;param-value&gt;root&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;!--init-param æ˜¯åˆå§‹åŒ–å‚æ•°--&gt;
    &lt;init-param&gt;
        &lt;!--æ˜¯å‚æ•°å--&gt;
        &lt;param-name&gt;url&lt;/param-name&gt;
        &lt;!--æ˜¯å‚æ•°å€¼--&gt;
        &lt;param-value&gt;jdbc:mysql://localhost:3306/test&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/servlet&gt;

&lt;!--servlet-mapping æ ‡ç­¾ç»™servlet ç¨‹åºé…ç½®è®¿é—®åœ°å€--&gt;
&lt;servlet-mapping&gt;
  &lt;!--servlet-name æ ‡ç­¾çš„ä½œç”¨æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘å½“å‰é…ç½®çš„åœ°å€ç»™å“ªä¸ªServlet ç¨‹åºä½¿ç”¨--&gt;
  &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
  &lt;!--
  url-pattern æ ‡ç­¾é…ç½®è®¿é—®åœ°å€&lt;br/&gt;
  / æ–œæ åœ¨æœåŠ¡å™¨è§£æçš„æ—¶å€™ï¼Œè¡¨ç¤ºåœ°å€ä¸ºï¼šhttp://ip:port/å·¥ç¨‹è·¯å¾„&lt;br/&gt;
  /hello è¡¨ç¤ºåœ°å€ä¸ºï¼šhttp://ip:port/å·¥ç¨‹è·¯å¾„/hello &lt;br/&gt;
  --&gt;
  &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre>
<p><strong>Servlet</strong>ç¨‹åºä¸­çš„ä»£ç </p>
<pre><code class="java">public void init(ServletConfig servletConfig) throws ServletException &#123;
    System.out.println(&quot;2 init åˆå§‹åŒ–æ–¹æ³•&quot;);
// 1ã€å¯ä»¥è·å–Servlet ç¨‹åºçš„åˆ«åservlet-name çš„å€¼
    System.out.println(&quot;HelloServlet ç¨‹åºçš„åˆ«åæ˜¯:&quot; + servletConfig.getServletName());
// 2ã€è·å–åˆå§‹åŒ–å‚æ•°init-param
    System.out.println(&quot;åˆå§‹åŒ–å‚æ•°username çš„å€¼æ˜¯;&quot; + servletConfig.getInitParameter(&quot;username&quot;));
    System.out.println(&quot;åˆå§‹åŒ–å‚æ•°url çš„å€¼æ˜¯;&quot; + servletConfig.getInitParameter(&quot;url&quot;));
// 3ã€è·å–ServletContext å¯¹è±¡
    System.out.println(servletConfig.getServletContext());
&#125;
</code></pre>
<p><strong>æ³¨æ„ç‚¹</strong></p>
<p><img src="/2021/08/30/Web_servlet/4.jpg"></p>
<blockquote>
<h2 id="ServletContext-ç±»"><a href="#ServletContext-ç±»" class="headerlink" title="ServletContext ç±»"></a>ServletContext ç±»</h2></blockquote>
<hr>
<h3 id="ä»€ä¹ˆæ˜¯ServletContext-ç±»"><a href="#ä»€ä¹ˆæ˜¯ServletContext-ç±»" class="headerlink" title="ä»€ä¹ˆæ˜¯ServletContext ç±»"></a>ä»€ä¹ˆæ˜¯ServletContext ç±»</h3><ul>
<li><p><strong>ServletContext</strong>æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒè¡¨ç¤º<strong>Servlet</strong>ä¸Šä¸‹æ–‡å¯¹è±¡</p>
</li>
<li><p>ä¸€ä¸ª<strong>web</strong>å·¥ç¨‹ï¼Œåªæœ‰ä¸€ä¸ª<strong>ServletContext</strong>å¯¹è±¡å®ä¾‹ã€‚</p>
</li>
<li><p><strong>ServletContext</strong>å¯¹è±¡æ˜¯ä¸€ä¸ªåŸŸå¯¹è±¡ã€‚</p>
</li>
<li><p><strong>ServletContext</strong>æ˜¯åœ¨<strong>web</strong>å·¥ç¨‹éƒ¨ç½²å¯åŠ¨çš„æ—¶å€™åˆ›å»ºã€‚<strong>åœ¨web</strong>å·¥ç¨‹åœæ­¢çš„æ—¶å€™é”€æ¯ã€‚</p>
</li>
</ul>
<p>ä»€ä¹ˆæ˜¯<strong>åŸŸå¯¹è±¡</strong>?</p>
<p>åŸŸå¯¹è±¡ï¼Œæ˜¯å¯ä»¥åƒMapä¸€æ ·å­˜å–æ•°æ®çš„å¯¹è±¡ï¼Œå«åŸŸå¯¹è±¡ã€‚</p>
<p>è¿™é‡Œçš„åŸŸæŒ‡çš„æ˜¯å­˜å–æ•°æ®çš„æ“ä½œèŒƒå›´ï¼Œæ•´ä¸ªweb å·¥ç¨‹ã€‚</p>
<p><img src="/2021/08/30/Web_servlet/5.png"></p>
<hr>
<h3 id="ServletContext-ç±»çš„å››ä¸ªä½œç”¨"><a href="#ServletContext-ç±»çš„å››ä¸ªä½œç”¨" class="headerlink" title="ServletContext ç±»çš„å››ä¸ªä½œç”¨"></a>ServletContext ç±»çš„å››ä¸ªä½œç”¨</h3><ul>
<li><p>è·å–web.xml ä¸­é…ç½®çš„ä¸Šä¸‹æ–‡å‚æ•°<code>context-param</code></p>
</li>
<li><p>è·å–å½“å‰çš„å·¥ç¨‹è·¯å¾„ï¼Œæ ¼å¼: /å·¥ç¨‹è·¯å¾„</p>
</li>
<li><p>è·å–å·¥ç¨‹éƒ¨ç½²ååœ¨æœåŠ¡å™¨ç¡¬ç›˜ä¸Šçš„ç»å¯¹è·¯å¾„</p>
</li>
<li><p>åƒMapä¸€æ ·å­˜å–æ•°æ®</p>
</li>
</ul>
<p>ServletContext æ¼”ç¤ºä»£ç </p>
<pre><code class="java">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;

         //è·å–web.xmlä¸­é…ç½®ä¸Šä¸‹æ–‡çš„å‚æ•°contextâ€”â€”param
        ServletContext context = getServletConfig().getServletContext();

        String username = context.getInitParameter(&quot;username&quot;);
        System.out.println(&quot;usernameçš„åå­—æ˜¯ï¼š&quot;+username);

        //è·å–å½“å‰å·¥ç¨‹çš„è·¯å¾„
        System.out.println(&quot;å½“å‰å·¥ç¨‹çš„è·¯å¾„æ˜¯&quot;+context.getContextPath());

        //è·å–å·¥ç¨‹éƒ¨ç½²ååœ¨æœåŠ¡å™¨ç¡¬ç›˜ä¸Šçš„ç»å¯¹è·¯å¾„
        /**
         *  /æ–œæ è¢«æœåŠ¡å™¨è§£æåœ°å€ä¸º http://ip:port/å·¥ç¨‹å/  æ˜ å°„åˆ°ideaä¸Šçš„webç›®å½•&lt;/br&gt;
         */
        System.out.println(&quot;å·¥ç¨‹éƒ¨ç½²çš„ç»å¯¹è·¯å¾„æ˜¯&quot;+ context.getRealPath(&quot;/&quot;));
    &#125;
</code></pre>
<pre><code class="java">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;
        
        //è·å–servletcontextå¯¹è±¡
        ServletContext context = getServletContext();
        context.setAttribute(&quot;key1&quot;,&quot;value&quot;);
        System.out.println(&quot;contextæ•°æ®åŸŸä¸­key1çš„å€¼æ˜¯&quot;+context.getAttribute(&quot;key1&quot;));
&#125;
</code></pre>
<p>web.xmlé‡Œçš„é…ç½®</p>
<pre><code class="xml">&lt;!--context-param æ˜¯ä¸Šä¸‹æ–‡å‚æ•°(å®ƒå±äºæ•´ä¸ªweb å·¥ç¨‹)--&gt;
&lt;context-param&gt;
    &lt;param-name&gt;username&lt;/param-name&gt;
    &lt;param-value&gt;context&lt;/param-value&gt;
&lt;/context-param&gt;
&lt;!--context-param æ˜¯ä¸Šä¸‹æ–‡å‚æ•°(å®ƒå±äºæ•´ä¸ªweb å·¥ç¨‹)--&gt;
</code></pre>
<blockquote>
<p>åç»­å…³äºWeb.xmlçš„ç›¸åŒã€ç±»ä¼¼çš„é…ç½®ä¸å†èµ˜è¿°</p>
</blockquote>
<p>æœåŠ¡å™¨ç«¯ç»“æœ</p>
<p><img src="/2021/08/30/Web_servlet/6.png"><br><img src="/2021/08/30/Web_servlet/7.png"></p>
<blockquote>
<h2 id="HttpServletRequestç±»"><a href="#HttpServletRequestç±»" class="headerlink" title="HttpServletRequestç±»"></a>HttpServletRequestç±»</h2></blockquote>
<hr>
<h3 id="HttpServletRequestç±»-çš„ä½œç”¨"><a href="#HttpServletRequestç±»-çš„ä½œç”¨" class="headerlink" title="HttpServletRequestç±» çš„ä½œç”¨"></a>HttpServletRequestç±» çš„ä½œç”¨</h3><p>æ¯æ¬¡åªè¦æœ‰è¯·æ±‚è¿›å…¥<strong>Tomcat</strong>æœåŠ¡å™¨ï¼Œ<strong>Tomcat</strong>æœåŠ¡å™¨å°±ä¼šæŠŠè¯·æ±‚è¿‡æ¥çš„<strong>HTTP</strong>åè®®ä¿¡æ¯è§£æå¥½å°è£…åˆ°Request å¯¹è±¡ä¸­ã€‚</p>
<p>ç„¶åä¼ é€’åˆ°<strong>service</strong>æ–¹æ³•ï¼ˆ<code>doGet</code> å’Œ<code>doPost</code>ï¼‰ä¸­ç»™æˆ‘ä»¬ä½¿ç”¨ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>HttpServletRequest</strong>å¯¹è±¡ï¼Œè·å–åˆ°æ‰€æœ‰è¯·æ±‚çš„<br>ä¿¡æ¯ã€‚</p>
<hr>
<h3 id="HttpServletRequestç±»çš„å¸¸ç”¨æ–¹æ³•"><a href="#HttpServletRequestç±»çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="HttpServletRequestç±»çš„å¸¸ç”¨æ–¹æ³•"></a>HttpServletRequestç±»çš„å¸¸ç”¨æ–¹æ³•</h3><p><strong>HttpServletRequest</strong>ç±»æœ‰å¦‚ä¸‹å‡ ä¸ªå¸¸ç”¨çš„Api:</p>
<ul>
<li><p><code>getRequestURI()</code> è·å–è¯·æ±‚çš„èµ„æºè·¯å¾„</p>
</li>
<li><p><code>getRequestURL()</code>è·å–è¯·æ±‚çš„ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆç»å¯¹è·¯å¾„ï¼‰</p>
</li>
<li><p><code>getRemoteHost()</code>è·å–å®¢æˆ·ç«¯çš„ip åœ°å€</p>
</li>
<li><p><code>getHeader()</code>è·å–è¯·æ±‚å¤´</p>
</li>
<li><p><code>getParameter()</code>è·å–è¯·æ±‚çš„å‚æ•°</p>
</li>
<li><p><code>getParameterValues()</code>è·å–è¯·æ±‚çš„å‚æ•°ï¼ˆå¤šä¸ªå€¼çš„æ—¶å€™ä½¿ç”¨ï¼‰</p>
</li>
<li><p><code>getMethod()</code>è·å–è¯·æ±‚çš„æ–¹å¼GET æˆ–POST</p>
</li>
<li><p><code>setAttribute(key, value)</code>è®¾ç½®åŸŸæ•°æ®</p>
</li>
<li><p><code>getAttribute(key)</code>è·å–åŸŸæ•°æ®</p>
</li>
<li><p><code>getRequestDispatcher()</code>è·å–è¯·æ±‚è½¬å‘å¯¹è±¡</p>
</li>
</ul>
<hr>
<h3 id="è¯·æ±‚çš„è½¬å‘"><a href="#è¯·æ±‚çš„è½¬å‘" class="headerlink" title="è¯·æ±‚çš„è½¬å‘"></a>è¯·æ±‚çš„è½¬å‘</h3><p>ä»€ä¹ˆæ˜¯è¯·æ±‚çš„è½¬å‘?</p>
<p><strong>è¯·æ±‚è½¬å‘</strong>æ˜¯æŒ‡ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä»ä¸€æ¬¡èµ„æºè·³è½¬åˆ°å¦ä¸€ä¸ªèµ„æºçš„æ“ä½œã€‚</p>
<p><img src="/2021/08/30/Web_servlet/8.png"></p>
<blockquote>
<h2 id="HttpServletResponseç±»"><a href="#HttpServletResponseç±»" class="headerlink" title="HttpServletResponseç±»"></a>HttpServletResponseç±»</h2></blockquote>
<hr>
<h3 id="HttpServletResponseç±»çš„ä½œç”¨"><a href="#HttpServletResponseç±»çš„ä½œç”¨" class="headerlink" title="HttpServletResponseç±»çš„ä½œç”¨"></a>HttpServletResponseç±»çš„ä½œç”¨</h3><p><strong>HttpServletResponse</strong>ç±»å’Œ<strong>HttpServletRequest</strong>ç±»ä¸€æ ·ã€‚</p>
<p>æ¯æ¬¡è¯·æ±‚è¿›æ¥ï¼Œ<strong>Tomcat</strong>æœåŠ¡å™¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<strong>Response</strong>å¯¹è±¡ä¼ é€’ç»™<strong>Servlet</strong>ç¨‹åºå»ä½¿ç”¨ã€‚</p>
<p><strong>HttpServletRequest</strong>è¡¨ç¤ºè¯·æ±‚è¿‡æ¥çš„ä¿¡æ¯ï¼Œ<strong>HttpServletResponse</strong>è¡¨ç¤ºæ‰€æœ‰å“åº”çš„ä¿¡æ¯ï¼Œ<br>æˆ‘ä»¬å¦‚æœéœ€è¦è®¾ç½®è¿”å›ç»™å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œéƒ½å¯ä»¥é€šè¿‡<strong>HttpServletResponse</strong>å¯¹è±¡æ¥è¿›è¡Œè®¾ç½®ã€‚</p>
<h3 id="ä¸¤ä¸ªè¾“å‡ºæµçš„è¯´æ˜"><a href="#ä¸¤ä¸ªè¾“å‡ºæµçš„è¯´æ˜" class="headerlink" title="ä¸¤ä¸ªè¾“å‡ºæµçš„è¯´æ˜"></a>ä¸¤ä¸ªè¾“å‡ºæµçš„è¯´æ˜</h3><ul>
<li><p>å­—èŠ‚æµ<br><code>getOutputStream()</code>å¸¸ç”¨äºä¸‹è½½ï¼ˆä¼ é€’äºŒè¿›åˆ¶æ•°æ®ï¼‰</p>
</li>
<li><p>å­—ç¬¦æµ<br><code>getWriter()</code> å¸¸ç”¨äºå›ä¼ å­—ç¬¦ä¸²ï¼ˆå¸¸ç”¨ï¼‰</p>
</li>
</ul>
<p><strong>ä¸¤ä¸ªæµåŒæ—¶åªèƒ½ä½¿ç”¨ä¸€ä¸ªã€‚</strong></p>
<h3 id="å¦‚ä½•å¾€å®¢æˆ·ç«¯ä¼ é€æ•°æ®"><a href="#å¦‚ä½•å¾€å®¢æˆ·ç«¯ä¼ é€æ•°æ®" class="headerlink" title="å¦‚ä½•å¾€å®¢æˆ·ç«¯ä¼ é€æ•°æ®"></a>å¦‚ä½•å¾€å®¢æˆ·ç«¯ä¼ é€æ•°æ®</h3><pre><code class="java">public class ResponseIOServlet extends HttpServlet &#123;

  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;
      
    //å¾€å®¢æˆ·ç«¯å›ä¼ å­—ç¬¦æµ
    PrintWriter writer = resp.getWriter();
    writer.println(&quot;response&#39;s content!&quot;);
    writer.println(&quot;å›½å“¥çœŸçš„å¸…å‘€ï¼&quot;);
  &#125;
&#125;
</code></pre>
<p><img src="/2021/08/30/Web_servlet/11.png"></p>
<h3 id="å“åº”çš„ä¹±ç è§£å†³"><a href="#å“åº”çš„ä¹±ç è§£å†³" class="headerlink" title="å“åº”çš„ä¹±ç è§£å†³"></a>å“åº”çš„ä¹±ç è§£å†³</h3><p>æˆ‘ä»¬åœ¨ä¸Šé¢å¾€å®¢æˆ·ç«¯ä¼ é€æ•°æ®æ—¶ä¼šå‘ç°ä¸­æ–‡ç¼–ç æ ¼å¼ä¼šå­˜åœ¨é—®é¢˜</p>
<p>â€œ<strong>å›½å“¥çœŸçš„å¸…å‘€ï¼</strong>â€œæ˜¾ç¤ºæˆäº†â€<strong>ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</strong>â€œ</p>
<p>è¿™æ˜¯å› ä¸ºæœåŠ¡å™¨é»˜è®¤çš„ç¼–ç æ ¼å¼ä¸º<strong>ISO-8859-1</strong></p>
<p>æˆ‘ä»¬å¯ä»¥åˆ†åˆ«é€šè¿‡<code>setCharacterEncoding()</code>ã€<code>setHeader()</code>å’Œ<code>setContentType()</code>ä¸¤ç§æ–¹æ³•æ¥è®¾ç½®æœåŠ¡å™¨å’Œæµè§ˆå™¨çš„ç¼–ç æ ¼å¼</p>
<pre><code class="java">public class ResponseIOServlet extends HttpServlet &#123;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;

        //System.out.println(resp.getCharacterEncoding()); //é»˜è®¤ISO-8859-1

        //è®¾ç½®æœåŠ¡å™¨å­—ç¬¦é›†ä¸ºUTF-8
        // resp.setCharacterEncoding(&quot;UTF-8&quot;);

        //é€šè¿‡å“åº”å¤´ï¼Œè®¾ç½®æµè§ˆå™¨ä¹Ÿä½¿ç”¨UTF-8å­—ç¬¦é›†
        // resp.setHeader(&quot;Content-Type&quot;,&quot;text/html;charset=UTF-8&quot;);

        //åŒæ—¶è®¾ç½®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸ºUTF-8å­—ç¬¦é›†ï¼Œè¿˜è®¾ç½®äº†å“åº”å¤´
        //åœ¨è·å–æµå¯¹è±¡å‰è°ƒç”¨æ‰æœ‰æ•ˆ
        resp.setContentType(&quot;text/html;charset=UTF-8&quot;);


        //å¾€å®¢æˆ·ç«¯å›ä¼ å­—ç¬¦æµ
        PrintWriter writer = resp.getWriter();
        writer.println(&quot;response&#39;s content!&quot;);
        writer.println(&quot;å›½å“¥çœŸçš„å¸…å‘€ï¼&quot;);
    &#125;
&#125;
</code></pre>
<blockquote>
<p>æ¨èä½¿ç”¨<code>setContentType()</code>ä¸€æ­¥åˆ°ä½</p>
</blockquote>
<p>æ­¤æ—¶è®¿é—®æµè§ˆå™¨ä¼šå‘ç°</p>
<p><img src="/2021/08/30/Web_servlet/12.png"></p>
<p>**â€å›½å“¥çœŸçš„å¸…å‘€ï¼â€**æ˜¾ç¤ºå‡ºæ¥äº†!</p>
<h3 id="è¯·æ±‚é‡å®šå‘"><a href="#è¯·æ±‚é‡å®šå‘" class="headerlink" title="è¯·æ±‚é‡å®šå‘"></a>è¯·æ±‚é‡å®šå‘</h3><p><strong>è¯·æ±‚é‡å®šå‘</strong>ï¼Œæ˜¯æŒ‡å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯è¯´ã€‚æˆ‘ç»™ä½ ä¸€äº›åœ°å€ã€‚ä½ å»æ–°åœ°å€è®¿é—®ã€‚<br>å«è¯·æ±‚é‡å®šå‘ï¼ˆå› ä¸ºä¹‹å‰çš„åœ°å€å¯èƒ½å·²ç»è¢«åºŸå¼ƒï¼‰</p>
<p><img src="/2021/08/30/Web_servlet/9.png"></p>
<p>å®ç°ä»£ç å¦‚ä¸‹:</p>
<p><img src="/2021/08/30/Web_servlet/10.png"></p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Servlet</tag>
      </tags>
  </entry>
  <entry>
    <title>JDBCå­¦ä¹ è®°å½•</title>
    <url>/2021/08/30/Mysql_JDBC/</url>
    <content><![CDATA[<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><blockquote>
<p>è¿™é‡Œè®°å½•æˆ‘å­¦ä¹ JDBCè¿æ¥æ•°æ®åº“æ“ä½œæ—¶çš„ç¬”è®°å’ŒçŸ¥è¯†æ€»ç»“ï¼Œæ–¹ä¾¿åç»­çš„å¤ä¹ </p>
</blockquote>
<span id="more"></span>

<h2 id="ä¸ºä»€ä¹ˆéœ€è¦JDBC"><a href="#ä¸ºä»€ä¹ˆéœ€è¦JDBC" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦JDBC"></a>ä¸ºä»€ä¹ˆéœ€è¦JDBC</h2><p><img src="/2021/08/30/Mysql_JDBC/JDBC_1.png"></p>
<p>æ²¡æœ‰JDBCä¹‹å‰ï¼Œç¨‹åºå‘˜ä»¬æ“ä½œä¸åŒæ•°æ®åº“æ—¶ï¼Œéƒ½æ˜¯æˆ‘ä»¬é€šè¿‡ä»£ç å»å®ç°çš„ã€‚</p>
<p>è€Œè¿æ¥MySQLçš„ä»£ç ï¼Œå’Œè¿æ¥Oracleçš„ä»£ç æ˜¯ä¸åŒçš„ï¼›</p>
<p>è¿™å°±å¯¼è‡´äº†ï¼Œæˆ‘ä»¬<strong>æ›´æ¢æ•°æ®åº“æ—¶å°±è¦å»ä¿®æ”¹ä»£ç </strong>ï¼Œä»£ç çš„<strong>å¯å¤ç”¨æ€§</strong>å’Œ<strong>ç§»æ¤æ€§</strong>å°±æ˜¾å¾—å¾ˆä½äº†ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯JDBC"><a href="#ä»€ä¹ˆæ˜¯JDBC" class="headerlink" title="ä»€ä¹ˆæ˜¯JDBC"></a>ä»€ä¹ˆæ˜¯JDBC</h2><ul>
<li><p>JDBC(Java Database Connectivity)æ˜¯ä¸€ä¸ªç‹¬ç«‹äºç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€é€šç”¨çš„SQLæ•°æ®åº“å­˜å–å’Œæ“ä½œçš„<strong>å…¬å…±æ¥å£</strong>ï¼ˆä¸€ç»„APIï¼‰ï¼Œ<br>å®šä¹‰äº†ç”¨æ¥è®¿é—®æ•°æ®åº“çš„æ ‡å‡†Javaç±»åº“ï¼Œï¼ˆ<strong>java.sql,javax.sql</strong>ï¼‰ä½¿ç”¨è¿™äº›ç±»åº“å¯ä»¥ä»¥ä¸€ç§<strong>æ ‡å‡†</strong>çš„æ–¹æ³•ã€æ–¹ä¾¿åœ°è®¿é—®æ•°æ®åº“èµ„æºã€‚</p>
</li>
<li><p>JDBCä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ä¸€ç§<strong>ç»Ÿä¸€çš„é€”å¾„</strong>ï¼Œä¸ºå¼€å‘è€…å±è”½äº†ä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚</p>
</li>
<li><p>JDBCçš„ç›®æ ‡æ˜¯ä½¿Javaç¨‹åºå‘˜ä½¿ç”¨JDBCå¯ä»¥è¿æ¥ä»»ä½•<strong>æä¾›äº†JDBCé©±åŠ¨ç¨‹åº</strong>çš„æ•°æ®åº“ç³»ç»Ÿï¼Œè¿™æ ·å°±ä½¿å¾—ç¨‹åºå‘˜æ— éœ€å¯¹ç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ç‰¹ç‚¹æœ‰è¿‡å¤šçš„äº†è§£ï¼Œä»è€Œå¤§å¤§ç®€åŒ–å’ŒåŠ å¿«äº†å¼€å‘è¿‡ç¨‹ã€‚</p>
</li>
</ul>
<blockquote>
<p>è¯´äººè¯å°±æ˜¯æä¾›äº†ä¸€ä¸ª<strong>é€šç”¨çš„æ¥å£</strong>(<strong>æ ‡å‡†</strong>)æ¥<strong>æ“ä½œæ•°æ®åº“</strong>ï¼Œåœ¨ç¨‹åºä¸­åŠ è½½çš„ç±»éƒ½æ˜¯<strong>JavaåŸç”Ÿæä¾›çš„ç±»</strong>ï¼Œ<br>å¹¶ä¸åŒ…å«å¤–éƒ¨å¼•ç”¨çš„ç±»ï¼Œæé«˜äº†ä»£ç çš„<strong>å¯å¤ç”¨æ€§</strong>å’Œ<strong>ç§»æ¤æ€§</strong>ã€‚</p>
</blockquote>
<p><img src="/2021/08/30/Mysql_JDBC/JDBC_2.png"></p>
<ul>
<li>JDBCæ¥å£ï¼ˆAPIï¼‰åŒ…æ‹¬ä¸¤ä¸ªå±‚æ¬¡ï¼š<ul>
<li><strong>é¢å‘åº”ç”¨çš„API</strong>ï¼šJava APIï¼ŒæŠ½è±¡æ¥å£ï¼Œä¾›åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä½¿ç”¨ï¼ˆè¿æ¥æ•°æ®åº“ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å¾—ç»“æœï¼‰ã€‚</li>
<li> <strong>é¢å‘æ•°æ®åº“çš„API</strong>ï¼šJava Driver APIï¼Œä¾›å¼€å‘å•†å¼€å‘æ•°æ®åº“é©±åŠ¨ç¨‹åºç”¨ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>JDBCæ˜¯Sunå…¬å¸(é‚£æ—¶è¿˜æ²¡è¢«Oracleæ”¶è´­)æä¾›ä¸€å¥—ç”¨äºæ•°æ®åº“æ“ä½œçš„æ¥å£ï¼Œjavaç¨‹åºå‘˜åªéœ€è¦é¢å‘è¿™å¥—æ¥å£ç¼–ç¨‹å³å¯ã€‚</strong></p>
<p><strong>ä¸åŒçš„æ•°æ®åº“å‚å•†ï¼Œéœ€è¦é’ˆå¯¹è¿™å¥—æ¥å£ï¼Œæä¾›ä¸åŒå®ç°ã€‚ä¸åŒçš„å®ç°çš„é›†åˆï¼Œå³ä¸ºä¸åŒæ•°æ®åº“çš„é©±åŠ¨ã€‚                                                                â€”â€”â€”â€”é¢å‘æ¥å£ç¼–ç¨‹</strong></p>
</blockquote>
<h2 id="JDBCçš„åŠŸèƒ½å®ç°"><a href="#JDBCçš„åŠŸèƒ½å®ç°" class="headerlink" title="JDBCçš„åŠŸèƒ½å®ç°"></a>JDBCçš„åŠŸèƒ½å®ç°</h2><p><img src="/2021/08/30/Mysql_JDBC/JDBC_3.png"><br>æ­¥éª¤ç®€å•ç†è§£ä¸ºå°±æ˜¯:</p>
<ul>
<li><p>è¿æ¥æ•°æ®åº“</p>
</li>
<li><p>æ‰§è¡Œsqlè¯­å¥</p>
</li>
<li><p>å¦‚æœæ˜¯<strong>æŸ¥è¯¢</strong>åˆ™é€šè¿‡Resultå¯¹è±¡æ¥æ¥å—<strong>ç»“æœæ•°æ®</strong>(å…¶ä¸­å¾—æå‰åˆ›å»ºæ¥æ”¶<strong>å¯¹åº”</strong>æ•°æ®çš„Javaå¯¹è±¡)</p>
</li>
<li><p>æ–­å¼€æ•°æ®åº“è¿æ¥</p>
</li>
</ul>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li><p>æ•°æ®åº“çš„è¿æ¥ç­‰ç”±ç¨‹åºå‘˜ä½¿ç”¨<strong>æ•°æ®åº“è¿æ¥æ± </strong>å®Œæˆ</p>
</li>
<li><p>æ‰§è¡Œsqlè¯­å¥ç”±ç¨‹åºå‘˜ä½¿ç”¨<strong>JDBCå·¥å…·ç±»åº“å®ç°CUDRæ“ä½œ</strong>å®Œæˆ</p>
</li>
</ul>
<p>å½“ç„¶ï¼Œæ•°æ®åº“çš„è¿æ¥å’Œæ–­å¼€ä»¥åŠCUDRæ“ä½œå¯ä»¥è‡ªå·±å†™ï¼Œä½†æ˜¯è¿™ä¹Ÿå­˜åœ¨ä¸€äº›å¼Šç«¯ï¼Œä¸‹é¢ä¼šä»‹ç»é“ã€‚</p>
<h2 id="æ•°æ®åº“è¿æ¥æ± "><a href="#æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="æ•°æ®åº“è¿æ¥æ± "></a>æ•°æ®åº“è¿æ¥æ± </h2><h3 id="JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"><a href="#JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§" class="headerlink" title="JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"></a>JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</h3><ul>
<li><p>åœ¨ä½¿ç”¨å¼€å‘åŸºäºæ•°æ®åº“çš„webç¨‹åºæ—¶ï¼Œä¼ ç»Ÿçš„æ¨¡å¼åŸºæœ¬æ˜¯æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li><strong>åœ¨ä¸»ç¨‹åºï¼ˆå¦‚servletã€beansï¼‰ä¸­å»ºç«‹æ•°æ®åº“è¿æ¥</strong></li>
<li><strong>è¿›è¡Œsqlæ“ä½œ</strong></li>
<li><strong>æ–­å¼€æ•°æ®åº“è¿æ¥</strong></li>
</ul>
</li>
<li><p>è¿™ç§æ¨¡å¼å¼€å‘ï¼Œå­˜åœ¨çš„é—®é¢˜:</p>
<ul>
<li>æ™®é€šçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManager æ¥è·å–ï¼Œæ¯æ¬¡å‘æ•°æ®åº“å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½è¦å°† Connection åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†éªŒè¯ç”¨æˆ·åå’Œå¯†ç (å¾—èŠ±è´¹0.05sï½1sçš„æ—¶é—´)ã€‚éœ€è¦æ•°æ®åº“è¿æ¥çš„æ—¶å€™ï¼Œå°±å‘æ•°æ®åº“è¦æ±‚ä¸€ä¸ªï¼Œæ‰§è¡Œå®Œæˆåå†æ–­å¼€è¿æ¥ã€‚è¿™æ ·çš„æ–¹å¼å°†ä¼šæ¶ˆè€—å¤§é‡çš„èµ„æºå’Œæ—¶é—´ã€‚<strong>æ•°æ®åº“çš„è¿æ¥èµ„æºå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„é‡å¤åˆ©ç”¨ã€‚</strong>è‹¥åŒæ—¶æœ‰å‡ ç™¾äººç”šè‡³å‡ åƒäººåœ¨çº¿ï¼Œé¢‘ç¹çš„è¿›è¡Œæ•°æ®åº“è¿æ¥æ“ä½œå°†å ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æºï¼Œä¸¥é‡çš„ç”šè‡³ä¼šé€ æˆæœåŠ¡å™¨çš„å´©æºƒã€‚</li>
<li><strong>å¯¹äºæ¯ä¸€æ¬¡æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨å®Œåéƒ½å¾—æ–­å¼€ã€‚</strong>å¦åˆ™ï¼Œå¦‚æœç¨‹åºå‡ºç°å¼‚å¸¸è€Œæœªèƒ½å…³é—­ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®åº“ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆå°†å¯¼è‡´é‡å¯æ•°æ®åº“ã€‚ï¼ˆå›å¿†ï¼šä½•ä¸ºJavaçš„å†…å­˜æ³„æ¼ï¼Ÿï¼‰</li>
<li><strong>è¿™ç§å¼€å‘ä¸èƒ½æ§åˆ¶è¢«åˆ›å»ºçš„è¿æ¥å¯¹è±¡æ•°</strong>ï¼Œç³»ç»Ÿèµ„æºä¼šè¢«æ¯«æ— é¡¾åŠçš„åˆ†é…å‡ºå»ï¼Œå¦‚è¿æ¥è¿‡å¤šï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ŒæœåŠ¡å™¨å´©æºƒã€‚</li>
</ul>
</li>
</ul>
<h3 id="æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"><a href="#æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯" class="headerlink" title="æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"></a>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</h3><ul>
<li><p>ä¸ºè§£å†³ä¼ ç»Ÿå¼€å‘ä¸­çš„æ•°æ®åº“è¿æ¥é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯ã€‚</p>
</li>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± çš„åŸºæœ¬æ€æƒ³</strong>ï¼šå°±æ˜¯ä¸ºæ•°æ®åº“è¿æ¥å»ºç«‹ä¸€ä¸ªâ€œç¼“å†²æ± â€ã€‚é¢„å…ˆåœ¨ç¼“å†²æ± ä¸­æ”¾å…¥ä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œå½“éœ€è¦å»ºç«‹æ•°æ®åº“è¿æ¥æ—¶ï¼Œåªéœ€ä»â€œç¼“å†²æ± â€ä¸­å–å‡ºä¸€ä¸ªï¼Œä½¿ç”¨å®Œæ¯•ä¹‹åå†æ”¾å›å»ã€‚</p>
</li>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± </strong>è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œå®ƒ<strong>å…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯é‡æ–°å»ºç«‹ä¸€ä¸ª</strong>ã€‚</p>
</li>
<li><p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–æ—¶å°†åˆ›å»ºä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥æ”¾åˆ°è¿æ¥æ± ä¸­ï¼Œè¿™äº›æ•°æ®åº“è¿æ¥çš„æ•°é‡æ˜¯ç”±<strong>æœ€å°æ•°æ®åº“è¿æ¥æ•°æ¥è®¾å®š</strong>çš„ã€‚æ— è®ºè¿™äº›æ•°æ®åº“è¿æ¥æ˜¯å¦è¢«ä½¿ç”¨ï¼Œè¿æ¥æ± éƒ½å°†ä¸€ç›´ä¿è¯è‡³å°‘æ‹¥æœ‰è¿™ä¹ˆå¤šçš„è¿æ¥æ•°é‡ã€‚è¿æ¥æ± çš„<strong>æœ€å¤§æ•°æ®åº“è¿æ¥æ•°é‡</strong>é™å®šäº†è¿™ä¸ªè¿æ¥æ± èƒ½å æœ‰çš„æœ€å¤§è¿æ¥æ•°ï¼Œå½“åº”ç”¨ç¨‹åºå‘è¿æ¥æ± è¯·æ±‚çš„è¿æ¥æ•°è¶…è¿‡æœ€å¤§è¿æ¥æ•°é‡æ—¶ï¼Œè¿™äº›è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚<br><img src="/2021/08/30/Mysql_JDBC/JDBC_4.png"></p>
</li>
<li><p><strong>å·¥ä½œåŸç†ï¼š</strong><br><img src="/2021/08/30/Mysql_JDBC/JDBC_5.png"></p>
</li>
<li><p><strong>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯çš„ä¼˜ç‚¹</strong></p>
<p><strong>1. èµ„æºé‡ç”¨</strong></p>
<p>ç”±äºæ•°æ®åº“è¿æ¥å¾—ä»¥é‡ç”¨ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºï¼Œé‡Šæ”¾è¿æ¥å¼•èµ·çš„å¤§é‡æ€§èƒ½å¼€é”€ã€‚åœ¨å‡å°‘ç³»ç»Ÿæ¶ˆè€—çš„åŸºç¡€ä¸Šï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¢åŠ äº†ç³»ç»Ÿè¿è¡Œç¯å¢ƒçš„å¹³ç¨³æ€§ã€‚</p>
<p><strong>2. æ›´å¿«çš„ç³»ç»Ÿååº”é€Ÿåº¦</strong></p>
<p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å·²ç»åˆ›å»ºäº†è‹¥å¹²æ•°æ®åº“è¿æ¥ç½®äºè¿æ¥æ± ä¸­å¤‡ç”¨ã€‚æ­¤æ—¶è¿æ¥çš„åˆå§‹åŒ–å·¥ä½œå‡å·²å®Œæˆã€‚å¯¹äºä¸šåŠ¡è¯·æ±‚å¤„ç†è€Œè¨€ï¼Œç›´æ¥åˆ©ç”¨ç°æœ‰å¯ç”¨è¿æ¥ï¼Œé¿å…äº†æ•°æ®åº“è¿æ¥åˆå§‹åŒ–å’Œé‡Šæ”¾è¿‡ç¨‹çš„æ—¶é—´å¼€é”€ï¼Œä»è€Œå‡å°‘äº†ç³»ç»Ÿçš„å“åº”æ—¶é—´</p>
<p><strong>3. æ–°çš„èµ„æºåˆ†é…æ‰‹æ®µ</strong></p>
<p>å¯¹äºå¤šåº”ç”¨å…±äº«åŒä¸€æ•°æ®åº“çš„ç³»ç»Ÿè€Œè¨€ï¼Œå¯åœ¨åº”ç”¨å±‚é€šè¿‡æ•°æ®åº“è¿æ¥æ± çš„é…ç½®ï¼Œå®ç°æŸä¸€åº”ç”¨æœ€å¤§å¯ç”¨æ•°æ®åº“è¿æ¥æ•°çš„é™åˆ¶ï¼Œé¿å…æŸä¸€åº”ç”¨ç‹¬å æ‰€æœ‰çš„æ•°æ®åº“èµ„æº</p>
<p><strong>4. ç»Ÿä¸€çš„è¿æ¥ç®¡ç†ï¼Œé¿å…æ•°æ®åº“è¿æ¥æ³„æ¼</strong></p>
<p>åœ¨è¾ƒä¸ºå®Œå–„çš„æ•°æ®åº“è¿æ¥æ± å®ç°ä¸­ï¼Œå¯æ ¹æ®é¢„å…ˆçš„å ç”¨è¶…æ—¶è®¾å®šï¼Œå¼ºåˆ¶å›æ”¶è¢«å ç”¨è¿æ¥ï¼Œä»è€Œé¿å…äº†å¸¸è§„æ•°æ®åº“è¿æ¥æ“ä½œä¸­å¯èƒ½å‡ºç°çš„èµ„æºæ³„éœ²</p>
</li>
</ul>
<h3 id="å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "><a href="#å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "></a>å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </h3><ul>
<li><p>JDBC çš„æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ javax.sql.DataSource æ¥è¡¨ç¤ºï¼ŒDataSource åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é€šå¸¸ç”±æœåŠ¡å™¨(Weblogic, WebSphere, Tomcat)æä¾›å®ç°ï¼Œä¹Ÿæœ‰ä¸€äº›å¼€æºç»„ç»‡æä¾›å®ç°ï¼š</p>
<ul>
<li><strong>DBCP</strong> æ˜¯Apacheæä¾›çš„æ•°æ®åº“è¿æ¥æ± ã€‚tomcat æœåŠ¡å™¨è‡ªå¸¦dbcpæ•°æ®åº“è¿æ¥æ± ã€‚<strong>é€Ÿåº¦ç›¸å¯¹c3p0è¾ƒå¿«</strong>ï¼Œä½†å› è‡ªèº«å­˜åœ¨BUGï¼ŒHibernate3å·²ä¸å†æä¾›æ”¯æŒã€‚</li>
<li><strong>C3P0</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œ<strong>é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç¨³å®šæ€§è¿˜å¯ä»¥ã€‚</strong>hibernateå®˜æ–¹æ¨èä½¿ç”¨</li>
<li><strong>Proxool</strong> æ˜¯sourceforgeä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ•°æ®åº“è¿æ¥æ± ï¼Œæœ‰ç›‘æ§è¿æ¥æ± çŠ¶æ€çš„åŠŸèƒ½ï¼Œ<strong>ç¨³å®šæ€§è¾ƒc3p0å·®ä¸€ç‚¹</strong></li>
<li><strong>BoneCP</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦å¿«</li>
<li><strong>Druid</strong> æ˜¯é˜¿é‡Œæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ®è¯´æ˜¯é›†DBCP ã€C3P0 ã€Proxool ä¼˜ç‚¹äºä¸€èº«çš„æ•°æ®åº“è¿æ¥æ± ï¼Œä½†æ˜¯é€Ÿåº¦ä¸ç¡®å®šæ˜¯å¦æœ‰BoneCPå¿«</li>
</ul>
</li>
<li><p>DataSource é€šå¸¸è¢«ç§°ä¸ºæ•°æ®æºï¼Œå®ƒåŒ…å«è¿æ¥æ± å’Œè¿æ¥æ± ç®¡ç†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¹ æƒ¯ä¸Šä¹Ÿç»å¸¸æŠŠ DataSource ç§°ä¸ºè¿æ¥æ± </p>
</li>
<li><p><strong>DataSourceç”¨æ¥å–ä»£DriverManageræ¥è·å–Connectionï¼Œè·å–é€Ÿåº¦å¿«ï¼ŒåŒæ—¶å¯ä»¥å¤§å¹…åº¦æé«˜æ•°æ®åº“è®¿é—®é€Ÿåº¦ã€‚</strong></p>
</li>
<li><p>ç‰¹åˆ«æ³¨æ„ï¼š</p>
<ul>
<li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤<strong>æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</strong></li>
<li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†conn.close()å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>ç°åœ¨ä¸»è¦æ˜¯ä½¿ç”¨å¾·é²ä¼Šè¿æ¥æ± ã€‚</li>
</ul>
</blockquote>
<blockquote>
<p>ä¸€ä¸ªç®€å•çš„è¿æ¥å®ä¾‹:</p>
</blockquote>
<pre><code class="java">public class DruidTest &#123;

    @Test
    public void getConnection() throws Exception&#123;

        Properties pros = new Properties();

        InputStream is = ClassLoader.getSystemClassLoader().getResourceAsStream(&quot;druid.properties&quot;);

        //è£…è½½é…ç½®æ–‡ä»¶æ•°æ®
        pros.load(is);
        
        DataSource source = DruidDataSourceFactory.createDataSource(pros);

        Connection conn = source.getConnection();

        System.out.println(conn);
    &#125;
&#125;
</code></pre>
<p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€druid.propertiesã€‘</p>
<pre><code class="java">url=jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true
username=root
password=123456
driverClassName=com.mysql.jdbc.Driver

</code></pre>
<ul>
<li>è¯¦ç»†é…ç½®å‚æ•°(åœ¨é…ç½®æ–‡ä»¶å†…æ·»åŠ )ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th><strong>é…ç½®</strong></th>
<th><strong>ç¼ºçœ</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td></td>
<td>é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚   å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œæ ¼å¼æ˜¯ï¼šâ€DataSource-â€ +   System.identityHashCode(this)</td>
</tr>
<tr>
<td>url</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql :   jdbc:mysql://10.20.153.104:3306/druid2      oracle :   jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td>
</tr>
<tr>
<td>username</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å</td>
</tr>
<tr>
<td>password</td>
<td></td>
<td>è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œï¼š<a href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter</a></td>
</tr>
<tr>
<td>driverClassName</td>
<td></td>
<td>æ ¹æ®urlè‡ªåŠ¨è¯†åˆ«   è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName(å»ºè®®é…ç½®ä¸‹)</td>
</tr>
<tr>
<td>initialSize</td>
<td>0</td>
<td>åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶</td>
</tr>
<tr>
<td>maxActive</td>
<td>8</td>
<td>æœ€å¤§è¿æ¥æ± æ•°é‡</td>
</tr>
<tr>
<td>maxIdle</td>
<td>8</td>
<td>å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</td>
</tr>
<tr>
<td>minIdle</td>
<td></td>
<td>æœ€å°è¿æ¥æ± æ•°é‡</td>
</tr>
<tr>
<td>maxWait</td>
<td></td>
<td>è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚</td>
</tr>
<tr>
<td>poolPreparedStatements</td>
<td>false</td>
<td>æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysqlä¸‹å»ºè®®å…³é—­ã€‚</td>
</tr>
<tr>
<td>maxOpenPreparedStatements</td>
<td>-1</td>
<td>è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100</td>
</tr>
<tr>
<td>validationQuery</td>
<td></td>
<td>ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚</td>
</tr>
<tr>
<td>testOnBorrow</td>
<td>true</td>
<td>ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td>testOnReturn</td>
<td>false</td>
<td>å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</td>
</tr>
<tr>
<td>testWhileIdle</td>
<td>false</td>
<td>å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</td>
</tr>
<tr>
<td>timeBetweenEvictionRunsMillis</td>
<td></td>
<td>æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1)Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´2)testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜</td>
</tr>
<tr>
<td>numTestsPerEvictionRun</td>
<td></td>
<td>ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun</td>
</tr>
<tr>
<td>minEvictableIdleTimeMillis</td>
<td></td>
<td></td>
</tr>
<tr>
<td>connectionInitSqls</td>
<td></td>
<td>ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql</td>
</tr>
<tr>
<td>exceptionSorter</td>
<td></td>
<td>æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ«   å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥</td>
</tr>
<tr>
<td>filters</td>
<td></td>
<td>å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š   ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:statæ—¥å¿—ç”¨çš„filter:log4jé˜²å¾¡sqlæ³¨å…¥çš„filter:wall</td>
</tr>
<tr>
<td>proxyFilters</td>
<td></td>
<td>ç±»å‹æ˜¯Listï¼Œå¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œæ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³»</td>
</tr>
</tbody></table>
<h2 id="JDBCå·¥å…·ç±»åº“å®ç°CUDRæ“ä½œ"><a href="#JDBCå·¥å…·ç±»åº“å®ç°CUDRæ“ä½œ" class="headerlink" title="JDBCå·¥å…·ç±»åº“å®ç°CUDRæ“ä½œ"></a>JDBCå·¥å…·ç±»åº“å®ç°CUDRæ“ä½œ</h2><ul>
<li>commons-dbutils æ˜¯ Apache ç»„ç»‡æä¾›çš„ä¸€ä¸ª<strong>å¼€æºJDBCå·¥å…·ç±»åº“</strong>ï¼Œå®ƒæ˜¯å¯¹JDBCçš„ç®€å•å°è£…ï¼Œå­¦ä¹ æˆæœ¬æä½ï¼Œ<br>å¹¶ä¸”ä½¿ç”¨dbutilsèƒ½æå¤§ç®€åŒ–jdbcç¼–ç çš„å·¥ä½œé‡ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</li>
</ul>
<h3 id="DbUtilsç±»"><a href="#DbUtilsç±»" class="headerlink" title="DbUtilsç±»"></a>DbUtilsç±»</h3><ul>
<li><p>DbUtils ï¼šæä¾›å¦‚å…³é—­è¿æ¥ã€è£…è½½JDBCé©±åŠ¨ç¨‹åºç­‰å¸¸è§„å·¥ä½œçš„å·¥å…·ç±»ï¼Œé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li><p><strong>public static void close(â€¦) throws java.sql.SQLException</strong>ï¼š</p>
<p>DbUtilsç±»æä¾›äº†ä¸‰ä¸ªé‡è½½çš„å…³é—­æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ£€æŸ¥æ‰€æä¾›çš„å‚æ•°æ˜¯ä¸æ˜¯NULLï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå®ƒä»¬å°±å…³é—­Connectionã€Statementå’ŒResultSetã€‚</p>
</li>
<li><p><strong>public static void closeQuietly(â€¦)</strong>:</p>
<p>è¿™ä¸€ç±»æ–¹æ³•ä¸ä»…èƒ½åœ¨Connectionã€Statementå’ŒResultSetä¸ºNULLæƒ…å†µä¸‹é¿å…å…³é—­ï¼Œè¿˜èƒ½éšè—ä¸€äº›åœ¨ç¨‹åºä¸­æŠ›å‡ºçš„SQLEeceptionã€‚</p>
</li>
<li><p><strong>public static void commitAndClose(Connection conn)throws SQLException</strong>ï¼š</p>
<p>ç”¨æ¥æäº¤è¿æ¥çš„äº‹åŠ¡ï¼Œç„¶åå…³é—­è¿æ¥</p>
</li>
<li><p>**public static void commitAndCloseQuietly(Connection conn)**ï¼š</p>
<p>ç”¨æ¥æäº¤è¿æ¥ï¼Œç„¶åå…³é—­è¿æ¥ï¼Œå¹¶ä¸”åœ¨å…³é—­è¿æ¥æ—¶ä¸æŠ›å‡ºSQLå¼‚å¸¸ã€‚</p>
</li>
<li><p><strong>public static void rollback(Connection conn)throws SQLException</strong>ï¼š</p>
<p>å…è®¸connä¸ºnullï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨åšäº†åˆ¤æ–­</p>
</li>
<li><p><strong>public static void rollbackAndClose(Connection conn)throws SQLException</strong>:</p>
<p>äº‹åŠ¡çš„å›æ»š</p>
</li>
<li><p><strong>rollbackAndCloseQuietly(Connection)</strong>:</p>
<p>å®‰é™çš„äº‹åŠ¡å›æ»šï¼Ÿ</p>
</li>
<li><p>**public static boolean loadDriver(java.lang.String driverClassName)**ï¼š</p>
<p>è¿™ä¸€æ–¹è£…è½½å¹¶æ³¨å†ŒJDBCé©±åŠ¨ç¨‹åºï¼Œå¦‚æœæˆåŠŸå°±è¿”å›trueã€‚ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä½ ä¸éœ€è¦æ•æ‰è¿™ä¸ªå¼‚å¸¸ClassNotFoundExceptionã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 id="QueryRunnerç±»"><a href="#QueryRunnerç±»" class="headerlink" title="QueryRunnerç±»"></a>QueryRunnerç±»</h3><ul>
<li><p><strong>è¯¥ç±»ç®€å•åŒ–äº†SQLæŸ¥è¯¢ï¼Œå®ƒä¸ResultSetHandlerç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„æ•°æ®åº“æ“ä½œï¼Œèƒ½å¤Ÿå¤§å¤§å‡å°‘ç¼–ç é‡ã€‚</strong></p>
</li>
<li><p>QueryRunnerç±»æä¾›äº†ä¸¤ä¸ªæ„é€ å™¨ï¼š</p>
<ul>
<li>é»˜è®¤çš„æ„é€ å™¨</li>
<li>éœ€è¦ä¸€ä¸ª javax.sql.DataSource æ¥ä½œå‚æ•°çš„æ„é€ å™¨</li>
</ul>
</li>
<li><p>QueryRunnerç±»çš„ä¸»è¦æ–¹æ³•ï¼š</p>
<ul>
<li><p><strong>æ›´æ–°</strong></p>
<ul>
<li><p>public int update(Connection conn, String sql, Objectâ€¦ params) throws SQLException:</p>
<p>ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ›´æ–°ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰æ“ä½œã€‚</p>
</li>
<li><p> â€¦â€¦</p>
</li>
</ul>
</li>
<li><p><strong>æ’å…¥</strong></p>
<ul>
<li>public <T> T insert(Connection conn,String sql,ResultSetHandler<T> rsh, Objectâ€¦ params) throws SQLExceptionï¼š</T></T></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>  åªæ”¯æŒINSERTè¯­å¥ï¼Œå…¶ä¸­ rsh - The handler used to create the result object from the ResultSet of auto-generated keys.  è¿”å›å€¼: An object generated by the handler.å³è‡ªåŠ¨ç”Ÿæˆçš„é”®å€¼
- ....
</code></pre>
<ul>
<li><p><strong>æ‰¹å¤„ç†</strong></p>
<ul>
<li><p>public int[] batch(Connection conn,String sql,Object[][] params)throws SQLExceptionï¼š</p>
<p>æ”¯æŒINSERT, UPDATE, or DELETEè¯­å¥</p>
</li>
<li><p>public <T> T insertBatch(Connection conn,String sql,ResultSetHandler<T> rsh,Object[][] params)throws SQLExceptionï¼š</T></T></p>
<p>åªæ”¯æŒINSERTè¯­å¥</p>
</li>
<li><p>â€¦..</p>
</li>
</ul>
</li>
<li><p><strong>æŸ¥è¯¢</strong></p>
<ul>
<li><p>public Object query(Connection conn, String sql, ResultSetHandler rsh,Objectâ€¦ params) throws SQLExceptionï¼š</p>
<p>æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå¯¹è±¡æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼è¢«ç”¨æ¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ç½®æ¢å‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šè‡ªè¡Œå¤„ç† PreparedStatement å’Œ ResultSet çš„åˆ›å»ºå’Œå…³é—­ã€‚</p>
</li>
<li><p>â€¦â€¦</p>
</li>
</ul>
</li>
<li><p>ä¸€äº›ç®€å•çš„æµ‹è¯•</p>
<pre><code class="java">//æµ‹è¯•æ’å…¥
@Test
public void testInsert() throws SQLException&#123;
Connection conn = null;

      try &#123;
          QueryRunner Runner = new QueryRunner();

          conn = JDBCutils.getConnection();

          String sql = &quot;insert into customers(name,email,birth)value(?,?,?)&quot;;

          Runner.update(conn,sql,&quot;æ°å“¥&quot;,&quot;jiege@qq.com&quot;,&quot;2000-11-11&quot;);

      &#125; catch (Exception e) &#123;
          e.printStackTrace();
      &#125;
  &#125;
</code></pre>
</li>
</ul>
<h3 id="ResultSetHandleræ¥å£åŠå®ç°ç±»"><a href="#ResultSetHandleræ¥å£åŠå®ç°ç±»" class="headerlink" title="ResultSetHandleræ¥å£åŠå®ç°ç±»"></a>ResultSetHandleræ¥å£åŠå®ç°ç±»</h3><ul>
<li><p>è¯¥æ¥å£ç”¨äºå¤„ç† java.sql.ResultSetï¼Œå°†æ•°æ®æŒ‰è¦æ±‚è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ã€‚</p>
</li>
<li><p>ResultSetHandler æ¥å£æä¾›äº†ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ï¼šObject handle (java.sql.ResultSet .rs)ã€‚</p>
</li>
<li><p>æ¥å£çš„ä¸»è¦å®ç°ç±»ï¼š</p>
<ul>
<li><p>ArrayHandlerï¼šæŠŠç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®è½¬æˆå¯¹è±¡æ•°ç»„ã€‚</p>
</li>
<li><p>ArrayListHandlerï¼šæŠŠç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½è½¬æˆä¸€ä¸ªæ•°ç»„ï¼Œå†å­˜æ”¾åˆ°Listä¸­ã€‚</p>
</li>
<li><p><strong>BeanHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ã€‚</p>
</li>
<li><p><strong>BeanListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ï¼Œå­˜æ”¾åˆ°Listé‡Œã€‚</p>
</li>
<li><p>ColumnListHandlerï¼šå°†ç»“æœé›†ä¸­æŸä¸€åˆ—çš„æ•°æ®å­˜æ”¾åˆ°Listä¸­ã€‚</p>
</li>
<li><p>KeyedHandler(name)ï¼šå°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œå†æŠŠè¿™äº›mapå†å­˜åˆ°ä¸€ä¸ªmapé‡Œï¼Œå…¶keyä¸ºæŒ‡å®šçš„keyã€‚</p>
</li>
<li><p><strong>MapHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œkeyæ˜¯åˆ—åï¼Œvalueå°±æ˜¯å¯¹åº”çš„å€¼ã€‚</p>
</li>
<li><p><strong>MapListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œç„¶åå†å­˜æ”¾åˆ°List</p>
</li>
<li><p><strong>ScalarHandlerï¼š</strong>æŸ¥è¯¢å•ä¸ªå€¼å¯¹è±¡</p>
</li>
</ul>
</li>
<li><p>ä¸€äº›ç®€å•çš„æµ‹è¯•</p>
<pre><code class="java">//æµ‹è¯•æŸ¥è¯¢å¤šæ¡è®°å½•
@Test
public void testQueryList() throws SQLException &#123;
Connection conn = null;
try &#123;
QueryRunner Runner = new QueryRunner();

          conn = JDBCutils.getConnection();

          String sql = &quot;select id ,name,email,birth from Customers where id &lt; ?&quot;;

          BeanListHandler&lt;Customer&gt; handler = new BeanListHandler&lt;Customer&gt;(Customer.class);

          List&lt;Customer&gt; list = Runner.query(conn, sql, handler, 23);

          list.forEach(System.out::println);

      &#125; catch (Exception e) &#123;
          e.printStackTrace();
      &#125;
  &#125;
</code></pre>
</li>
</ul>
]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker Fileçš„å¸¸ç”¨æŒ‡ä»¤</title>
    <url>/2021/08/29/Docker_file/</url>
    <content><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><code>Docker File</code>è¢«ç”¨æ¥æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„imageé•œåƒï¼Œå°±åƒæŠŠé•œåƒçš„æ„å»ºä¸­æ¯ä¸€æ­¥æ·»åŠ çš„é…ç½®ã€æ–‡ä»¶ç­‰éƒ½å†™å…¥ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨æ„å»ºè‡ªå®šä¹‰é•œåƒæ—¶èƒ½æ ¹æ®è¿™ä¸ªé…ç½®æ–‡ä»¶æ¥é…ç½®ç›¸åº”çš„ä¿¡æ¯ã€‚</p>
<span id="more"></span>

<h2 id="æŒ‡ä»¤è¯¦è§£"><a href="#æŒ‡ä»¤è¯¦è§£" class="headerlink" title="æŒ‡ä»¤è¯¦è§£"></a>æŒ‡ä»¤è¯¦è§£</h2><h3 id="FROM-æŒ‡å®šåŸºç¡€é•œåƒ"><a href="#FROM-æŒ‡å®šåŸºç¡€é•œåƒ" class="headerlink" title="FROM æŒ‡å®šåŸºç¡€é•œåƒ"></a><code>FROM</code> æŒ‡å®šåŸºç¡€é•œåƒ</h3><h3 id="RUN-ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤"><a href="#RUN-ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤" class="headerlink" title="RUN  ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤"></a><code>RUN</code>  ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤</h3><h3 id="COPY-å¤åˆ¶æ–‡ä»¶"><a href="#COPY-å¤åˆ¶æ–‡ä»¶" class="headerlink" title="COPY å¤åˆ¶æ–‡ä»¶"></a><code>COPY</code> å¤åˆ¶æ–‡ä»¶</h3><p>æ ¼å¼:</p>
<ul>
<li><p><code>COPY &lt;æºè·¯å¾„&gt;...&lt;ç›®æ ‡è·¯å¾„&gt;</code></p>
</li>
<li><p><code>COPY [&quot;&lt;æºè·¯å¾„1&gt;&quot;,... &quot;&lt;ç›®æ ‡è·¯å¾„&gt;&quot;]</code></p>
</li>
</ul>
<p><code>COPY</code>æŒ‡ä»¤ä¼šä»æ„å»ºçš„ä¸Šä¸‹æ–‡ç›®å½•ä¸­çš„<code>&lt;æºè·¯å¾„&gt;</code>ï¼Œå¤åˆ¶å†…å®¹åˆ°<code>&lt;ç›®æ ‡è·¯å¾„&gt;</code></p>
<blockquote>
<p>æ³¨æ„âš ï¸: <code>COPY</code>ä¼šä¿ç•™æºæ–‡ä»¶çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬è¯»å†™æƒé™ç­‰</p>
</blockquote>
<h3 id="ADD-æ¯”COPYé«˜çº§çš„å¤åˆ¶æ–‡ä»¶"><a href="#ADD-æ¯”COPYé«˜çº§çš„å¤åˆ¶æ–‡ä»¶" class="headerlink" title="ADD æ¯”COPYé«˜çº§çš„å¤åˆ¶æ–‡ä»¶"></a><code>ADD</code> æ¯”COPYé«˜çº§çš„å¤åˆ¶æ–‡ä»¶</h3><p>ç›¸å¯¹äº<code>COPY</code>çš„æ–‡ä»¶å¤åˆ¶åŠŸèƒ½ï¼Œ<code>ADD</code>ä¸­ï¼š</p>
<ul>
<li><code>&lt;æºè·¯å¾„&gt;</code>å¯ä»¥æ˜¯ä¸€ä¸ª<code>URL</code>ï¼ŒDockerå¼•æ“ä¼šå°è¯•ä»é“¾æ¥ä¸‹è½½æ•°æ®æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨è®¾ç½®æ–‡ä»¶çš„æƒé™600ï¼Œ<br>å¦‚æœéœ€è¦ä¿®æ”¹æ–‡ä»¶çš„æƒé™ï¼Œåˆ™è¿˜éœ€è¦æ·»åŠ ä¸€å±‚RUNæ¥ä¿®æ”¹ï¼› </li>
<li>å¦‚æœ<code>&lt;æºè·¯å¾„&gt;</code>æ˜¯ä¸€ä»½å‹ç¼©æ–‡ä»¶ï¼Œåˆ™<code>ADD</code>ä¼šå°è¯•è§£å‹è¿™ä»½å‹ç¼©æ–‡ä»¶å¹¶æ·»åŠ åˆ°<code>&lt;ç›®æ ‡è·¯å¾„&gt;</code>ä¸­</li>
</ul>
<blockquote>
<p>ä¸éœ€è¦è‡ªåŠ¨è§£å‹ç¼©çš„æƒ…æ™¯ä¸‹æ›´æ¨èä½¿ç”¨<code>COPY</code></p>
</blockquote>
<h3 id="CMD-åœ¨å®¹å™¨ä¸­å¯åŠ¨å‘½ä»¤"><a href="#CMD-åœ¨å®¹å™¨ä¸­å¯åŠ¨å‘½ä»¤" class="headerlink" title="CMD åœ¨å®¹å™¨ä¸­å¯åŠ¨å‘½ä»¤"></a><code>CMD</code> åœ¨å®¹å™¨ä¸­å¯åŠ¨å‘½ä»¤</h3><p>Dockeråœ¨ä¸»æœºä¸Šçš„ä½“ç°ä¸æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œè€Œæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œ<code>CMD</code>æŒ‡ä»¤å°±æ˜¯ç”¨äºæŒ‡å®š<strong>é»˜è®¤</strong>(åé¢è¦è€ƒ doge.jpg)å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤</p>
<p>åœ¨é•œåƒè¿è¡Œæ—¶å¯ä»¥æŒ‡å®šæ–°çš„å‘½ä»¤æ¥æ›¿ä»£é•œåƒè®¾ç½®ä¸­çš„è¿™ä¸ªé»˜è®¤å‘½ä»¤</p>
<p><code>CMD</code>çš„æ ¼å¼æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><code>shell</code> æ ¼å¼ï¼šCMD &lt;å‘½ä»¤&gt;</li>
<li><code>exec</code> æ ¼å¼ï¼šCMD [â€œå¯æ‰§è¡Œæ–‡ä»¶â€, â€œå‚æ•°1â€, â€œå‚æ•°2â€â€¦]</li>
<li><code>å‚æ•°åˆ—è¡¨</code> æ ¼å¼ï¼šCMD [â€œå‚æ•°1â€, â€œå‚æ•°2â€â€¦]ã€‚åœ¨æŒ‡å®šäº†<code>ENTRYPOINT</code>æŒ‡ä»¤åï¼Œç”¨<code>CMD</code>æŒ‡å®šå…·ä½“çš„å‚æ•°ã€‚</li>
</ul>
<blockquote>
<p>æŒ‡ä»¤æ ¼å¼ä¸Šæ›´æ¨èä½¿ç”¨<code>exec</code> æ ¼å¼ï¼Œå…¶ä¸­çš„å‘½ä»¤ä¼šè¢«è§£æä¸ºJSONæ•°ç»„ï¼Œæ³¨æ„ä¸€å®šè¦ç”¨åŒå¼•å·â€ è€Œä¸æ˜¯å•å¼•å·â€™</p>
</blockquote>
<h3 id="ENTRYPOINT-å‘½ä»¤å…¥å£ç‚¹"><a href="#ENTRYPOINT-å‘½ä»¤å…¥å£ç‚¹" class="headerlink" title="ENTRYPOINT å‘½ä»¤å…¥å£ç‚¹"></a><code>ENTRYPOINT</code> å‘½ä»¤å…¥å£ç‚¹</h3><p><code>ENTRYPOINT</code>é¡¾åæ€ä¹‰ï¼Œå‘½ä»¤å…¥å£ç‚¹</p>
<p>æ ¼å¼ï¼š<br><code>ENTRYPOINT [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;] </code></p>
<p><code>ENTRYPOINT command param1 param2</code></p>
<p>ç¬¬ä¸€ç§æ ¼å¼ä¸‹èƒ½æ¥å—åˆ°æ¥è‡ª<code>CMD</code>å’Œ<code>Docker run</code>åæ·»åŠ çš„å‚æ•°ï¼Œä¼˜å…ˆæ¥å—<code>Docker run</code>çš„å‚æ•°</p>
<p>ç¬¬äºŒç§æ ¼å¼ä¸‹æ— æ³•æ¥å—æ¥è‡ª<code>CMD</code>å’Œ<code>Docker run</code>æ·»åŠ çš„å‚æ•°</p>
<p>æ›´æ¨èä½¿ç”¨ç¬¬ä¸€ç§æ ¼å¼</p>
<h3 id="ENV-è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#ENV-è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="ENV è®¾ç½®ç¯å¢ƒå˜é‡"></a><code>ENV</code> è®¾ç½®ç¯å¢ƒå˜é‡</h3><p><code>ENV</code>ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œèƒ½ä¾›åç»­çš„æŒ‡ä»¤ä½¿ç”¨</p>
<p><code>ENV</code>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li><code>ENV &lt;key&gt; &lt;value&gt;</code></li>
<li><code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...</code></li>
</ul>
<h3 id="ARG-æ„å»ºå‚æ•°"><a href="#ARG-æ„å»ºå‚æ•°" class="headerlink" title="ARG æ„å»ºå‚æ•°"></a><code>ARG</code> æ„å»ºå‚æ•°</h3><p><code>ARG</code>ç”¨æ¥æ„å»ºå‚æ•°åç§°å’Œå®šä¹‰é»˜è®¤å€¼ï¼Œå…¶å’Œ<code>ENV</code>ç¯å¢ƒå˜é‡ä¸åŒçš„æ˜¯åœ¨å®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ä¸å­˜åœ¨è¿™äº›<code>ARG</code>æ„å»ºçš„å‚æ•°çš„ï¼Œä½†å¯ä»¥åœ¨<code>Dockerhistory</code>ä¸­æŸ¥çœ‹</p>
<p>æ ¼å¼ï¼š<br><code>ARG &lt;å‚æ•°å&gt;[=&lt;é»˜è®¤å€¼&gt;]</code></p>
<p>å…³äº<code>ARG</code>çš„ä½¿ç”¨ç»†èŠ‚ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ï¼š</p>
<pre><code>ARG DOCKER_USERNAME=library

FROM $&#123;DOCKER_USERNAME&#125;/alpine

# åœ¨FROM ä¹‹åä½¿ç”¨å˜é‡ï¼Œå¿…é¡»åœ¨æ¯ä¸ªé˜¶æ®µåˆ†åˆ«æŒ‡å®š
ARG DOCKER_USERNAME=library

RUN set -x ; echo $&#123;DOCKER_USERNAME&#125;

FROM $&#123;DOCKER_USERNAME&#125;/alpine

# åœ¨FROM ä¹‹åä½¿ç”¨å˜é‡ï¼Œå¿…é¡»åœ¨æ¯ä¸ªé˜¶æ®µåˆ†åˆ«æŒ‡å®š
ARG DOCKER_USERNAME=library

RUN set -x ; echo $&#123;DOCKER_USERNAME&#125;
</code></pre>
<h3 id="VOLUME-æ„å»ºåŒ¿åæŒ‚è½½å·"><a href="#VOLUME-æ„å»ºåŒ¿åæŒ‚è½½å·" class="headerlink" title="VOLUME æ„å»ºåŒ¿åæŒ‚è½½å·"></a><code>VOLUME</code> æ„å»ºåŒ¿åæŒ‚è½½å·</h3><p>é€‚ç”¨åœºæ™¯ï¼Œåœ¨ä¾‹å¦‚æ•°æ®åº“ç­‰åŠ¨æ€æ•°æ®è¯»å†™è¾ƒå¤šå’Œéœ€è¦ä¿å­˜çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å°†æ•°æ®ä¿å­˜åœ¨å®¹å™¨çš„å¤–éƒ¨</p>
<p>åœ¨Docker Fileä¸­æ·»åŠ VOLUMEæ˜¯ä»¥é˜²ç”¨æˆ·åœ¨<code>Docker run</code>ä¸­ä¸æŒ‡å®šæŒ‚è½½ï¼Œåº”ç”¨æ­£å¸¸è¿è¡Œçš„æ—¶å€™ä¸ä¼šåœ¨å®¹å™¨ä¸­å†™å…¥å¤§é‡çš„æ•°æ®</p>
<p>DockeræŒ‚è½½å·é»˜è®¤ä¿å­˜åœ°å€æ˜¯åœ¨ <code>var/lib/docker/volumes</code> ä¸‹</p>
<p>æ ¼å¼ï¼š</p>
<ul>
<li><code>VOLUME [&quot;&lt;è·¯å¾„1&gt;&quot;, &quot;&lt;è·¯å¾„2&gt;&quot;...]</code></li>
<li><code>VOLUME &lt;è·¯å¾„&gt;</code></li>
</ul>
<h3 id="EXPOSE-å£°æ˜ç«¯å£"><a href="#EXPOSE-å£°æ˜ç«¯å£" class="headerlink" title="EXPOSE å£°æ˜ç«¯å£"></a><code>EXPOSE</code> å£°æ˜ç«¯å£</h3><p>è¿™é‡Œçš„å£°æ˜ç«¯å£åªæ˜¯æ¨èä½¿ç”¨ç«¯å£ï¼Œå®é™…ä¸Šå¹¶ä¸ä¼šåœ¨<code>Docker run</code>æ—¶å¼€å¯è¿™ä¸ªç«¯å£ï¼Œåœ¨ç”¨æˆ·ä½¿ç”¨<code>-P</code>éšæœºæŒ‡å®šç«¯å£æ—¶å€™ï¼Œä¼šè‡ªåŠ¨éšæœºé€‰æ‹©ä¸€ä¸ªå®¿ä¸»æœºç«¯å£æ˜ å°„åˆ°<code>EXPOSE</code>å£°æ˜çš„ç«¯å£</p>
<p>ä¸€ä¸ªä¾‹å­:</p>
<p>è¿™æ˜¯tomcaté•œåƒä¸­çš„dockerfileå£°æ˜çš„ä¸€ä¸ªç«¯å£<br><img src="/2021/08/29/Docker_file/1.png"><br>åœ¨dockerä¸­æ·»åŠ <code>-P</code>å¯åŠ¨ä¸‰ä¸ªtomcatå®¹å™¨<br><img src="/2021/08/29/Docker_file/2.png"><br>å¯ä»¥çœ‹åˆ°å®¿ä¸»æœºçš„ç«¯å£éƒ½ä¸çº¦è€ŒåŒçš„æ˜ å°„åˆ°äº†Exposeä¸­çš„8080ç«¯å£</p>
<h3 id="WORKDIR-æŒ‡å®šå·¥ä½œç›®å½•"><a href="#WORKDIR-æŒ‡å®šå·¥ä½œç›®å½•" class="headerlink" title="WORKDIR æŒ‡å®šå·¥ä½œç›®å½•"></a><code>WORKDIR</code> æŒ‡å®šå·¥ä½œç›®å½•</h3><p><code>WORKDIR</code>æŒ‡ä»¤èƒ½ä½¿åç»­å„å±‚çš„å½“å‰ç›®å½•éƒ½ä¼šè¢«æ”¹ä¸ºæŒ‡å®šå·¥ä½œç›®å½•</p>
<p>æ ¼å¼ï¼š<br><code>WORKDIR &lt;å·¥ä½œç›®å½•è·¯å¾„&gt;</code></p>
<h3 id="USER-æŒ‡å®šå½“å‰ç”¨æˆ·"><a href="#USER-æŒ‡å®šå½“å‰ç”¨æˆ·" class="headerlink" title="USER æŒ‡å®šå½“å‰ç”¨æˆ·"></a><code>USER</code> æŒ‡å®šå½“å‰ç”¨æˆ·</h3><p>åˆ‡æ¢åˆ°äº‹å…ˆå»ºç«‹å¥½çš„æŒ‡å®šç”¨æˆ·ï¼Œå’Œ<code>WORKDIR</code>æŒ‡ä»¤ä¸€æ ·èƒ½å¯¹åç»­å„å±‚äº§ç”Ÿå½±å“</p>
<p>æ ¼å¼ï¼š<br><code>USER &lt;ç”¨æˆ·å&gt;[:&lt;ç”¨æˆ·ç»„&gt;]</code></p>
<h3 id="HEALTHCHECK-å¥åº·æ£€æŸ¥"><a href="#HEALTHCHECK-å¥åº·æ£€æŸ¥" class="headerlink" title="HEALTHCHECK å¥åº·æ£€æŸ¥"></a><code>HEALTHCHECK</code> å¥åº·æ£€æŸ¥</h3><p>èƒ½åˆ¤æ–­å®¹å™¨çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸</p>
<p>æ ¼å¼ï¼š</p>
<ul>
<li><p><code>HEALTHCHECK [é€‰é¡¹] CMD &lt;å‘½ä»¤&gt;</code>ï¼šè®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶å†µçš„å‘½ä»¤</p>
<ul>
<li><code>--interval=&lt;é—´éš”&gt;</code>ï¼šä¸¤æ¬¡å¥åº·æ£€æŸ¥çš„é—´éš”ï¼Œé»˜è®¤ä¸º 30 ç§’ï¼›</li>
<li><code>--timeout=&lt;æ—¶é•¿&gt;</code>ï¼šå¥åº·æ£€æŸ¥å‘½ä»¤è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæœ¬æ¬¡å¥åº·æ£€æŸ¥å°±è¢«è§†ä¸ºå¤±è´¥ï¼Œé»˜è®¤ 30 ç§’ï¼›</li>
<li><code>--retries=&lt;æ¬¡æ•°&gt;</code>ï¼šå½“è¿ç»­å¤±è´¥æŒ‡å®šæ¬¡æ•°åï¼Œåˆ™å°†å®¹å™¨çŠ¶æ€è§†ä¸º unhealthyï¼Œé»˜è®¤ 3 æ¬¡ã€‚</li>
</ul>
</li>
<li><p><code>HEALTHCHECK NONE</code>ï¼šå¦‚æœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½æ‰å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤</p>
</li>
</ul>
<p>è¿™æ˜¯ä¸æ·»åŠ <code>HEALTHCHECK</code>æŒ‡ä»¤æ—¶å€™ï¼Œåªèƒ½é€šè¿‡åˆ¤æ–­<strong>å®¹å™¨ä¸»è¿›ç¨‹æ˜¯å¦é€€å‡º</strong>æ¥åˆ¤æ–­<strong>å®¹å™¨çŠ¶æ€æ˜¯å¦å¼‚å¸¸</strong><br><img src="/2021/08/29/Docker_file/3.png"><br>å½“å®¹å™¨å› ä¸ºæ­»é”æˆ–è€…æ­»å¾ªç¯è€Œè¿›ç¨‹ä¸é€€å‡ºæ—¶ï¼Œä¾ç„¶æ— æ³•è¾¨åˆ«å®¹å™¨æ˜¯å¦å¼‚å¸¸</p>
<p>ä½¿ç”¨<code>HEALTHCHECK</code>å</p>
<ul>
<li>å®¹å™¨å¯åŠ¨æ—¶ï¼Œæœ€åˆçš„çŠ¶æ€ä¸º <code>(health: starting)</code></li>
<li>è¿‡å‡ ç§’åï¼Œå¥åº·çŠ¶æ€å˜åŒ–ä¸ºäº† <code>(healthy)</code></li>
<li>å¥åº·æ£€æŸ¥è¿ç»­å¤±è´¥è¶…è¿‡äº†é‡è¯•æ¬¡æ•°ï¼ŒçŠ¶æ€å°±ä¼šå˜ä¸º<code>(unhealthy)</code></li>
</ul>
<h3 id="ONBUILD-è¾…åŠ©æ„å»ºé•œåƒ"><a href="#ONBUILD-è¾…åŠ©æ„å»ºé•œåƒ" class="headerlink" title="ONBUILD è¾…åŠ©æ„å»ºé•œåƒ"></a><code>ONBUILD</code> è¾…åŠ©æ„å»ºé•œåƒ</h3><p>æ ¼å¼ï¼š<br><code>ONBUILD &lt;å…¶å®ƒæŒ‡ä»¤&gt;</code> </p>
<p>å½“ä»¥æ­¤é•œåƒä¸ºåŸºç¡€é•œåƒï¼Œå»æ„å»ºä¸‹ä¸€çº§é•œåƒæ—¶(FROM xxx)ï¼Œ<code>ONBUILD</code>åé¢çš„æŒ‡ä»¤æ‰ä¼šè¢«æ‰§è¡Œ</p>
]]></content>
      <categories>
        <category>è¿ç»´éƒ¨ç½²</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>è°ˆè°ˆDockerçš„å·æŒ‚è½½</title>
    <url>/2021/08/11/Docker_volume_mount/</url>
    <content><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Dockerå·æŒ‚è½½æä¾›äº†ä»¥ä¸‹ä¾¿åˆ©ï¼š</p>
<ul>
<li>èƒ½åœ¨å®¿ä¸»æœºä¸Šå¾ˆæ–¹ä¾¿åœ°è®¿é—®å®¹å™¨ä¸­çš„æ–‡ä»¶</li>
<li>èƒ½åœ¨å¤šä¸ªå®¹å™¨ä¹‹é—´å…±äº«æ•°æ®</li>
<li>å®¹å™¨æ•°æ®çš„å¯æŒä¹…åŒ–</li>
</ul>
<span id="more"></span>

<h3 id="æ•°æ®çš„è¦†ç›–é—®é¢˜"><a href="#æ•°æ®çš„è¦†ç›–é—®é¢˜" class="headerlink" title="æ•°æ®çš„è¦†ç›–é—®é¢˜"></a>æ•°æ®çš„è¦†ç›–é—®é¢˜</h3><ul>
<li><p>å¦‚æœæŒ‚è½½ä¸€ä¸ªç©ºçš„æ•°æ®å·åˆ°å®¹å™¨ä¸­çš„ä¸€ä¸ªéç©ºç›®å½•ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè¢«å¤åˆ¶åˆ°æ•°æ®å·ä¸­ã€‚</p>
</li>
<li><p>å¦‚æœæŒ‚è½½ä¸€ä¸ªéç©ºçš„æ•°æ®å·åˆ°å®¹å™¨ä¸­çš„ä¸€ä¸ªç›®å½•ä¸­ï¼Œé‚£ä¹ˆå®¹å™¨ä¸­çš„ç›®å½•ä¸­ä¼šæ˜¾ç¤ºæ•°æ®å·ä¸­çš„æ•°æ®ã€‚å¦‚æœåŸæ¥å®¹å™¨ä¸­çš„ç›®å½•ä¸­æœ‰æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›åŸå§‹æ•°æ®ä¼šè¢«éšè—æ‰ã€‚</p>
</li>
</ul>
<p> æ€»ç»“ï¼š å®¿ä¸»æœºæ•°æ®å·ç©ºæ—¶ï¼Œä¼˜å…ˆå®¹å™¨æ•°æ®ï¼›å®¿ä¸»æœºæ•°æ®å·éç©ºæ—¶ï¼Œä¼˜å…ˆå®¿ä¸»æœºæ•°æ®</p>
<h3 id="æ•°æ®å·çš„ä½ç½®é—®é¢˜"><a href="#æ•°æ®å·çš„ä½ç½®é—®é¢˜" class="headerlink" title="æ•°æ®å·çš„ä½ç½®é—®é¢˜"></a>æ•°æ®å·çš„ä½ç½®é—®é¢˜</h3><ul>
<li>æ‰€æœ‰çš„dockerå®¹å™¨å†…çš„å·ï¼Œæ²¡æœ‰æŒ‡å®šç›®å½•çš„æƒ…å†µä¸‹éƒ½æ˜¯åœ¨/var/lib/docker/volumes/xxxx/_dataä¸‹ é€šè¿‡å…·åæŒ‚è½½å¯ä»¥æ–¹ä¾¿åœ°æ‰¾åˆ°ä¸€ä¸ªå·ï¼Œå¤§å¤šæ•°æƒ…å†µåœ¨ä½¿ç”¨å…·åæŒ‚è½½</li>
</ul>
<h3 id="æ•°æ®å·çš„å¤‡ä»½ã€æ¢å¤ã€è¿ç§»é—®é¢˜"><a href="#æ•°æ®å·çš„å¤‡ä»½ã€æ¢å¤ã€è¿ç§»é—®é¢˜" class="headerlink" title="æ•°æ®å·çš„å¤‡ä»½ã€æ¢å¤ã€è¿ç§»é—®é¢˜"></a>æ•°æ®å·çš„å¤‡ä»½ã€æ¢å¤ã€è¿ç§»é—®é¢˜</h3><p>(è¿™é‡Œç•™ä¸ªå‘ã€‚ã€‚ã€‚)</p>
<h3 id="ä¸€äº›å¸¸ç”¨çš„æ“ä½œ"><a href="#ä¸€äº›å¸¸ç”¨çš„æ“ä½œ" class="headerlink" title="ä¸€äº›å¸¸ç”¨çš„æ“ä½œ"></a>ä¸€äº›å¸¸ç”¨çš„æ“ä½œ</h3><p>æŒ‡å®šè·¯å¾„æŒ‚è½½</p>
<p><code>-v &lt;å®¿ä¸»æœºåœ°å€&gt;:&lt;å®¹å™¨åœ°å€&gt;</code> : å°†å®¿ä¸»æœºçš„æ–‡ä»¶\ç›®å½•æŒ‚è½½è‡³å®¹å™¨å†…</p>
<p>åŒ¿åæŒ‚è½½</p>
<p><code>-v &lt;å®¹å™¨åœ°å€&gt;</code> : é»˜è®¤åˆ†é…ä½ ç»™æŒ‚è½½å·ä¸€ä¸ªåå­—</p>
<p>å…·åæŒ‚è½½</p>
<p><code>-v &lt;å·å&gt;:&lt;å®¹å™¨åœ°å€&gt;</code> : è‡ªå®šä¹‰æŒ‚è½½å·åå­—</p>
<p>è¯»å†™æƒé™(æ·»åŠ åœ¨&lt;å®¹å™¨åœ°å€&gt;å)</p>
<p><code>:ro/:readonly</code> : åªè¯»<br><code>:rw/:readwrite</code> : å¯è¯»å¯å†™</p>
<p>æŸ¥çœ‹æŒ‚è½½æƒ…å†µ</p>
<p><code>docker volume ls</code><br><code>docker volume inspect &lt;å·å&gt;</code></p>
]]></content>
      <categories>
        <category>è¿ç»´éƒ¨ç½²</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
</search>
